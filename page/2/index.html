<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.capallen.top","root":"/","scheme":"Muse","version":"8.0.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}};
  </script>

  <meta name="description" content="数据 算法 分享">
<meta property="og:type" content="website">
<meta property="og:title" content="Allen&#39;s Blog">
<meta property="og:url" content="https://www.capallen.top/page/2/index.html">
<meta property="og:site_name" content="Allen&#39;s Blog">
<meta property="og:description" content="数据 算法 分享">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Allen Jia">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.capallen.top/page/2/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Allen's Blog</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Allen's Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">体制山下的泼猴</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">24</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">28</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Allen Jia</p>
  <div class="site-description" itemprop="description">数据 算法 分享</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">28</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/CapAllen" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;CapAllen" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:allenjsj@163.com" title="E-Mail → mailto:allenjsj@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">
      

      
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.capallen.top/2018/Anaconda%E9%85%8D%E7%BD%AE.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Allen Jia">
      <meta itemprop="description" content="数据 算法 分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Blog">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/Anaconda%E9%85%8D%E7%BD%AE.html" class="post-title-link" itemprop="url">Anaconda&Jupyter Notebook配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-12-02 07:30:09" itemprop="dateCreated datePublished" datetime="2018-12-02T07:30:09+08:00">2018-12-02</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2019-06-06 10:32:23" itemprop="dateModified" datetime="2019-06-06T10:32:23+08:00">2019-06-06</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DAND/" itemprop="url" rel="index"><span itemprop="name">DAND</span></a>
        </span>
    </span>

  
    <span id="/2018/Anaconda%E9%85%8D%E7%BD%AE.html" class="post-meta-item leancloud_visitors" data-flag-title="Anaconda&Jupyter Notebook配置" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/Anaconda%E9%85%8D%E7%BD%AE.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/Anaconda%E9%85%8D%E7%BD%AE.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>很多同学对Anaconda和Jupyter Notebook的安装与配置有疑惑，这里对课程中的<a target="_blank" rel="noopener" href="https://classroom.udacity.com/nanodegrees/nd002-cn-basic-vip/parts/e566ad37-6119-4448-a6bc-7ade73ef3992">选修：配置Anaconda和Jupyter Notebook</a>作为一个补充。</p>
<h1 id="Anaconda"><a href="#Anaconda" class="headerlink" title="Anaconda"></a>Anaconda</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>点击<a target="_blank" rel="noopener" href="https://www.anaconda.com/download/">下载链接</a>，先选择你的操作系统，然后选择<code>Python 3.7 version</code>版本下载。</p>
<p><img src="https://s1.ax1x.com/2018/12/02/Fu1fsg.png" alt="Fu1fsg.png"></p>
<p>安装过程中，记得这里的两个框，都勾选上。</p>
<p><img src="https://s1.ax1x.com/2018/12/02/Fu1Ids.png" alt="Fu1Ids.png"></p>
<hr>
<h2 id="常用软件"><a href="#常用软件" class="headerlink" title="常用软件"></a>常用软件</h2><p>安装完Anaconda之后，Windows用户可以通过<code>开始</code>-<code>所有程序</code>找到<code>Anaconda</code>的文件夹，在文件夹下有三个程序是你经常会用到的，分别是：</p>
<p><strong>Anaconda Prompt</strong>：这里就是Anaconda的控制台，你进行<a target="_blank" rel="noopener" href="https://classroom.udacity.com/nanodegrees/nd002-cn-basic-vip/parts/e566ad37-6119-4448-a6bc-7ade73ef3992/modules/2424424b-f71a-4c80-a34c-9a1f47e35cd5/lessons/c6a12f2e-63f2-4007-a2c3-dd3e5f06f3cb/concepts/9310a67f-9b23-449e-8949-4312dc718ef9">第三方包的管理</a>和<a target="_blank" rel="noopener" href="https://classroom.udacity.com/nanodegrees/nd002-cn-basic-vip/parts/e566ad37-6119-4448-a6bc-7ade73ef3992/modules/2424424b-f71a-4c80-a34c-9a1f47e35cd5/lessons/c6a12f2e-63f2-4007-a2c3-dd3e5f06f3cb/concepts/14783a82-d656-436b-bc3f-12f7abe03529">编程环境的管理</a>都是在这里进行。但是现阶段用不到。</p>
<p><strong>Jupyter Notebook</strong>：使用非常非常频繁的web文档，在项目三和项目四中都会用到。</p>
<p><strong>Spyder</strong>：python的IDE(集成开发环境)，在项目二中会用到。</p>
<p><img src="https://s1.ax1x.com/2018/12/02/Fu3BlT.png" alt="Fu3BlT.png"></p>
<h1 id="Jupter-Notebook"><a href="#Jupter-Notebook" class="headerlink" title="Jupter Notebook"></a>Jupter Notebook</h1><p>notebook的使用技巧在教室内说得很详细了，这里只补充一点，那就是如何在你工作的文件夹下使用notebook。</p>
<h3 id="1-进入到工作文件夹"><a href="#1-进入到工作文件夹" class="headerlink" title="1. 进入到工作文件夹"></a>1. 进入到工作文件夹</h3><h3 id="2-按住Shift键，然后右击，选择“在此处打开命令窗口”"><a href="#2-按住Shift键，然后右击，选择“在此处打开命令窗口”" class="headerlink" title="2.按住Shift键，然后右击，选择“在此处打开命令窗口”"></a>2.按住<code>Shift</code>键，然后右击，选择“在此处打开命令窗口”</h3><p><img src="https://s1.ax1x.com/2018/12/02/Fu3LtI.png" alt="Fu3LtI.png"></p>
<h3 id="3-输入jupyter-notebook，回车"><a href="#3-输入jupyter-notebook，回车" class="headerlink" title="3.输入jupyter notebook，回车"></a>3.输入jupyter notebook，回车</h3><p><img src="https://s1.ax1x.com/2018/12/02/Fu3j9P.png" alt="Fu3j9P.png"></p>
<h3 id="4-notebook即会在你的默认浏览器中弹出，目录即为该路径下的文件"><a href="#4-notebook即会在你的默认浏览器中弹出，目录即为该路径下的文件" class="headerlink" title="4.notebook即会在你的默认浏览器中弹出，目录即为该路径下的文件"></a>4.notebook即会在你的默认浏览器中弹出，目录即为该路径下的文件</h3><p><strong>注意：</strong>不要关掉弹出notebook的命令窗口，这是将notebook与你电脑内的python链接的纽带。</p>
<p><img src="https://s1.ax1x.com/2018/12/02/Fu89BQ.png" alt="Fu89BQ.png"></p>
<h1 id="Spyder"><a href="#Spyder" class="headerlink" title="Spyder"></a>Spyder</h1><p>我们将会在项目二中用到Spyder这个软件，这个软件也没什么操作难度，所以课程内没有讲解。</p>
<p>我在这里给大家具体讲一下吧。</p>
<h2 id="打开"><a href="#打开" class="headerlink" title="打开"></a>打开</h2><p>Windows用户依次点击<code>开始</code>-<code>所有程序</code>-<code>Anaconda</code>-<code>Spyder</code>即可。</p>
<h2 id="界面"><a href="#界面" class="headerlink" title="界面"></a>界面</h2><p><img src="https://s1.ax1x.com/2018/12/02/Fu8rCt.png" alt="Fu8rCt.png"></p>
<p>如上，我们可以把Spyder的界面划分为5个部分，分别为：</p>
<p><strong>菜单栏</strong>：就是一些新建、打开、运行、终止等等操作，自行摸索</p>
<p><strong>选择工作区</strong>：这里可以选择工作区路径</p>
<p><strong>代码编辑区</strong>：这里就是你写代码的地方</p>
<p><strong>程序变量/文件路径查看区</strong>：通过选择箭头标注的选项卡，可以显示代码中的变量，或者是当前路径下的文件</p>
<p><strong>控制台</strong>：这里就是显示你代码运行结果的地方，如果代码运行卡住了，可以通过点该区域右上角的<code>■</code>终止运行。</p>
<h2 id="使用流程"><a href="#使用流程" class="headerlink" title="使用流程"></a>使用流程</h2><p>先确定工作路径，然后新建脚本，开始编写代码、运行（快捷键F5）、调试。</p>
<p>做完项目二，大家就能熟练操作啦，不要担心~</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.capallen.top/2018/Python%20code%20for%20mini%20batch%20gradient%20descent.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Allen Jia">
      <meta itemprop="description" content="数据 算法 分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Blog">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/Python%20code%20for%20mini%20batch%20gradient%20descent.html" class="post-title-link" itemprop="url">Python Code of Mini-Batch Gradient Descent</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-12-02 07:30:09" itemprop="dateCreated datePublished" datetime="2018-12-02T07:30:09+08:00">2018-12-02</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2019-06-06 10:32:23" itemprop="dateModified" datetime="2019-06-06T10:32:23+08:00">2019-06-06</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DSND/" itemprop="url" rel="index"><span itemprop="name">DSND</span></a>
        </span>
    </span>

  
    <span id="/2018/Python%20code%20for%20mini%20batch%20gradient%20descent.html" class="post-meta-item leancloud_visitors" data-flag-title="Python Code of Mini-Batch Gradient Descent" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/Python%20code%20for%20mini%20batch%20gradient%20descent.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/Python%20code%20for%20mini%20batch%20gradient%20descent.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>Mini-Batch Gradient Descent是介于<em>batch gradient descent</em>（BGD）和<em>stochastic gradient descent</em>（SGD）之间的一种线性回归优化算法，它是将数据分为多个小的数据集（batches），每个数据集具有大致相同的点数，然后在每个数据集中应用Absolute Trick或者是Square Trick算法，来更新回归系数。</p>
<p>它的运算速度比BSD快，比SGD慢；精度比BSD低，比SGD高。</p>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">np.random.seed(<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MSEStep</span>(<span class="params">X, y, W, b, learn_rate = <span class="number">0.001</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    This function implements the gradient descent step for squared error as a</span></span><br><span class="line"><span class="string">    performance metric.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Parameters</span></span><br><span class="line"><span class="string">    X : array of predictor features</span></span><br><span class="line"><span class="string">    y : array of outcome values</span></span><br><span class="line"><span class="string">    W : predictor feature coefficients</span></span><br><span class="line"><span class="string">    b : regression function intercept</span></span><br><span class="line"><span class="string">    learn_rate : learning rate</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns</span></span><br><span class="line"><span class="string">    W_new : predictor feature coefficients following gradient descent step</span></span><br><span class="line"><span class="string">    b_new : intercept following gradient descent step</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># compute errors</span></span><br><span class="line">    <span class="comment"># the squared trick formula </span></span><br><span class="line">    y_pred = np.matmul(X, W) + b <span class="comment">#Attention:the order of X and W</span></span><br><span class="line">    error = y - y_pred</span><br><span class="line">    <span class="comment">#y_pred is a 1-D array,so is the error</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># compute steps</span></span><br><span class="line">    W_new = W + learn_rate * np.matmul(error, X) <span class="comment">#Attention:the order of X and error</span></span><br><span class="line">    b_new = b + learn_rate * error.sum() </span><br><span class="line">    <span class="keyword">return</span> (W_new, b_new)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">miniBatchGD</span>(<span class="params">X, y, batch_size = <span class="number">20</span>, learn_rate = <span class="number">0.005</span>, num_iter = <span class="number">25</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    This function performs mini-batch gradient descent on a given dataset.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Parameters</span></span><br><span class="line"><span class="string">    X : array of predictor features</span></span><br><span class="line"><span class="string">    y : array of outcome values</span></span><br><span class="line"><span class="string">    batch_size : how many data points will be sampled for each iteration</span></span><br><span class="line"><span class="string">    learn_rate : learning rate</span></span><br><span class="line"><span class="string">    num_iter : number of batches used</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns</span></span><br><span class="line"><span class="string">    regression_coef : array of slopes and intercepts generated by gradient</span></span><br><span class="line"><span class="string">      descent procedure</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    n_points = X.shape[<span class="number">0</span>]</span><br><span class="line">    W = np.zeros(X.shape[<span class="number">1</span>]) <span class="comment"># coefficients</span></span><br><span class="line">    b = <span class="number">0</span> <span class="comment"># intercept</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># run iterations</span></span><br><span class="line">    <span class="comment">#hstack为水平堆叠函数 为什么要堆叠呢？</span></span><br><span class="line">    <span class="comment">#类似zip，可以实现for W,b in regression_coef:print W,b来提取W和b</span></span><br><span class="line">    regression_coef = [np.hstack((W,b))]</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(num_iter):</span><br><span class="line">        <span class="comment">#从0-100中随机选择batch_size个数，作为batch</span></span><br><span class="line">        batch = np.random.choice(range(n_points), batch_size)</span><br><span class="line">        <span class="comment">#按照batch从X中选出数据</span></span><br><span class="line">        X_batch = X[batch,:]<span class="comment">#为2-D矩阵</span></span><br><span class="line">        y_batch = y[batch]<span class="comment">#为1-D数组</span></span><br><span class="line">        W, b = MSEStep(X_batch, y_batch, W, b, learn_rate)</span><br><span class="line">        regression_coef.append(np.hstack((W,b)))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (regression_coef)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># perform gradient descent</span></span><br><span class="line">    data = np.loadtxt(<span class="string">&#x27;data.csv&#x27;</span>, delimiter = <span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    X = data[:,:<span class="number">-1</span>]<span class="comment">#提取第一列，为2-D矩阵</span></span><br><span class="line">    y = data[:,<span class="number">-1</span>]<span class="comment">#提取第二列，为1-D数组</span></span><br><span class="line">    regression_coef = miniBatchGD(X, y)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># plot the results  </span></span><br><span class="line">    plt.figure()</span><br><span class="line">    X_min = X.min()</span><br><span class="line">    X_max = X.max()</span><br><span class="line">    counter = len(regression_coef)</span><br><span class="line">    <span class="keyword">for</span> W, b <span class="keyword">in</span> regression_coef:</span><br><span class="line">        counter -= <span class="number">1</span></span><br><span class="line">         <span class="comment">#color为[R,G,B]的列表，范围都在0-1之间，[0,0,0]为黑色，[1,1,1]为白色</span></span><br><span class="line">        color = [<span class="number">1</span> - <span class="number">0.92</span> ** counter <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>)]</span><br><span class="line">        <span class="comment">#绘制一条点(X_min,X_min * W + b)与点(X_max, X_max * W + b)之间的一条直线</span></span><br><span class="line">        plt.plot([X_min, X_max],[X_min * W + b, X_max * W + b], color = color)</span><br><span class="line">    plt.scatter(X, y, zorder = <span class="number">3</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>

<h1 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h1><p><img src="https://s1.ax1x.com/2018/12/05/FldOgg.png" alt="FldOgg.png"></p>
<p>在结果中，颜色最浅的是最开始的回归线，最深的则为最终的回归线。</p>
<h1 id="详解"><a href="#详解" class="headerlink" title="详解"></a>详解</h1><p>理论知识参见<a href="">Linear Regression 总结</a>，这里只对代码中出现的新函数或新用法进行讲解。</p>
<h2 id="numpy-matmul-a-b"><a href="#numpy-matmul-a-b" class="headerlink" title="numpy.matmul(a,b)"></a>numpy.matmul(a,b)</h2><p>该函数用来计算两个arrays的乘积。</p>
<p>需要注意的是，由于a和b维度的不同，会使得函数的结果计算方式不同，一共三种：</p>
<ul>
<li><p>如果a和b都是2维的，则做普通矩阵乘法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [[<span class="number">1</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">1</span>]]</span><br><span class="line">b = [[<span class="number">4</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">2</span>]]</span><br><span class="line">np.matmul(a, b)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">out:</span><br><span class="line">array([[<span class="number">4</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">2</span>]])</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果a和b中有一个是大于2维的，则会将其理解为多个矩阵stack后的结果，进行计算时也会进行相应的拆分运算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = np.arange(<span class="number">2</span>*<span class="number">2</span>*<span class="number">4</span>).reshape((<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>))</span><br><span class="line">b = np.arange(<span class="number">2</span>*<span class="number">2</span>*<span class="number">4</span>).reshape((<span class="number">2</span>,<span class="number">4</span>,<span class="number">2</span>))</span><br><span class="line">np.matmul(a,b).shape</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">out:</span><br><span class="line">(<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>a被理解为2个2x4矩阵的stack</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">array([[[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>],</span><br><span class="line">        [ <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>],</span><br><span class="line">        [<span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]]])</span><br></pre></td></tr></table></figure>

<p>b被理解为2个4x2矩阵的stack</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">array([[[ <span class="number">0</span>,  <span class="number">1</span>],</span><br><span class="line">        [ <span class="number">2</span>,  <span class="number">3</span>],</span><br><span class="line">        [ <span class="number">4</span>,  <span class="number">5</span>],</span><br><span class="line">        [ <span class="number">6</span>,  <span class="number">7</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">8</span>,  <span class="number">9</span>],</span><br><span class="line">        [<span class="number">10</span>, <span class="number">11</span>],</span><br><span class="line">        [<span class="number">12</span>, <span class="number">13</span>],</span><br><span class="line">        [<span class="number">14</span>, <span class="number">15</span>]]])</span><br></pre></td></tr></table></figure>

<p><code>np.matmul(a,b)</code>会将a中的两个矩阵与b中的两个矩阵对应相乘，每对相乘的结果都是一个2x2的矩阵，所以结果就是一个2x2x2的矩阵。</p>
</li>
<li><p>如果a或b有一个是一维的，那么就会为该一维数组补充1列或1行，进而提升为二维矩阵，然后用非补充行或列去和另外一个二维矩阵进行运算，得到的结果再将补充的1去掉。（<strong>这个是最难理解的，可以多测试下，用代码结果理解</strong>）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = [[<span class="number">1</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">1</span>]]</span><br><span class="line">b = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">np.matmul(a, b)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">out:</span><br><span class="line">array([<span class="number">1</span>, <span class="number">2</span>])</span><br></pre></td></tr></table></figure>

<p>a是一个2x2的矩阵，b是一个shape为(2,)的一维数组，那么matmul的计算步骤如下：</p>
<ul>
<li>计算中，矩阵a在前，数组b在后，所以需要让a的列数与升维之后b矩阵的行数相等</li>
<li>所以，升维后b矩阵的shape应为(2,1)，这个1添加到了列上</li>
<li>进行矩阵乘法计算，得到shape为(2,1)，这时候再将这个1去掉</li>
<li>最终结果的shape为(2,)，变为一维数组</li>
</ul>
<p>我们试着将a与b的顺序对调，看一下matmul是怎么计算的：</p>
<ul>
<li>对调后，数组b在前，矩阵a在后，需要将升维后b矩阵的列数与矩阵a的行数相等</li>
<li>所以，升维后b矩阵的shape应该为(1,2)，这个1添加到了行上</li>
<li>进行矩阵乘法，得到的shape为(1,2)，将这个1去掉</li>
<li>最终结果的shape为(2,)，变为一维数组</li>
</ul>
</li>
</ul>
<h2 id="numpy-hstack"><a href="#numpy-hstack" class="headerlink" title="numpy.hstack()"></a>numpy.hstack()</h2><p>我们先来看看<code>numpy.stack()</code>函数。</p>
<ul>
<li>函数用法为：numpy.stack(arrays,axis = 0)</li>
<li>第一个参数为arrays，可以输入多维数组或者列表，也可以输入由多个一维数组或列表组成的元组</li>
<li>第二个参数为axis，输入数字，决定了按照arrays的哪个维度进行stack。比如说，输入的arrays的shape为(3,4,3)，那么axis = 0/1/2就分别对应arrays的组/行/列。</li>
</ul>
<p>这个函数中的axis有些抽象，我们看具体示例：</p>
<ul>
<li>定义了一个列表</li>
</ul>
<p><img src="https://s1.ax1x.com/2018/12/06/F1PSIS.png" alt="F1PSIS.png"></p>
<p>结果的排版有点问题，为了方便后面对照，把结果对齐如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    array([[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]]),</span><br><span class="line">    array([[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]]),</span><br><span class="line">    array([[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]])</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ul>
<li><p>axis = 0，则按照第0个维度<code>组</code>进行堆叠，即：</p>
<p><img src="https://s1.ax1x.com/2018/12/06/F1PqFU.png" alt="F1PqFU.png"></p>
<p>结果为：</p>
<p><img src="https://s1.ax1x.com/2018/12/06/F1PLYF.png" alt="F1PLYF.png"></p>
</li>
<li><p>axis = 1，则按照第1个维度<code>行</code>进行堆叠，即：</p>
<p><img src="https://s1.ax1x.com/2018/12/06/F1Pvl9.png" alt="F1Pvl9.png"></p>
<p>结果为：</p>
<p><img src="https://s1.ax1x.com/2018/12/06/F1PzO1.png" alt="F1PzO1.png"></p>
</li>
<li><p>axis = 2，则按照第二个维度<code>列</code>进行堆叠，即：</p>
<p><img src="https://s1.ax1x.com/2018/12/06/F13zdO.png" alt="F13zdO.png"></p>
<p>结果为：</p>
<p><img src="C:\Users\Administrator\AppData\Local\Temp\1544074512445.png" alt="1544074512445"></p>
<p>这个基本很少用到。</p>
</li>
</ul>
<p>**numpy.hstack()**函数就是horizontal（水平）方向的堆叠，示例：</p>
<p><img src="https://s1.ax1x.com/2018/12/06/F18qAS.png" alt="F18qAS.png"></p>
<p>**numpy.vstack()**函数就是在垂直方向堆叠。</p>
<h2 id="ndarray的切片"><a href="#ndarray的切片" class="headerlink" title="ndarray的切片"></a>ndarray的切片</h2><p>一维ndarray的切片方式和list无异，这里主要讲一下二维矩阵的切片方法。</p>
<ul>
<li>矩阵切片</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = np.arange(<span class="number">4</span>*<span class="number">4</span>).reshape(<span class="number">4</span>,<span class="number">4</span>)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">out:</span><br><span class="line">array([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>],</span><br><span class="line">       [ <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>],</span><br><span class="line">       [ <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>],</span><br><span class="line">       [<span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]])</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[:,:<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">out:</span><br><span class="line">array([[ <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>],</span><br><span class="line">       [ <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>],</span><br><span class="line">       [ <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>],</span><br><span class="line">       [<span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>]])</span><br></pre></td></tr></table></figure>

<p>这里可以看出，我们筛选了a矩阵中前三列的所有行，这是如何实现的呢？</p>
<p>切片的第一个元素<code>:</code>表示的是选择所有行，第二个元素<code>:-1</code>表示的是从第0列至最后一列（不包含），所以结果如上所示。</p>
<p>再看一个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[<span class="number">1</span>:<span class="number">3</span>,:]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">out:</span><br><span class="line">array([[ <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>],</span><br><span class="line">       [ <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>]])</span><br></pre></td></tr></table></figure>

<p>筛选的是第2-3行的所有列。</p>
<ul>
<li>一个常用的切片</li>
</ul>
<p>以列的形式获取最后一列数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[:,<span class="number">3</span>:]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">out:</span><br><span class="line">array([[ <span class="number">3</span>],</span><br><span class="line">       [ <span class="number">7</span>],</span><br><span class="line">       [<span class="number">11</span>],</span><br><span class="line">       [<span class="number">15</span>]])</span><br></pre></td></tr></table></figure>

<p>以一维数组的形式获取最后一列数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[:,<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">out:</span><br><span class="line">array([ <span class="number">3</span>,  <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>])</span><br></pre></td></tr></table></figure>

<p>上面两种方法经常会用到，前者的shape为(4,1)，后者为(4,)。</p>
<h2 id="matplotlib相关"><a href="#matplotlib相关" class="headerlink" title="matplotlib相关"></a>matplotlib相关</h2><ul>
<li><p>color</p>
<p>代码中涉及到的语句为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">color = [<span class="number">1</span> - <span class="number">0.92</span> ** counter <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>)]</span><br></pre></td></tr></table></figure>

<p>matplotlib中的color可以输入RGB格式，即[R,G,B]，这里值得注意的是它们的取值范围都在0到1之间，其中[0,0,0]为黑色，[1,1,1]为白色。</p>
<p>在如上语句中，列表由三个相等的数值元素组成，保证了颜色为白-灰-黑，数值随着counter的减小，由1趋近于0，反映在可视化上就是颜色由白逐渐变黑。</p>
<p>这真是一个画渐变过程的好方法呀！！！</p>
</li>
<li><p>plot([x_1,x_2],[y_1,y_2])</p>
<p>这里就是两点式绘图，根据点(x_1,y_1)和点(x_2,y_2)画一条直线。</p>
</li>
<li><p>zorder</p>
<p>也就是z-order，类似于PS里面的图层顺序，下面的图层会被上面的图层遮挡。</p>
<p>参考<a target="_blank" rel="noopener" href="https://matplotlib.org/gallery/misc/zorder_demo.html#sphx-glr-gallery-misc-zorder-demo-py">Zorder Demo</a>中队zorder的介绍，可以知道，zorder越大，图层越靠上，所以在上面的代码中，我们在scatter中设定zorder为3，也就是最上层，这样就可以保证渐变的回归线不会压在散点图上面了。</p>
<p><img src="https://s1.ax1x.com/2018/12/06/F1JYiF.png" alt="F1JYiF.png"></p>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.capallen.top/2018/SQL-basic.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Allen Jia">
      <meta itemprop="description" content="数据 算法 分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Blog">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/SQL-basic.html" class="post-title-link" itemprop="url">SQL应知应会</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-10-06 21:30:09" itemprop="dateCreated datePublished" datetime="2018-10-06T21:30:09+08:00">2018-10-06</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2019-06-06 10:32:23" itemprop="dateModified" datetime="2019-06-06T10:32:23+08:00">2019-06-06</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a>
        </span>
    </span>

  
    <span id="/2018/SQL-basic.html" class="post-meta-item leancloud_visitors" data-flag-title="SQL应知应会" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/SQL-basic.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/SQL-basic.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p> If you want your life to be a magnificent story, then begin by realising that you are the author.</p>
</blockquote>
<p>本文就Udacity数据分析入门课程中的SQL入门（P1阶段）和SQL进阶（P3阶段）的知识点进行总结。SQL的主要功能不外乎<strong>增、删、改、查</strong>四个，对于数据分析师来说，只需要掌握<strong>查</strong>就可以了。（因为增删改往往超出了数据分析师的职能范围）</p>
<blockquote>
<p><strong>注意：</strong>本文是总结性质的，只能提供复习或者速查的功能，讲解得不会很详细，若想学习，还是要在教室内逐章学习。</p>
</blockquote>
<h1 id="SQL简介"><a href="#SQL简介" class="headerlink" title="SQL简介"></a>SQL简介</h1><p>SQL是Structured Query Language的简写，也就是<strong>结构化查询语言</strong>。SQL 最受欢迎的功能是与数据库交互。</p>
<p>使用<strong>传统关系数据库</strong>与 SQL 交互有一些主要优点。最明显的 5 个优点是：</p>
<ul>
<li>SQL 很容易理解。</li>
<li>传统的数据库允许我们直接访问数据。</li>
<li>传统的数据库可使我们审核和复制数据。</li>
<li>SQL 是一个可一次分析多个表的很好工具。</li>
<li>相对于 Google Analytics 等仪表板工具，SQL 可使我们分析更复杂的问题。</li>
</ul>
<p><strong>为什么企业喜欢使用数据库</strong></p>
<ol>
<li>只有输入了需要输入的数据，以及只有某些用户能够将数据输入数据库，才能<strong>保证数据的完整性</strong>。</li>
<li><strong>可以快速访问数据</strong> - SQL 可使我们从数据库中快速获取结果。  可以优化代码，快速获取结果。  </li>
<li><strong>可以很容易共享数据</strong> - 多个人可以访问存储在数据库中的数据，所有访问数据库的用户获得的数据都是一样。</li>
</ol>
<p><strong>SQL 与 NoSQL</strong></p>
<p>你可能听说过 NoSQL，它表示 Not only SQL（不仅仅是 SQL）。使用 NoSQL  的数据库时，你编写的数据交互代码会与本节课所介绍的方式有所不同。<strong>NoSQL  更适用于基于网络数据的环境</strong>，而不太适用于我们现在要介绍的基于电子表格的数据分析。最常用的 NoSQL 语言之一是 <a target="_blank" rel="noopener" href="https://www.mongodb.com/">MongoDB</a>。</p>
<h1 id="SQL入门"><a href="#SQL入门" class="headerlink" title="SQL入门"></a>SQL入门</h1><h2 id="SQL书写规则"><a href="#SQL书写规则" class="headerlink" title="SQL书写规则"></a>SQL书写规则</h2><ul>
<li>SQL语句不区分大小写，因此SELECT与select甚至是SeLect的效果是相同的，但是要对命令和变量进行区分，所以默认<strong>命令需要大写，其他内容如变量等则需要小写</strong>；</li>
<li>表和变量名中不要出现空格，可使用下划线<code>_</code>替代。</li>
<li>查询语句中，使用单一空格隔开命令和变量</li>
<li>为提高代码的可移植性，请在查询语句结尾添加一个分号<code>；</code></li>
</ul>
<h2 id="SQL中的注释"><a href="#SQL中的注释" class="headerlink" title="SQL中的注释"></a>SQL中的注释</h2><ul>
<li><p>行内注释</p>
<p>使用两个连字符-，添加注释。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col_name <span class="comment">-- 这是一条注释</span></span><br><span class="line"><span class="keyword">FROM</span> table_name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>多行注释</p>
<p>多行注释以<code>/*</code>起始，以<code>*/</code>结尾。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*SELECT col_name </span></span><br><span class="line"><span class="comment">FROM table_name;*/</span></span><br><span class="line"><span class="keyword">SELECT</span> col_2 </span><br><span class="line"><span class="keyword">FROM</span> table_name;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="检索数据-SELECT-FROM-LIMIT"><a href="#检索数据-SELECT-FROM-LIMIT" class="headerlink" title="检索数据(SELECT FROM LIMIT )"></a>检索数据(SELECT FROM LIMIT )</h2><p>检索数据主要用的语句为：<strong>SELECT</strong>。</p>
<h3 id="检索单列"><a href="#检索单列" class="headerlink" title="检索单列"></a>检索单列</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col_name</span><br><span class="line"><span class="keyword">FROM</span> table_name;</span><br></pre></td></tr></table></figure>

<p>从table_name表中检索col_name列。</p>
<h3 id="检索多列"><a href="#检索多列" class="headerlink" title="检索多列"></a>检索多列</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col_1,col_2,col_3</span><br><span class="line"><span class="keyword">FROM</span> table_name;</span><br></pre></td></tr></table></figure>

<p>从table_name表中检索col_1,col_2和col_3列。</p>
<h3 id="检索所有列"><a href="#检索所有列" class="headerlink" title="检索所有列"></a>检索所有列</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> table_name;	</span><br></pre></td></tr></table></figure>

<p>使用通配符<code>*</code>，返回table_name表中的所有列；</p>
<h3 id="检索某列中不同的值"><a href="#检索某列中不同的值" class="headerlink" title="检索某列中不同的值"></a>检索某列中不同的值</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> col_1</span><br><span class="line"><span class="keyword">FROM</span> table_name;</span><br></pre></td></tr></table></figure>

<p>检索col_1中具有唯一性的行，即唯一值。</p>
<h3 id="限制检索的结果"><a href="#限制检索的结果" class="headerlink" title="限制检索的结果"></a>限制检索的结果</h3><p>使用LIMIT语句可以限制返回的行数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col_1</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<p>返回前10行（即第0-第9行）。</p>
<p>也可以添加OFFSET语句，设置返回数据的起始行：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col_1</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">10</span> <span class="keyword">OFFSET</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<p>从第五行之后，返回十行数据（即第5-第14行）。</p>
<h2 id="排序检索数据-ORDER-BY"><a href="#排序检索数据-ORDER-BY" class="headerlink" title="排序检索数据(ORDER BY)"></a>排序检索数据(ORDER BY)</h2><ul>
<li><p>ORDER BY 语句用于根据指定的单列或多列对结果集进行排序。</p>
</li>
<li><p>ORDER BY 语句默认按照升序对记录进行排序。（从小到大，从a到z）</p>
</li>
<li><p>如果您希望按照降序对记录进行排序，可以使用 DESC 关键字。</p>
</li>
<li><p>在指定一条ORDER BY子句时，应该保证它是SELECT语句中的最后一条子句。</p>
</li>
</ul>
<h3 id="按列排序"><a href="#按列排序" class="headerlink" title="按列排序"></a>按列排序</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col_name</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> col_name;</span><br></pre></td></tr></table></figure>

<p>返回的数据会按照col_name列进行升序排序，这里col_name可以是单列也可以是多列，当然也可以使用非检索的列进行排序。</p>
<h3 id="降序排序"><a href="#降序排序" class="headerlink" title="降序排序"></a>降序排序</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col_1,col_2</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> col_2 <span class="keyword">DESC</span>,col_3;</span><br></pre></td></tr></table></figure>

<p>返回的数据会按照col_2列降序，col_3列升序对col_1和col_2两列进行排序。</p>
<blockquote>
<p>这里可以看出，DESC关键字的用法：只对跟在语句前面的变量有效。所以，想要对多列进行降序排序时，需要对每一列都指定DESC关键字。</p>
</blockquote>
<h2 id="过滤数据-WHERE"><a href="#过滤数据-WHERE" class="headerlink" title="过滤数据(WHERE)"></a>过滤数据(WHERE)</h2><ul>
<li><p>WHERE子句应该在表名（即FROM子句）之后给出。</p>
</li>
<li><p>WHERE子句应在ORDER BY子句之前。</p>
</li>
<li><p>在过滤条件中的value是区分大小写的。</p>
</li>
</ul>
<h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col_1</span><br><span class="line"><span class="keyword">FROM</span> table_1</span><br><span class="line"><span class="keyword">WHERE</span> col_1 运算符 <span class="keyword">value</span>;</span><br></pre></td></tr></table></figure>

<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>=</td>
<td>等于</td>
</tr>
<tr>
<td>&lt;&gt;</td>
<td>不等于</td>
</tr>
<tr>
<td>&gt;</td>
<td>大于</td>
</tr>
<tr>
<td>&lt;</td>
<td>小于</td>
</tr>
<tr>
<td>&gt;=</td>
<td>大于等于</td>
</tr>
<tr>
<td>&lt;=</td>
<td>小于等于</td>
</tr>
<tr>
<td>BETWEEN…AND…</td>
<td>在指定的两值之间</td>
</tr>
<tr>
<td>IS NULL</td>
<td>为NULL值</td>
</tr>
<tr>
<td>AND</td>
<td>逻辑运算符：与</td>
</tr>
<tr>
<td>OR</td>
<td>逻辑运算符：或</td>
</tr>
<tr>
<td>IN</td>
<td>制定条件范围筛选，可以简化OR的工作</td>
</tr>
<tr>
<td>NOT</td>
<td>逻辑运算符：非</td>
</tr>
</tbody></table>
<blockquote>
<p>注意：</p>
<ul>
<li>SQL的版本不同，可能导致某些运算符不同（如不等于可以用！=表示），具体要查阅数据库文档。</li>
<li>在同时输入AND和OR时，SQL会优先处理AND语句，你可以使用小括号来进行分组操作。</li>
</ul>
</blockquote>
<h3 id="用通配符进行过滤（LIKE）"><a href="#用通配符进行过滤（LIKE）" class="headerlink" title="用通配符进行过滤（LIKE）"></a>用通配符进行过滤（LIKE）</h3><p>通配符是用来匹配值的一部分的特殊字符，跟在LIKE关键字后面进行数据过滤</p>
<table>
<thead>
<tr>
<th>通配符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>%</td>
<td>表示任何字符出现任意次数</td>
</tr>
<tr>
<td>_</td>
<td>表示任何字符出现一次</td>
</tr>
<tr>
<td>[]</td>
<td>指定一个字符集，它必须匹配该位置的一个字符</td>
</tr>
<tr>
<td>^</td>
<td>在[]中使用，表示否定</td>
</tr>
</tbody></table>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col_1</span><br><span class="line"><span class="keyword">FROM</span> table_1</span><br><span class="line"><span class="keyword">WHERE</span> col_1 <span class="keyword">LIKE</span> <span class="string">&#x27;_[^JM]%&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> col_1;</span><br></pre></td></tr></table></figure>

<p>如上筛选出的是，第二个字符为非J或M的数据。</p>
<h2 id="创建计算字段"><a href="#创建计算字段" class="headerlink" title="创建计算字段"></a>创建计算字段</h2><p>其实就是在检索数据的同时进行计算，并使用关键字AS将结果保存为某一列。</p>
<ul>
<li>数值类型的计算</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id,quantity,item_price,quantity*item_price <span class="keyword">AS</span> expanded_price</span><br><span class="line"><span class="keyword">FROM</span> orderitems</span><br><span class="line"><span class="keyword">WHERE</span> order_num = <span class="number">200008</span>;</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">prod_id         quantity       item_price      expanded_price</span><br><span class="line"><span class="comment">--------------------------------------------------------------</span></span><br><span class="line">RGAN01			5				4.9900			24.9500</span><br><span class="line">BR03			5				11.9900			59.9500</span><br></pre></td></tr></table></figure>

<p>这里实现的就是使用quantity*item_price创建一个名为expanded_price的计算字段，也就是一个新列。</p>
<p>同样适用于计算的操作符有<code>+</code>（加），<code>-</code>（减）和<code>/</code>（除）。</p>
<ul>
<li>字符类型的拼接</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">RTRIM</span>(col_name) + <span class="string">&#x27;(&#x27;</span>+<span class="keyword">RTRIM</span>(col_country)+<span class="string">&#x27;)&#x27;</span> <span class="keyword">AS</span> col_title</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> col_name;</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">col_title</span><br><span class="line"><span class="comment">------------------------</span></span><br><span class="line">Bear Emporium(USA)</span><br><span class="line">Bears R Us(USA)</span><br><span class="line">Jouets et ours(France)</span><br></pre></td></tr></table></figure>

<p>这里实现的就是将col_name列与col_country列进行了拼接，新列的名字叫做col_title。</p>
<blockquote>
<p>RTRIM()函数是去掉右边的所有空格，LTRIM()是去掉左边的所有空格，TRIM()是去掉两边的所有空格。</p>
</blockquote>
<h2 id="使用别名"><a href="#使用别名" class="headerlink" title="使用别名"></a>使用别名</h2><p>在上一节中我们使用AS来为变量设置别名，你可能也见过如下所示的语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col1 + col2 <span class="keyword">AS</span> total, col3</span><br></pre></td></tr></table></figure>

<p>当然没有 <strong>AS</strong> 的语句也可以实现使用别名：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FROM tablename t1</span><br></pre></td></tr></table></figure>

<p>以及</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col1 + col2 total, col3</span><br></pre></td></tr></table></figure>

<p>将col1+col2的结果设置名为total的列。</p>
<h2 id="代码总结"><a href="#代码总结" class="headerlink" title="代码总结"></a>代码总结</h2><table>
<thead>
<tr>
<th><strong>语句</strong></th>
<th><strong>使用方法</strong></th>
<th><strong>其他详细信息</strong></th>
</tr>
</thead>
<tbody><tr>
<td>SELECT</td>
<td>SELECT <strong>Col1</strong>, <strong>Col2</strong>, …</td>
<td>提供你需要的列</td>
</tr>
<tr>
<td>FROM</td>
<td>FROM <strong>Table</strong></td>
<td>提供列所在的表格</td>
</tr>
<tr>
<td>LIMIT</td>
<td>LIMIT <strong>10</strong></td>
<td>限制返回的行数</td>
</tr>
<tr>
<td>ORDER BY</td>
<td>ORDER BY <strong>Col</strong></td>
<td>根据列命令表格。与 <strong>DESC</strong> 一起使用。</td>
</tr>
<tr>
<td>WHERE</td>
<td>WHERE <strong>Col &gt; 5</strong></td>
<td>用于过滤结果的一个条件语句</td>
</tr>
<tr>
<td>LIKE</td>
<td>WHERE <strong>Col LIKE ‘%me%’</strong></td>
<td>仅提取出列文本中具有 ‘me’ 的行</td>
</tr>
<tr>
<td>IN</td>
<td>WHERE <strong>Col IN (‘Y’, ‘N’)</strong></td>
<td>仅过滤行对应的列为 ‘Y’ 或 ‘N’</td>
</tr>
<tr>
<td>NOT</td>
<td>WHERE <strong>Col NOT IN (‘Y’, “N’)</strong></td>
<td><strong>NOT</strong> 经常与 <strong>LIKE</strong> 和 <strong>IN</strong> 一起使用。</td>
</tr>
<tr>
<td>AND</td>
<td>WHERE <strong>Col1 &gt; 5 AND Col2 &lt; 3</strong></td>
<td>过滤两个或多个条件必须为真的行</td>
</tr>
<tr>
<td>OR</td>
<td>WHERE <strong>Col1 &gt; 5 OR Col2 &lt; 3</strong></td>
<td>过滤一个条件必须为真的行</td>
</tr>
<tr>
<td>BETWEEN</td>
<td>WHERE <strong>Col BETWEEN 3 AND 5</strong></td>
<td>一般情况下，语法比使用 <strong>AND</strong> 简单一些</td>
</tr>
</tbody></table>
<h1 id="SQL进阶"><a href="#SQL进阶" class="headerlink" title="SQL进阶"></a>SQL进阶</h1><h2 id="链接表"><a href="#链接表" class="headerlink" title="链接表"></a>链接表</h2><h3 id="基本链接（JOIN）"><a href="#基本链接（JOIN）" class="headerlink" title="基本链接（JOIN）"></a>基本链接（JOIN）</h3><p>SQL最强大的功能之一就是能在数据查询的执行中进行表的链接（JOIN）。</p>
<p>在关系数据库中，将数据分解为多个表能更有效地存储，更方便地处理，但这些数据储存在多个表中，怎样用一条SELECT语句就检索出数据呢？那就要使用链接。</p>
<p>创建链接的方式很简单，如下便是使用WHERE创建链接：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col_1,col_2,col_3</span><br><span class="line"><span class="keyword">FROM</span> table_1,table_2</span><br><span class="line"><span class="keyword">WHERE</span> table_1.id = table2.id;</span><br></pre></td></tr></table></figure>

<p>如上，col_1和col_2属于table_1表中，col_3属于table_2表中，而这两个表使用相同的id列进行匹配。这种方法被称为等值链接，也就是内链接，我们可以使用如下的语句，更直观地实现内连接：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col_1,col_2,col_3</span><br><span class="line"><span class="keyword">FROM</span> table_1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> table_2</span><br><span class="line"><span class="keyword">ON</span> table_1.id = table2.id;</span><br></pre></td></tr></table></figure>

<p>当然你也可以使用别名，简化输入，并且标明各列与表的隶属关系：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> t1.col_1,t1.col_2,t2.col_3</span><br><span class="line"><span class="keyword">FROM</span> table_1 t1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> table_2 t2</span><br><span class="line"><span class="keyword">ON</span> t1.id = t2.id;</span><br></pre></td></tr></table></figure>

<p>如上代码同样适用于左链接、右链接和外链接：</p>
<ul>
<li><p><strong>LEFT JOIN</strong> - 用于获取 <strong>FROM</strong> 中的表格中的所有行，即使它们不存在于 <strong>JOIN</strong> 语句中。</p>
</li>
<li><p><strong>RIGHT JOIN</strong> - 用于获取 <strong>JOIN</strong> 中的表格中的所有行，即使它们不存在于 <strong>FROM</strong> 语句中。</p>
</li>
<li><p><strong>FULL JOIN</strong>: 只要其中一个表中存在匹配，就返回行。</p>
</li>
</ul>
<h3 id="自链接"><a href="#自链接" class="headerlink" title="自链接"></a>自链接</h3><p>自链接经常用于对子查询的简化，如下示例：</p>
<p>假如要给Jim同一公司的所有顾客发送一封邮件，需要你先筛选出Jim的公司，然后再根据该公司筛选出所有的顾客。使用子查询的方式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_id,cust_name,cust_contact</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_name = (<span class="keyword">SELECT</span> cust_name</span><br><span class="line">                  <span class="keyword">FROM</span> customers</span><br><span class="line">                  <span class="keyword">WHERE</span> cust_contact = <span class="string">&#x27;Jim&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>如果改为自链接的方式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> c1.cust_id,c1.cust_name,c1.cust_contact</span><br><span class="line"><span class="keyword">FROM</span> customers c1,customers c2</span><br><span class="line"><span class="keyword">WHERE</span> c1.cust_name = c2.cust_name</span><br><span class="line"><span class="keyword">AND</span> c2.cust_name = <span class="string">&#x27;Jim&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>结果是一样的，但是使用自链接的处理速度比子查询要快得多。</p>
<h3 id="组合查询（UNION）"><a href="#组合查询（UNION）" class="headerlink" title="组合查询（UNION）"></a>组合查询（UNION）</h3><p>UNION 操作符用于合并两个或多个 SELECT 语句的结果集，使用方法也很简单，只要在多条SELECT语句中添加UNION关键字即可。</p>
<blockquote>
<p>多数情况下，组合相同表的多个查询所完成的任务与具有多个WHERE子句的一个查询是一样的。</p>
</blockquote>
<p><strong>注意</strong>：UNION 内部的 SELECT 语句必须拥有相同数量的列，列也必须拥有相似的数据类型。而且UNION返回的结果只会选取不同的值（即唯一值）。</p>
<p>使用UNION的场合情况：</p>
<ul>
<li>在一个查询中从不同的表返回结果；</li>
<li>对一个表执行多个查询返回结果。</li>
</ul>
<p>示例：如下三个语句的结果是一致的。</p>
<ul>
<li>原始语句</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询一</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name,cust_email</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_state <span class="keyword">IN</span> (<span class="string">&#x27;str1&#x27;</span>,<span class="string">&#x27;str2&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--查询二</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name,cust_email</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_name = <span class="string">&#x27;str3&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>使用UNION链接</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name,cust_email</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_state <span class="keyword">IN</span> (<span class="string">&#x27;str1&#x27;</span>,<span class="string">&#x27;str2&#x27;</span>)</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_name,cust_email</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_name = <span class="string">&#x27;str3&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> cust_name;</span><br></pre></td></tr></table></figure>

<p>在最后添加了ORDER BY对所有SELECT语句进行排序，这里只是为了示例在使用UNION时如何进行排序。</p>
<ul>
<li>使用WHERE</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name,cust_email</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">WHERE</span> cust_state <span class="keyword">IN</span> (<span class="string">&#x27;str1&#x27;</span>,<span class="string">&#x27;str2&#x27;</span>)</span><br><span class="line"><span class="keyword">OR</span> cust_name = <span class="string">&#x27;str3&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>这里看起来使用UNION比WHERE更复杂，但对于较复杂的筛选条件，或者从多个表中检索数据时，使用UNION更简单一些。</p>
<ul>
<li><strong>UNION ALL</strong> 命令和 UNION 命令几乎是等效的，不过 UNION ALL 命令会列出所有的值。</li>
</ul>
<h2 id="SQL聚合"><a href="#SQL聚合" class="headerlink" title="SQL聚合"></a>SQL聚合</h2><p>有时候我们只是需要获取数据的汇总信息，比如说行数啊、平均值啊这种，并不需要吧所有数据都检索出来，为此，SQL提供了专门的函数，这也是SQL最强大功能之一。</p>
<h3 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h3><p>SQL的聚合函数如下所示：</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>AVG()</td>
<td>返回某列的均值</td>
</tr>
<tr>
<td>COUNT()</td>
<td>返回某列的行数</td>
</tr>
<tr>
<td>MAX()</td>
<td>返回某列的最大值</td>
</tr>
<tr>
<td>MIN()</td>
<td>返回某列的最小值</td>
</tr>
<tr>
<td>SUM()</td>
<td>返回某列的和</td>
</tr>
</tbody></table>
<p>使用示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(col_1) <span class="keyword">AS</span> avg_col_1</span><br><span class="line"><span class="keyword">FROM</span> table_1;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>注意：</strong>聚合函数都会忽略列中的NULL值，但是COUNT(*)也就是统计全部数据的行数时，不会忽略NULL值。</p>
</blockquote>
<h3 id="聚合不同值"><a href="#聚合不同值" class="headerlink" title="聚合不同值"></a>聚合不同值</h3><p>当添加DISTINCT参数时，就可以只对不同值（也就是某列中的唯一值）进行函数操作。</p>
<p>使用示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(<span class="keyword">DISTINCT</span> col_1) <span class="keyword">AS</span> avg_col_1</span><br><span class="line"><span class="keyword">FROM</span> table_1;</span><br></pre></td></tr></table></figure>

<h2 id="数据分组"><a href="#数据分组" class="headerlink" title="数据分组"></a>数据分组</h2><h3 id="创建分组（GROUP-BY）"><a href="#创建分组（GROUP-BY）" class="headerlink" title="创建分组（GROUP BY）"></a>创建分组（GROUP BY）</h3><p>前面的函数操作都是基于整个表去进行的，那如果想要依据某列中的不同类别（比如说不同品牌 不同性别等等）进行分类统计时，就要用到数据分组，在SQL中数据分组是使用GROUP BY子句建立的。</p>
<p>在使用GROUP BY时需要注意的几点：</p>
<ul>
<li>GROUP BY子句可以包含任意数量的列，因而可以对分组进行多重嵌套，类似于Pandas中的多重索引；</li>
<li>GROUP BY子句必须出现在WHERE子句之后，ORDER BY之前。</li>
</ul>
<p>使用示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col_1,<span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> num_col</span><br><span class="line"><span class="keyword">FROM</span> table_1</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> col_1;</span><br></pre></td></tr></table></figure>

<p>以上即可实现按col_1列中的不同类目进行行数统计。</p>
<h3 id="过滤分组（HAVING）"><a href="#过滤分组（HAVING）" class="headerlink" title="过滤分组（HAVING）"></a>过滤分组（HAVING）</h3><p>在SQL入门中我们学过WHERE，它是对行数据进行筛选过滤的，那么，如果我想对创建的分组数据进行筛选过滤呢？这时候，你就要用到HAVING子句了，它与WHERE的操作符一致，只是换了关键字而已。</p>
<p>使用示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col_1,<span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> num_col</span><br><span class="line"><span class="keyword">FROM</span> table_1</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> col_1</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*) &gt;= <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>这里我们就筛选出了具有两个以上类别的分组。</p>
<p><strong>注意：</strong>使用HAVING时应该结合GROUP BY子句。</p>
<h2 id="时间序列的处理（DATE）"><a href="#时间序列的处理（DATE）" class="headerlink" title="时间序列的处理（DATE）"></a>时间序列的处理（DATE）</h2><p>在SQL中有一套专门的内置函数，用来处理时间序列，那就是DATE函数。</p>
<h3 id="SQL-Date-数据类型"><a href="#SQL-Date-数据类型" class="headerlink" title="SQL Date 数据类型"></a>SQL Date 数据类型</h3><p>先了解一下在不同的数据库中的时间序列的表示。（了解即可）</p>
<p><strong>MySQL</strong> 使用下列数据类型在数据库中存储日期或日期/时间值：</p>
<ul>
<li>DATE - 格式：YYYY-MM-DD</li>
<li>DATETIME - 格式：YYYY-MM-DD HH:MM:SS</li>
<li>TIMESTAMP - 格式：YYYY-MM-DD HH:MM:SS</li>
<li>YEAR - 格式：YYYY 或 YY</li>
</ul>
<p><strong>SQL Server</strong> 使用下列数据类型在数据库中存储日期或日期/时间值：</p>
<ul>
<li>DATE - 格式：YYYY-MM-DD</li>
<li>DATETIME - 格式：YYYY-MM-DD HH:MM:SS</li>
<li>SMALLDATETIME - 格式：YYYY-MM-DD HH:MM:SS</li>
<li>TIMESTAMP - 格式：唯一的数字</li>
</ul>
<h3 id="DATE-TRUNC函数"><a href="#DATE-TRUNC函数" class="headerlink" title="DATE_TRUNC函数"></a>DATE_TRUNC函数</h3><p><strong>DATE_TRUNC</strong> 使你能够将日期截取到日期时间列的特定部分。常见的截取依据包括<code>日期</code>、<code>月份</code> 和 <code>年份</code>。</p>
<p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DATE_TRUNC(&#x27;datepart&#x27;, timestamp)</span><br></pre></td></tr></table></figure>

<p>其中<code>datepart</code>即为你的截取依据，后面的timestamp类型可以参考上面的Date数据类型。</p>
<blockquote>
<p> 我总结了一份SQL的<code>datepart</code>速查表放在了下面。</p>
</blockquote>
<p>使用示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_TRUNC(<span class="string">&#x27;y&#x27;</span>,col_date) col_year</span><br><span class="line"><span class="keyword">FROM</span> table_1</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">1</span> <span class="keyword">DESC</span></span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<p>如上，我们将col_date列按照年（’y’）进行了分组，并按由大至小的顺序排序，取前10组数据。</p>
<h3 id="DATE-PART函数"><a href="#DATE-PART函数" class="headerlink" title="DATE_PART函数"></a>DATE_PART函数</h3><p><strong>DATE_PART</strong> 可以用来获取日期的特定部分，如获取日期2018-10-6的月份，只会获得一个结果6，这是它与DATE_TRUNC的最大区别。</p>
<p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DATE_PART (&#x27;datepart&#x27;, date或timestamp)</span><br></pre></td></tr></table></figure>

<p>其中<code>datepart</code>即为你的截取依据，后面的timestamp类型可以参考上面的Date数据类型。</p>
<p>使用示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_PART(<span class="string">&#x27;y&#x27;</span>,col_date) col_year</span><br><span class="line"><span class="keyword">FROM</span> table_1</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>如上，我们筛选了col_date列的年份，并依据它做了分组。</p>
<blockquote>
<p>想了解更多DATE函数，可以戳<a target="_blank" rel="noopener" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/Date_functions_header.html">SQL日期和时间函数参考</a></p>
</blockquote>
<h3 id="datepart总结"><a href="#datepart总结" class="headerlink" title="datepart总结"></a>datepart总结</h3><p>如下给了很多的缩写，只记住最简单的即可。</p>
<table>
<thead>
<tr>
<th>日期部分或时间部分</th>
<th align="left">缩写</th>
</tr>
</thead>
<tbody><tr>
<td>世纪</td>
<td align="left">c、cent、cents</td>
</tr>
<tr>
<td>十年</td>
<td align="left">dec、decs</td>
</tr>
<tr>
<td>年</td>
<td align="left">y、yr、yrs</td>
</tr>
<tr>
<td>季度</td>
<td align="left">qtr、qtrs</td>
</tr>
<tr>
<td>月</td>
<td align="left">mon、mons</td>
</tr>
<tr>
<td>周</td>
<td align="left">w，与 <strong>DATE_TRUNC</strong>一起使用时将返回离时间戳最近的一个星期一的日期。</td>
</tr>
<tr>
<td>一周中的日 （ <strong>DATE_PART</strong>支持）</td>
<td align="left">dayofweek、dow、dw、weekday                                                                                                              返回 0–6 的整数（星期日是0，星期六是6）。</td>
</tr>
<tr>
<td>一年中的日 （ <strong>DATE_PART</strong>支持）</td>
<td align="left">dayofyear、doy、dy、yearday</td>
</tr>
<tr>
<td>日</td>
<td align="left">d</td>
</tr>
<tr>
<td>小时</td>
<td align="left">h、hr、hrs</td>
</tr>
<tr>
<td>分钟</td>
<td align="left">m、min、mins</td>
</tr>
<tr>
<td>秒</td>
<td align="left">s、sec、secs</td>
</tr>
<tr>
<td>毫秒</td>
<td align="left">ms、msec、msecs、msecond、mseconds、millisec、millisecs、millisecon</td>
</tr>
</tbody></table>
<h2 id="CASE语句"><a href="#CASE语句" class="headerlink" title="CASE语句"></a>CASE语句</h2><p>CASE语句其实就相当于python中的if语句，是用来做条件的。</p>
<p>需要注意的几点：</p>
<ul>
<li>CASE 语句始终位于 SELECT 条件中。</li>
<li>CASE 必须包含以下几个部分：WHEN、THEN 和 END。ELSE 是可选组成部分，用来包含不符合上述任一 CASE 条件的情况。</li>
<li>你可以在 WHEN 和 THEN 之间使用任何条件运算符编写任何条件语句（例如 WHERE），包括使用 AND 和 OR 连接多个条件语句。</li>
<li>你可以再次包含多个 WHEN 语句以及 ELSE 语句，以便处理任何未处理的条件。</li>
</ul>
<p>使用示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> account_id, <span class="keyword">CASE</span> <span class="keyword">WHEN</span> standard_qty = <span class="number">0</span> <span class="keyword">OR</span> standard_qty <span class="keyword">IS</span> <span class="literal">NULL</span> <span class="keyword">THEN</span> <span class="number">0</span></span><br><span class="line">                        <span class="keyword">ELSE</span> standard_amt_usd/standard_qty <span class="keyword">END</span> <span class="keyword">AS</span> unit_price</span><br><span class="line"><span class="keyword">FROM</span> orders</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<p>如上，我们使用CASE WHEN.(条件一).THEN.(条件一的结果).ELSE.(其他不符合条件一的结果).END语句，设立的两个条件，即当standard_qty为0或者不存在时我们返回0，当standard_qty不为0时进行计算，并储存为新列unit_price。</p>
<h2 id="子查询与临时表格"><a href="#子查询与临时表格" class="headerlink" title="子查询与临时表格"></a>子查询与临时表格</h2><p>我们之前所涉及到的都是从数据库表中检索数据的单条语句，但当我们想要检索的数据并不能直接从数据库表中获取，而是需要从筛选后的表格中再度去查询时，就要用到子查询和临时表格了。</p>
<p>子查询与临时表格所完成的任务是一致的，只不过子查询是通过嵌套查询完成，而另一种是通过WITH创建临时表格进行查询。</p>
<h3 id="构建子查询"><a href="#构建子查询" class="headerlink" title="构建子查询"></a>构建子查询</h3><p>构建子查询十分简单，只需将被查询的语句放在小括号里，进行嵌套即可，但在使用时一定要注意格式要清晰。</p>
<p>使用示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> (<span class="keyword">SELECT</span> DATE_TRUNC(<span class="string">&#x27;day&#x27;</span>,occurred_at) <span class="keyword">AS</span> <span class="keyword">day</span>,channel, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> <span class="keyword">events</span></span><br><span class="line">      <span class="keyword">FROM</span> web_events </span><br><span class="line">      <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span>,<span class="number">2</span></span><br><span class="line">      <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">3</span> <span class="keyword">DESC</span>) sub</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> channel</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">2</span> <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p>如上，我们创建了一个子查询，放在小括号里，并将其命名为sub。在子查询中也注意到了各个子句上下对齐，这样条例更清晰。</p>
<h3 id="临时表格（WITH）"><a href="#临时表格（WITH）" class="headerlink" title="临时表格（WITH）"></a>临时表格（WITH）</h3><p>这种方法，就是使用WITH将子查询的部分创建为一个临时表格，然后再进行查询即可。</p>
<p>我们还是使用上面子查询的例子，这次用临时表格的形式实现：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> sub <span class="keyword">AS</span>(</span><br><span class="line"><span class="keyword">SELECT</span> DATE_TRUNC(<span class="string">&#x27;day&#x27;</span>,occurred_at) <span class="keyword">AS</span> <span class="keyword">day</span>,channel, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> <span class="keyword">events</span></span><br><span class="line"><span class="keyword">FROM</span> web_events </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span>,<span class="number">2</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">3</span> <span class="keyword">DESC</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> sub</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> channel</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">2</span> <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p>如上，我们将被嵌套的子查询单独拎出来，用WITH创建了一个临时表格，再之后又使用SELECT根据该表格进行查询。</p>
<h2 id="SQL数据清理"><a href="#SQL数据清理" class="headerlink" title="SQL数据清理"></a>SQL数据清理</h2><p>这一节主要针对数据清理讲解了几个SQL中的常用函数，一般来说，也都是用在筛选阶段，更详尽的数据清理还是要放在python中去进行。</p>
<h3 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h3><ul>
<li><strong>LEFT、RIGHT、LENGTH</strong></li>
</ul>
<p>LEFT和RIGHT相当于是字符串截取，<strong>LEFT</strong> 是从左侧起点开始，从特定列中的每行获取一定数量的字符，而<strong>RIGHT</strong>是从右侧。</p>
<p><strong>LENGTH</strong>就是获取字符串的长度，相当于python中的len()。</p>
<p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LEFT(phone_number, 3) <span class="comment">-- 返回从左侧数，前三个字符</span></span><br><span class="line">RIGHT(phone_number, 8)</span><br><span class="line">LENGTH(phone_number) </span><br></pre></td></tr></table></figure>

<ul>
<li><strong>POSITION</strong>、<strong>STRPOS</strong>、<strong>SUBSTR</strong></li>
</ul>
<p>这三个函数都是与<strong>位置</strong>相关的函数。</p>
<p><strong>POSITION</strong> 和<strong>STRPOS</strong> 可以获取某一字符在字符串中的位置，这个位置是从左开始计数，最左侧第一个字符位置为1，但他俩的语法稍有不同。</p>
<p><strong>SUBSTR</strong>可以筛选出指定位置后指定数量的字符。</p>
<p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POSITION(&#x27;,&#x27; IN city_state)</span><br><span class="line">STRPOS(city_state, ‘,’) <span class="comment">--跟上面的语句等价</span></span><br><span class="line">SUBSTR(city_state,4,5) <span class="comment">-- 返回city_state字符串中，以第4个字符开头的5个字符。</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>字符串拼接（CONCAT）</strong></li>
</ul>
<p>顾名思义，就是将两个字符串进行拼接。</p>
<p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CONCAT(first_name, &#x27; &#x27;, last_name) <span class="comment">-- 结果为：first_name last_name</span></span><br><span class="line"><span class="comment">--或者你也可以使用双竖线来实现上述任务</span></span><br><span class="line">first_name || &#x27; &#x27; || last_name</span><br></pre></td></tr></table></figure>

<h3 id="更改数据格式"><a href="#更改数据格式" class="headerlink" title="更改数据格式"></a>更改数据格式</h3><ul>
<li>TO_DATE函数</li>
</ul>
<p>TO_DATE函数可以将某列转为DATE格式，主要是将单独的月份或者年份等等转换为SQL可以读懂的DATE类型数据。</p>
<p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TO_DATE(col_name,&#x27;datepart&#x27;) </span><br><span class="line">TO_DATE(&#x27;02 Oct 2001&#x27;, &#x27;DD Mon YYYY&#x27;);</span><br></pre></td></tr></table></figure>

<p>这里是将col_name这列按照datepart转化为DATE类型的数据，datepart可以参考之前的总结。</p>
<ul>
<li>CAST函数</li>
</ul>
<p>CAST函数是SQL中进行数据类型转换的函数，但经常用于将字符串类型转换为时间类型。</p>
<p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CAST(date_column AS DATE)</span><br><span class="line"><span class="comment">-- 你也可以写成这样</span></span><br><span class="line">date_column::DATE</span><br></pre></td></tr></table></figure>

<p>这里是将date_column转换为DATE格式的数据，其他时间相关的数据类型与样式对照可以参考上面写过的<strong>SQL Date数据类型</strong>，确保你想转换的数据样式与数据类型对应。</p>
<h3 id="缺失值的处理"><a href="#缺失值的处理" class="headerlink" title="缺失值的处理"></a>缺失值的处理</h3><p>之前有提到过如何筛选出缺失值，即使用<strong>WHERE</strong>加上<strong>IS NULL</strong>或者<strong>IS NOT NULL</strong>。</p>
<p>那么如何对缺失值进行处理呢？（其实这里可以直接无视，筛选出来后在python中再进行处理）</p>
<p>SQL中提供了一个替换NULL值的函数<strong>COALESCE</strong>。</p>
<p>使用示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">COALESCE(col_1,0) <span class="comment">-- 将col_1中的NULL值替换为0</span></span><br><span class="line">COALESCE(col_2,&#x27;no DATA&#x27;) <span class="comment">-- 将col_2中的NULL值替换为no DATA</span></span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>好啦，至此课程中的所有SQL知识点已经总结完了，并且也给大家做了适当的补充，希望大家能够用得上。未来的数据分析师之路，还要继续加油呀！</p>
<p><img src="http://wx4.sinaimg.cn/bmiddle/006Cmetyly1fmtcyy5h20j30dw0dwaiw.jpg"></p>
<h1 id="附：SELECT子句顺序"><a href="#附：SELECT子句顺序" class="headerlink" title="附：SELECT子句顺序"></a>附：SELECT子句顺序</h1><p>下表中列出了全文中涉及到的子句，在进行使用时，应严格遵循下表中从上至下的顺序。</p>
<table>
<thead>
<tr>
<th>子句</th>
<th>说明</th>
<th>是否必须使用</th>
</tr>
</thead>
<tbody><tr>
<td>SELECT</td>
<td>要返回的列或表达式</td>
<td>是</td>
</tr>
<tr>
<td>FROM</td>
<td>用于检索数据的表</td>
<td>仅在从表中选择数据时使用</td>
</tr>
<tr>
<td>JOIN…ON…</td>
<td>用于链接表</td>
<td>仅在需要链接表时使用</td>
</tr>
<tr>
<td>WHERE</td>
<td>过滤行数据</td>
<td>否</td>
</tr>
<tr>
<td>GROUP BY</td>
<td>分组数据</td>
<td>仅在按组计算时使用</td>
</tr>
<tr>
<td>HAVING</td>
<td>过滤分组</td>
<td>否</td>
</tr>
<tr>
<td>ORDER BY</td>
<td>对输出进行排序</td>
<td>否</td>
</tr>
<tr>
<td>LIMIT</td>
<td>限制输出的行数</td>
<td>否</td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.capallen.top/2018/%E9%A1%B9%E7%9B%AE%E5%9B%9B.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Allen Jia">
      <meta itemprop="description" content="数据 算法 分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Blog">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/%E9%A1%B9%E7%9B%AE%E5%9B%9B.html" class="post-title-link" itemprop="url">每周导学-第十二周-项目四</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-26 22:30:09" itemprop="dateCreated datePublished" datetime="2018-09-26T22:30:09+08:00">2018-09-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2019-06-06 10:32:23" itemprop="dateModified" datetime="2019-06-06T10:32:23+08:00">2019-06-06</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a>
        </span>
    </span>

  
    <span id="/2018/%E9%A1%B9%E7%9B%AE%E5%9B%9B.html" class="post-meta-item leancloud_visitors" data-flag-title="每周导学-第十二周-项目四" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/%E9%A1%B9%E7%9B%AE%E5%9B%9B.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/%E9%A1%B9%E7%9B%AE%E5%9B%9B.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p> Better together . —— Udacity</p>
</blockquote>
<p>Hi，同学们，经过前两周的学习，我们掌握了描述统计学基础、概率论基础、推论统计学中的置信区间、假设检验以及机器学习入门知识——回归，本章的内容偏理论性更多一些，需要更多得去实操来加强自己的理解能力，这周呢我们就来个实打实的项目来检验前两周的所学。项目为<strong>分析A/B测试结果</strong>，在开始项目前，请一定要把前面的几个小测试做了，这样做项目更好上手一些。大家加油！通过这个项目，就可以拿到入门的毕业证啦！！！</p>
<p><strong>项目四(P4)阶段</strong>总共包含<strong>三周</strong>，在这三周内，我们要对<strong>统计学</strong>进行学习，掌握基础的<strong>描述统计学理论、基本的概率知识、二项分布和贝叶斯公式</strong>，并学会<strong>使用 Python 来实践</strong>；学习<strong>正态分布、抽样分布、置信区间以及假设检验的概念和计算方式</strong>；学习<strong>线性回归以及逻辑回归</strong>，在真实场景中应用，比如<strong>分析 A/B 测试</strong>结果，搭建简单的监督机器学习模型。可谓是时间紧任务重，但是也别怕，统计学的基础知识还是非常简单的，跟着课程内容一步步来，自己多做笔记多查资料，一定没问题的！</p>
<p>那么我们的课程安排：</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody><tr>
<td>第1周</td>
<td>统计学基础</td>
<td>描述统计学 - 抽样分布与中心极限定理</td>
</tr>
<tr>
<td>第2周</td>
<td>统计学进阶</td>
<td>置信区间 - 逻辑回归</td>
</tr>
<tr>
<td><strong>第3周</strong></td>
<td><strong>完成项目</strong></td>
<td><strong>项目：分析A/B测试结果</strong></td>
</tr>
</tbody></table>
<p>本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/必应搜索、<a target="_blank" rel="noopener" href="https://www.csdn.net/">CSDN</a>、<a target="_blank" rel="noopener" href="https://stackoverflow.com/">stack<strong>overflow</strong></a></li>
<li>额外参考资料：<ul>
<li><a target="_blank" rel="noopener" href="https://www.khanacademy.org/math/statistics-probability">可汗学院概率论与统计课程</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/%E6%9C%BA%E4%BC%9A%E7%9A%84%E6%95%B0%E5%AD%A6-%E9%99%88%E5%B8%8C%E5%AD%BA.pdf">机会的数学-陈希孺</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/%E6%9D%A1%E4%BB%B6%E6%A6%82%E7%8E%87%E5%8F%8A%E5%85%A8%E6%A6%82%E7%8E%87%E5%85%AC%E5%BC%8F%E5%8F%8A%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%85%AC%E5%BC%8F.pdf">条件概率及全概率公式及贝叶斯公式</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/statistics%20for%20data%20science.pdf">statistics for data science</a></li>
</ul>
</li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p><strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><p>完成并通过项目四！</p>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody><tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>项目四</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody></table>
<h1 id="项目指南"><a href="#项目指南" class="headerlink" title="项目指南"></a>项目指南</h1><h2 id="项目详情"><a href="#项目详情" class="headerlink" title="项目详情"></a>项目详情</h2><p>数据分析师和数据学家经常使用 A/B 测试。在这个项目中，你将会理解电子商务网站运营 A/B 测试的结果。你的目标是通过课程中给的Jupyter Notebook，帮助公司理解他们是否应该设计新页面、保留原有网页或延长测试时间以便做出决定。</p>
<p>项目前面的几个小测试，需要大家针对项目提供的数据进行操作并回答，你可以打开两个网页，也可以在本地进行操作。</p>
<blockquote>
<p>当然还是建议大家下载到本地进行操作，如果文件下载失败，请微信联系我。</p>
</blockquote>
<blockquote>
<p>关于A/B-test:</p>
<p><strong>AB 测试</strong>就是为了验证在先验条件的存在的情况下，进行新的变更是否合理和可行以达到优化的目的。使用 AB 测试的方式能能够度量变更对某些指标的变化，是变更更具有合理性依据更充分。</p>
<p>AB 测试也存在 <strong>不适用的场景</strong>：1）对没有明确参照的试验，AB 测试是基于先验条件的优化，如果没有一个参照对比是无法进行测试。2）数据获取时间长，AB 测试一般都是进行小规模快速的试验，所以对于数据获取的单周期较长的试验不太适用。</p>
<p>影响测试效果的因素：1）<strong>新奇效应</strong>：即<code>Novelty Effect</code> 指老用户可能会觉得变化很新鲜，受变化吸引而偏爱新版本，哪怕从长远看来新版本并无益处。2）<strong>抗拒改变心理</strong>：即 <code>Change Aversion</code> 老用户可能会因为纯粹不喜欢改变而偏爱旧版本，哪怕从长远来看新版本更好。</p>
</blockquote>
<p>在课程项目中，我们分成了三块涵盖了本章的所有知识点，这三块分别为：</p>
<ul>
<li>概率</li>
<li>A/B测试</li>
<li>回归</li>
</ul>
<p>如果在项目进行中，有知识点遗漏或忘记的地方，可以去查看相关课程视频或者导学，之后，记在你的小本本上。</p>
<h2 id="I-概率"><a href="#I-概率" class="headerlink" title="I - 概率"></a>I - 概率</h2><p>本节的问题都相对比较简单，所以在导学中不过多赘述了。</p>
<h3 id="测试1-理解数据集"><a href="#测试1-理解数据集" class="headerlink" title="测试1-理解数据集"></a>测试1-理解数据集</h3><p>这里没什么难度，基本的pandas知识，如果这节有什么问题的话，请查看<a href="http://www.capallen.top/dand-vip/2018/08/19/%E7%AC%AC%E5%85%AD%E5%91%A8-1-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E8%BF%87%E7%A8%8B/">第六周导学</a>并面壁十分钟-。-</p>
<blockquote>
<p>如果非要提醒一下的话，那就是在问题<strong>e.  <code>new_page</code> 与 <code>treatment</code> 不一致的次数</strong>中，不要忘了也看看old_page与control的不一致次数，二者相加才是结果。</p>
</blockquote>
<h3 id="测试3-更新后的数据集"><a href="#测试3-更新后的数据集" class="headerlink" title="测试3-更新后的数据集"></a>测试3-更新后的数据集</h3><ul>
<li>a问题中，因为要将处理后的数据集保存为新的变量，所以使用drop函数时，可以不用使用inplace = True参数。</li>
<li>d问题中，因为两个重复值除了时间戳不一致外，其他信息都是一致的，所以随便删除一个重复即可。</li>
</ul>
<h2 id="II-A-B测试"><a href="#II-A-B测试" class="headerlink" title="II - A/B测试"></a>II - A/B测试</h2><h3 id="1-零假设与备择假设"><a href="#1-零假设与备择假设" class="headerlink" title="1.零假设与备择假设"></a>1.零假设与备择假设</h3><p>这里只说一点，就是如何在Jupyter Notebook中使用公式的问题，其实也就是如何在Markdown中使用公式的问题，你只需要按照如下步骤即可：</p>
<ul>
<li><p>打开<a target="_blank" rel="noopener" href="http://latex.codecogs.com/eqneditor/editor.php">Latex公式在线转换</a>，输入好公式后，复制代码</p>
</li>
<li><p>将你想要输入公式的代码框，转为Markdown格式；</p>
</li>
<li><p>输入两个美元符号，即$$;</p>
</li>
<li><p>将刚复制的公式代码粘贴到两个美元符号中间，然后运行该代码框即可。</p>
<p>录了一个gif在下面，可以参考下：</p>
</li>
</ul>
<p><img src="https://s1.ax1x.com/2018/09/26/iMRliF.gif" alt="iMRliF.gif"></p>
<h3 id="2-进行假设检验"><a href="#2-进行假设检验" class="headerlink" title="2.进行假设检验"></a>2.进行假设检验</h3><ul>
<li>a、b</li>
</ul>
<p>注意题干中给的要求是：假定在零假设中，不管是新页面还是旧页面， pnew 和 pold 都具有等于 <strong>转化</strong> 成功率的“真”成功率，也就是说，  pnew 与 pold是相等的。此外，假设它们都等于<strong>ab_data.csv</strong> 中的 <strong>转化</strong> 率，新旧页面都是如此。</p>
<p>也就是：p_new = p_old = p_ab_data</p>
<blockquote>
<p><strong>注意：</strong>这并不意味着零假设就是p_new = p_old，可以从后续的c-g步骤能看出，零假设为p_new - p_old ≤ 0</p>
</blockquote>
<ul>
<li>c、d</li>
</ul>
<p>这里的n_new与n_old就是对ab_data中使用新旧页面的<strong>用户数量</strong>进行统计。</p>
<ul>
<li>e、f、g</li>
</ul>
<p>使用numpy.random.choice函数，将零假设中的p_new与p_old作为抽样概率，n_new与n_old作为抽样次数，用1表示‘转化成功’，0表示‘未转化成功’，并将结果储存在一个新变量当中。</p>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new_page_converted = np.random.choice([<span class="number">0</span>,<span class="number">1</span>],n_new,p = [<span class="number">1</span>-p_new,p_new])</span><br></pre></td></tr></table></figure>

<p>以上获得的这个新变量，就是我们按照零假设中的n_new抽样n_new次的转化与否的分布模拟，那如何看模拟后的转化率呢？很简单，一个函数就搞定了，这里自己想。</p>
<ul>
<li>h、i、j</li>
</ul>
<p>这三步是使用for循环，将上面的过程不断重复10000次，获得一个抽样分布直方图，这个图会是正态分布吗？</p>
<p>关于实际观测值，即为你利用ab_data.csv直接计算得来的new_page与old_page转化率之差。</p>
<p>j中得到的值是什么呢？是不是在零假设的条件下，观察到实际观测值甚至更极端（更支持备择假设）的概率？那这个值的学名叫什么？</p>
<p>【这里实际上进行的是单尾检验，也就是对备择假设为p_new - p_old &gt; 0来进行的】</p>
<ul>
<li>i、m</li>
</ul>
<p>使用了statsmodels中的proportions_ztest函数进行检验。实现的功能和上述a-j是一致的。</p>
<p>为什么要选择这个函数，以及这个函数的用法可以参考课程中给的链接<a target="_blank" rel="noopener" href="http://knowledgetack.com/python/statsmodels/proportions_ztest/">proportions_ztest</a>。</p>
<p>不过值得注意的是，在链接的列子中，使用的是双尾检验，也就是针对备择假设为p_new ≠ p_old去做的；但是在课程项目中，我们的备择假设为p_new &gt; p_old，也就是单尾检验，所以函数中的某个参数要改一下。</p>
<p>使用内置函数方法获得的p值应该与前面获得的p值相近，如果差太多，那肯定是有地方需要再琢磨琢磨。</p>
<h2 id="III-回归"><a href="#III-回归" class="headerlink" title="III - 回归"></a>III - 回归</h2><ul>
<li>a</li>
</ul>
<p>要想知道执行哪种类型的回归，就应该先看变量是属于数值变量还是分类变量，那题设中的变量是什么类型的变量呢？</p>
<ul>
<li>b</li>
</ul>
<p>要求是：创建一个 <strong>ab_page</strong> 列，当用户接收 <strong>treatment</strong> 时为1， <strong>control</strong> 时为0。所以在对group列使用get_dummies函数时，应该把生成的treatment列保存为ab_page列，而control列则应该被删掉。</p>
<ul>
<li>c、d</li>
</ul>
<p>注意的一点是：<strong>不要忘了添加截距。</strong>在进行结果解释的时候，我们并不关注截距，只是关注变量的coef系数和p值，先看p值是否具有显著性，若有再看coef系数，若没有，则该变量对因变量没有影响。</p>
<ul>
<li>e</li>
</ul>
<p>在思考零假设与备择假设之前，注意看结果中标红框的位置，想想这是什么意思，这说明在回归计算中，采用的是单尾检验还是双尾？单尾和双尾又分别对应的假设是什么？</p>
<p><img src="https://s1.ax1x.com/2018/09/27/iQQBSs.png" alt="iQQBSs.png"></p>
<ul>
<li>g</li>
</ul>
<p><strong>数据集融合问题</strong>，之前单独出过一篇导学，如果忘了，请戳：<a href="http://www.capallen.top/dand-vip/2018/08/21/%E7%AC%AC%E5%85%AD%E5%91%A8-2-%E6%95%B0%E6%8D%AE%E8%9E%8D%E5%90%88/">Pandas数据融合</a>，提醒下，合并时采用内连接，可以省去一些麻烦；</p>
<p><strong>get_dummies</strong>，注意该函数生成数据的顺序是按照字典顺序来的，所以，你在进行操作时，为了确保顺序不乱，最好能先看一下生成的结果，再进行重命名。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>大家能坚持到最后一个项目，十分不易，不过对于数据分析生涯来说，这只是你的开始，请继续保持这段时间的学习状态，如果非要给这个保持加一个期限的话，我希望是一辈子！大家加油！等你们的好消息！！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.capallen.top/2018/Advanced-statistic-in-Data-Analysis.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Allen Jia">
      <meta itemprop="description" content="数据 算法 分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Blog">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/Advanced-statistic-in-Data-Analysis.html" class="post-title-link" itemprop="url">每周导学-第十一周-统计学进阶</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-24 22:30:09" itemprop="dateCreated datePublished" datetime="2018-09-24T22:30:09+08:00">2018-09-24</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2019-06-06 11:25:46" itemprop="dateModified" datetime="2019-06-06T11:25:46+08:00">2019-06-06</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a>
        </span>
    </span>

  
    <span id="/2018/Advanced-statistic-in-Data-Analysis.html" class="post-meta-item leancloud_visitors" data-flag-title="每周导学-第十一周-统计学进阶" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/Advanced-statistic-in-Data-Analysis.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/Advanced-statistic-in-Data-Analysis.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p> Everything is difficult until you know how to do it.</p>
</blockquote>
<p>Hi，同学们，上周我们学习了统计学基础知识，包括概率基础、描述统计学和推论统计学的基础知识，本周我们将会进一步学习推论统计学——<strong>置信区间&amp;假设检验</strong>以及它们的应用之一<strong>A/B-test</strong>，在这之后，我们还会讲解一部分机器学习入门——<strong>线性回归&amp;逻辑回归</strong>，与上周相比，这周我们会接触较深的理论知识，更多的代码，你可能会觉得学起来有些吃力，但请一定保持信心，你可以多次暂停观看课程中的讲解视频，跟着一起多动手，或者你也可以按照下面我给出的<strong>额外资料</strong>去查漏补缺，相信你们一定可以的！</p>
<p><strong>项目四(P4)阶段</strong>总共包含<strong>三周</strong>，在这三周内，我们要对<strong>统计学</strong>进行学习，掌握基础的<strong>描述统计学理论、基本的概率知识、二项分布和贝叶斯公式</strong>，并学会<strong>使用 Python 来实践</strong>；学习<strong>正态分布、抽样分布、置信区间以及假设检验的概念和计算方式</strong>；学习<strong>线性回归以及逻辑回归</strong>，在真实场景中应用，比如<strong>分析 A/B 测试</strong>结果，搭建简单的监督机器学习模型。可谓是时间紧任务重，但是也别怕，统计学的基础知识还是非常简单的，跟着课程内容一步步来，自己多做笔记多查资料，一定没问题的！</p>
<p>那么我们的课程安排：</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody><tr>
<td>第1周</td>
<td>统计学基础</td>
<td>描述统计学 - 抽样分布与中心极限定理</td>
</tr>
<tr>
<td><strong>第2周</strong></td>
<td><strong>统计学进阶</strong></td>
<td><strong>置信区间 - 逻辑回归</strong></td>
</tr>
<tr>
<td>第3周</td>
<td>完成项目</td>
<td>项目：分析A/B测试结果</td>
</tr>
</tbody></table>
<p>本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/必应搜索、<a target="_blank" rel="noopener" href="https://www.csdn.net/">CSDN</a>、<a target="_blank" rel="noopener" href="https://stackoverflow.com/">stack<strong>overflow</strong></a></li>
<li>额外参考资料：<ul>
<li><a target="_blank" rel="noopener" href="https://www.khanacademy.org/math/statistics-probability">可汗学院概率论与统计课程</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/%E6%9C%BA%E4%BC%9A%E7%9A%84%E6%95%B0%E5%AD%A6-%E9%99%88%E5%B8%8C%E5%AD%BA.pdf">机会的数学-陈希孺</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/%E6%9D%A1%E4%BB%B6%E6%A6%82%E7%8E%87%E5%8F%8A%E5%85%A8%E6%A6%82%E7%8E%87%E5%85%AC%E5%BC%8F%E5%8F%8A%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%85%AC%E5%BC%8F.pdf">条件概率及全概率公式及贝叶斯公式</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/statistics%20for%20data%20science.pdf">statistics for data science</a></li>
</ul>
</li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p><strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><p>学习课程中的<strong>置信区间 - 逻辑回归</strong>课程，掌握统计学进阶知识。</p>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody><tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>置信区间 - 逻辑回归</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody></table>
<h1 id="知识清单"><a href="#知识清单" class="headerlink" title="知识清单"></a>知识清单</h1><h2 id="置信区间"><a href="#置信区间" class="headerlink" title="置信区间"></a>置信区间</h2><p>学习之前可以先回顾一下正态分布、抽样分布和中心极限定理的相关知识。</p>
<h3 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h3><p>还记得上周用到的优达学生喝咖啡的数据吗？我们同样以此为例来探讨下置信区间是什么。</p>
<p>假设，优达的学生有数十万个（<strong>总体</strong>），而我们能获得的学生数据只有几百个（<strong>样本</strong>），我们通过做样本均值进行抽样分布，得到了一个近似正态分布的图形，但这也仅仅是样本的均值分布，也就是<strong>样本统计量</strong>。我们利用样本统计量的分布去构造总体均值（<strong>总体参数</strong>）的估计区间，就叫做<strong>置信区间</strong>。</p>
<h3 id="有什么"><a href="#有什么" class="headerlink" title="有什么"></a>有什么</h3><ul>
<li><p>置信区间的两种应用</p>
<ul>
<li><p>刚才的举例中我们用得是“均值”，这算是利用抽样分布建立<strong>单个参数的置信区间</strong>，可以应用在单变量估计等方面；</p>
</li>
<li><p>你还可以计算两种分类之间均值的差，这就是<strong>两个参数的置信区间</strong>，可以用在两变量的对比(A/B-Test)上，比如说医学上不同药物的治疗效果，不同广告的吸金率，不同网页的点击率等等。</p>
</li>
</ul>
</li>
<li><p>置信区间的显著性</p>
<ul>
<li><p><strong>统计显著性</strong>：即我们通过理论分析得到的结果。在统计学上用α表示，叫做<em>显著性水平</em>，它表达的是区间估计的不可靠概率。比如说，我们获取了95%的置信区间，那么显著性水平α = 1 - P = 5%。</p>
<blockquote>
<p>一般的，显著性水平都要求达到5%即可，这在之后的假设检验中会学习到。</p>
</blockquote>
</li>
<li><p><strong>实际显著性</strong>：即我们除了理论分析得到的结果外，还要考虑实际情况，比如说你能有多少资金用于投资，或者你的网站承载力能达到多少等。</p>
</li>
</ul>
</li>
<li><p>与传统置信区间方法的对比</p>
<p>传统的置信区间/假设检验方法有很多，比如说t-检验、双边t-检验等等，但是我们所掌握的<strong>自助取样法</strong>可以代替他们全部，当然有一个前提条件，那就是你的样本容量一定要足够大，如果你的样本容量实在是少，那就只能选择传统方法去处理了。</p>
<blockquote>
<p>获取传统方法python代码的方法，请自行去Stackoverflow搜索。</p>
</blockquote>
</li>
<li><p>准确性&amp;可靠性</p>
<p>这里课程中翻译的有点儿晦涩，这里着重讲一下，我们以候选人A为例（在95%可靠性下具有34%±3%的支持率），大概分布可以如下所示：<del>字丑就将就着点看吧。。。</del></p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/iVvVW8"><img src="https://s1.ax1x.com/2018/09/16/iVvVW8.md.png" alt="iVvVW8.md.png"></a></p>
<ul>
<li>在上图中我们能发现，置信区间的置信概率（可靠性）越高，置信区间的宽度也就越宽，误差范围（准确性）也就会越大；那么当我们缩小误差范围时，置信区间的宽度和可靠性也就随之降低。</li>
<li>结论：置信区间的准确性和可靠性是一对相互矛盾的标准，所以在实际工作中，只能提出其中一个条件，然后推求另一条件的变动情况，如果所推求的另一条件不能满足要求，就应该考虑增加样本容量，重新进行抽样，直至符合要求为止。</li>
</ul>
</li>
</ul>
<h3 id="怎么用"><a href="#怎么用" class="headerlink" title="怎么用"></a>怎么用</h3><p>课程中已经给出了很好的示例、问题及解答，在这里只是拎出一些面生的代码进行讲解。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置随机种子，能保证结果之后可以复现</span></span><br><span class="line">np.random.seed(<span class="number">7</span>)</span><br><span class="line"><span class="comment">#按百分比取值</span></span><br><span class="line">np.percentile(array,q)<span class="comment">#q介于0到100，取的是array中的q%位置的数。（从小至大排序）</span></span><br><span class="line"><span class="comment">#拓展——按分位数取值，其实效果和上面按百分比取值一样，只是q值的范围变了</span></span><br><span class="line">np.quantile(array,q)<span class="comment">#q介于0到1，取的是array中的q位置的数。</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：置信区间和假设检验只关注的是总体参数，而不能对某一个体下结论。</p>
</blockquote>
<h2 id="假设检验"><a href="#假设检验" class="headerlink" title="假设检验"></a>假设检验</h2><h3 id="是什么-1"><a href="#是什么-1" class="headerlink" title="是什么"></a>是什么</h3><ul>
<li>基本概念</li>
</ul>
<p>刚才我们讲解了什么是置信区间——为了得到总体指标，使用<strong>样本统计量</strong>去估计<strong>总体参数</strong>——这是一个从样本出发去研究总体的过程。</p>
<p>我们现在换一个角度，在实际分析问题中，能否去假定<strong>总体参数</strong>，然后根据样本数据，去检验这种假定是否正确，从而实现对总体指标的分析？其实这种从总体出发，用样本尺度去检验实现对总体参数分析的过程，就叫做<strong>假设检验</strong>。</p>
<blockquote>
<p><strong>置信区间与假设检验的关系</strong>：从上面的表述可以看出，假设检验和置信区间在本质上是一致的。如果使用样本数据对总体参数进行估计，在一定的置信区间下，总体参数就应该落在这个区间，如果假设的总体参数不在该区间中，则就有理由拒绝该假设，这其实就是从置信区间的角度去完成了假设检验的工作内容。</p>
</blockquote>
<ul>
<li><p>名词解释</p>
<ul>
<li><strong>零假设H0</strong>：一般的，零假设就是你不想要的结果，总包含等号。我们的目的就是要证明零假设是不成立的，是可拒绝的。比如说，你更新了网页设计，不想看到的是更不更新对你网站的流量没什么影响，那么零假设就可以这样设置。</li>
<li><strong>备择假设H1</strong>：一般的，这就是你想要的结果。注意，备择假设应该是零假设的对立。</li>
<li>一类错误：原假设H0为真，却被拒绝。也叫拒真概率，一类错误是更为严重的错误。</li>
<li>二类错误：原假设H0为假，却被接受。也叫受伪概率。</li>
</ul>
<blockquote>
<p>在实际工作中，我们不可能要求一个检验方法永远不出错，但可以要求尽可能地减少犯错误的概率。但在样本容量给定的条件下，两种错误发生的概率必是此消彼长，因此，我们通常是控制第一类错误的概率，使它不超过某一给定的值（一般的取0.05），这样加以控制第一类错误，以此来制约犯第二类错误的概率。</p>
</blockquote>
<ul>
<li><p><strong>p值</strong>：当零假设为真时，我们以<strong>零假设的参数</strong>建立正态分布（根据中心极限定理，当样本数量和抽样次数足够大时，抽样分布趋于正态分布），在该正态分布中观察到<strong>样本统计量</strong>甚至是更极端值（也就是偏向备则假设）的概率。</p>
<p>若这个概率很大，比如说p = 1，那么就表示样本统计量在按照零假设模拟的正态分布内，我们就不能拒绝零假设；</p>
<p>若这个概率很小，比如说 p &lt; 0.05，那么在我们模拟的正态分布中观察到样本统计量的概率就是一个<strong>小概率事件</strong>，我们就可以拒绝零假设；</p>
<p>若p值等于0.05，可增加样本容量，重新进行抽样检验。</p>
</li>
</ul>
</li>
</ul>
<h3 id="有什么-1"><a href="#有什么-1" class="headerlink" title="有什么"></a>有什么</h3><ul>
<li><p>假设检验的基本思想</p>
<ul>
<li><strong>逻辑上的反证法</strong>：我们先假设原命题（零假设H0）成立，然后推出明显矛盾的结果，证明原命题不成立，则我们的所证命题（备择假设H1）成立。</li>
<li><strong>小概率事件</strong>：概率很小的随机事件再一次随机实验中可以认为几乎是不会发生的，这就是小概率事件，我们证明零假设H0不成立，就是利用的小概率事件。</li>
</ul>
<p>假设检验的基本思想可以归纳为：我们把不想要的结果（即零假设H0）假设成立，然后利用样本计算出该假设成立时的概率（即支持该假设的概率，也就是<strong>p-value</strong>），如果这个概率小于显著性水平α（一般的为0.05），那么就可以说明零假设是小概率事件，可以拒绝，就证明了我们想要的结果（即备择假设H1）成立，可以表述为：<strong>在显著性水平α下拒绝原假设</strong>。</p>
<blockquote>
<p>试着理解一下上面这段话，如果理解不了，可以看看<strong>怎么用</strong>，会有详细的分步讲解。</p>
</blockquote>
</li>
<li><p>进行多次假设检验的校正</p>
<ul>
<li>Bonferroni Correction：是一种降低多重比较时第一类错误的矫正方法，举例说明该用法：如果你想在 20 个假设检验中把 I 类错误率维持在 1%，<strong>邦弗朗尼</strong> 校正率应为 0.01/20 = 0.0005。你应该使用这个新比率作为显著性水平α，对比每 20 个检验的 p 值，再做出决定。</li>
</ul>
</li>
</ul>
<h3 id="怎么用-1"><a href="#怎么用-1" class="headerlink" title="怎么用"></a>怎么用</h3><ul>
<li>建立假设： 一般的都是均值或和与某数值之间的关系。示例如下：</li>
</ul>
<p>$$<br>H_0:\mu  \leqslant 7<br>$$</p>
<p>$$<br>H_1:\mu  &gt;  7<br>$$</p>
<ul>
<li>进行多次重复取样（自助法）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#从原数据集中取样，样本容量要大于30</span></span><br><span class="line">sample_df = df.sample(<span class="number">100</span>)</span><br><span class="line"><span class="comment">#新建列表</span></span><br><span class="line">means = []</span><br><span class="line"><span class="comment">#循环取样，并计算均值，存贮在列表中</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">10000</span>):</span><br><span class="line">    bootsample = sample_df.sample(<span class="number">100</span>,replace = <span class="literal">True</span>)<span class="comment">#设置重复取样</span></span><br><span class="line">    means.append(bootsample.height.mean())<span class="comment">#计算数据集中height变量的均值</span></span><br></pre></td></tr></table></figure>

<ul>
<li>构建零假设的正态分布（因为根据中心极限定理可知，当样本容量足够大，取样次数足够多时，均值的抽样分布近似于正态分布）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#计算抽样分布的标准差</span></span><br><span class="line">null_std = np.std(means)</span><br><span class="line"><span class="comment">#构建正态分布</span></span><br><span class="line">null_vals = np.random.normal(<span class="number">7</span>,null_std,<span class="number">10000</span>)<span class="comment">#三个参数依次为正态分布的均值、标准差和取值数量，其中均值即为零假设设置的值。</span></span><br></pre></td></tr></table></figure>

<ul>
<li>计算p值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#计算原始样本的均值</span></span><br><span class="line">sample_mean = sample_df.height.mean()</span><br><span class="line"><span class="comment">#计算支撑原假设的概率，即p值。计算由原假设构建的正态分布（均值为7）大于样本统计量的概率。</span></span><br><span class="line">p_value = (null_vals &gt; sample_mean).mean()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>若零假设为：u ≥ 7，则p_value = (null_vals &lt; sample_mean ).mean();</p>
<p>若零假设为：u = 7，则p_value = (null_vals &lt; sample_mean).mean() + (null_vals &gt; null_mean  + (null_mean - sample_mean) ).mean()</p>
</blockquote>
<h2 id="线性回归"><a href="#线性回归" class="headerlink" title="线性回归"></a>线性回归</h2><h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><p>线性回归是属于机器学习中监督学习范畴的一种简单预测算法。我们通过查看两个<strong>定量变量</strong>之间是否存在线性关系，来进行预测。一般使用<strong>散点图</strong>对变量之间的关系进行可视化。</p>
<ul>
<li><p><strong>反应变量</strong>就是你想进行预测的变量，其实也就是因变量(y)；</p>
</li>
<li><p><strong>解释变量</strong>就是你用于预测的变量，其实也就是自变量(x)。</p>
</li>
<li><p><strong>相关系数</strong>：最常用的就是<strong>皮尔逊相关系数</strong>，用r表示，取值范围为[-1,1]，正值表示正相关，负值表示负相关，绝对值越大，相关性就越强。在描述相关性强弱时，可以参考如下取值范围：</p>
<p><img src="https://s1.ax1x.com/2018/09/19/imFK0K.png" alt="imFK0K.png"></p>
<blockquote>
<p> 关于更多更详细的相关系数的知识，请戳<a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_69e75efd0102wmd2.html">统计学之三大相关性系数</a>，博主写得深入浅出，而且有很多浅显易懂的例子，感兴趣的话可以看看。</p>
</blockquote>
</li>
</ul>
<h3 id="方程"><a href="#方程" class="headerlink" title="方程"></a>方程</h3><ul>
<li>方程模型</li>
</ul>
<p>线性回归的方程模型就是一元一次方程，如下所示：</p>
<p><img src="https://s1.ax1x.com/2018/09/29/ila641.png" alt="ila641.png"></p>
<p>b0表示<strong>截距</strong>，也就是回归线与y轴交点的y坐标；</p>
<p>b1表示<strong>斜率</strong>，也就是回归线的倾斜程度；</p>
<p>y^ 表示回归线反应变量的预测值，并不是确切的数据集中的y值。</p>
<ul>
<li>拟合回归线</li>
</ul>
<p>拟合回归线时我们采用的主要算法叫做 <strong>最小二乘法</strong>，即通过回归线得到的预测反应变量值与实际反应变量之差最小时的那条就是最佳拟合回归线，其原理公式可以表示为：</p>
<p><img src="https://s1.ax1x.com/2018/09/29/ilag9x.png" alt="ilag9x.png"></p>
<h3 id="编程实现"><a href="#编程实现" class="headerlink" title="编程实现"></a>编程实现</h3><p>在python中我们需要调用<code>statsmodels</code>包来拟合回归线：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载statsmodels包</span></span><br><span class="line"><span class="keyword">import</span> statsmodels.api <span class="keyword">as</span> sm</span><br><span class="line"><span class="comment">#注意一定不要忘了截距</span></span><br><span class="line">df[<span class="string">&#x27;intercept&#x27;</span>] = <span class="number">1</span></span><br><span class="line"><span class="comment"># 构建变量模型及其拟合</span></span><br><span class="line"><span class="comment"># y为因变量，X表示单个或多个自变量（其中要包含截距），例如 df[[&quot;intercept&quot;, &quot;area&quot;]] 包括了截距和面积两个变量</span></span><br><span class="line">lm = sm.OLS(y, X) 		</span><br><span class="line">result = lm.fit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取最终的拟合模型报告</span></span><br><span class="line">print(result.summary())</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在建立模型时，一般情况下都是需要手动添加截距（一般为常数 1）， 想了解更多，可以查阅<a target="_blank" rel="noopener" href="http://statistiksoftware.blogspot.com/2013/01/why-we-need-intercept.html">Statcon: Why we need the intercept</a>或者<a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/7948/when-is-it-ok-to-remove-the-intercept-in-a-linear-regression-model">When is it ok to remove the intercept in a linear regression model? - Cross Validated</a></p>
</blockquote>
<h3 id="参数和结果解释"><a href="#参数和结果解释" class="headerlink" title="参数和结果解释"></a>参数和结果解释</h3><ul>
<li><code>coef</code>：对应变量的参数值</li>
<li><code>std err</code>：标准误差</li>
<li><code>t</code>：统计检验值</li>
<li><code>P&gt;|t|</code> ：这个是对应的 <code>p</code> 值，它的零假设为该变量的参数值等于0，可以指示该变量是否有利于预测反应变量，也能用于比较多个变量中哪个更重要。</li>
<li><code>R-squared</code> ：即决定系数，它是相关系数的平方。取值范围在[0,1]，值越大，拟合效果就越好，这个值的统计意义可以简单解释为此次拟合中的解释变量能有多少百分比的可能去解释反应变量。</li>
</ul>
<h2 id="多元线性回归"><a href="#多元线性回归" class="headerlink" title="多元线性回归"></a>多元线性回归</h2><h3 id="基本概念-1"><a href="#基本概念-1" class="headerlink" title="基本概念"></a>基本概念</h3><p>多元线性回归就是由多个自变量去预测因变量的方法，其模型方程与简单线性回归基本一致，只不过是将单自变量变为了多个自变量的矩阵，如下所示：</p>
<p><img src="https://s1.ax1x.com/2018/09/29/ilaRgK.png" alt="ilaRgK.png"></p>
<p>其中<strong>X</strong>就是多个自变量的矩阵。</p>
<h3 id="编程实现-1"><a href="#编程实现-1" class="headerlink" title="编程实现"></a>编程实现</h3><p>在Python中的编程实现步骤也如简单线性回归类似，别忘了要定义一个截距</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载statsmodels包</span></span><br><span class="line"><span class="keyword">import</span> statsmodels.api <span class="keyword">as</span> sm</span><br><span class="line"><span class="comment">#注意一定不要忘了截距</span></span><br><span class="line">df[<span class="string">&#x27;intercept&#x27;</span>] = <span class="number">1</span></span><br><span class="line"><span class="comment"># 构建变量模型及其拟合</span></span><br><span class="line"><span class="comment"># y为因变量，X表示多个自变量的矩阵（其中要包含截距），例如 df[[&quot;intercept&quot;, &quot;area&quot;,&quot;bedroom&quot;, &quot;bathroom&quot;]] 包括了截距和面积、卧室数量、洗手间数量四个变量</span></span><br><span class="line">lm = sm.OLS(y, X) 		</span><br><span class="line">result = lm.fit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取最终的拟合模型报告</span></span><br><span class="line">print(result.summary())</span><br></pre></td></tr></table></figure>

<h3 id="参数和结果解释-1"><a href="#参数和结果解释-1" class="headerlink" title="参数和结果解释"></a>参数和结果解释</h3><p>这里和简单线性回归是一致的，只不过在解释单个自变量与因变量之间的关系时，需要加上一句“<strong>在其它变量不变的情况下</strong>……”</p>
<h3 id="处理分类变量"><a href="#处理分类变量" class="headerlink" title="处理分类变量"></a>处理分类变量</h3><ul>
<li>思路</li>
</ul>
<p>处理分类变量的一个思路就是将其转化为<strong>虚拟变量</strong>，也就是将各个分类变量单独成列，然后把观察行对应的分类变量量化为0（可理解为“否”）和1（可理解为“是”）作为该列的元素，再进行拟合处理。</p>
<p>在拟合处理时，我们添加的虚拟变量的数量应该为原数据集中的虚拟变量总数减一。</p>
<blockquote>
<p>因为要计算最佳拟合系数时，需要用到变量矩阵的转秩，而判断矩阵是否可逆的充分必要条件就是这个矩阵是满秩的，又因为我们的虚拟变量矩阵中每一个变量都可以由其他变量推导而来，所以必须要舍弃一列才能确保变量矩阵为满秩。【感兴趣可以去可汗学院补一补线性代数知识】</p>
</blockquote>
<ul>
<li>方法</li>
</ul>
<p>使用pandas中的get_dummies函数来进行虚拟变量的转换</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#对neighborhood列进行量化，并将结果存储在df数据集的A/B/C三个新列中</span></span><br><span class="line">df[[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>]] = pd.get_dummies(df[<span class="string">&#x27;neighborhood&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>：get_dummies函数输出结果的默认排序为字典顺序（即a-z），所以在进行新列储存时，一定要注意原始变量中的分类与虚拟变量列一一对应。</p>
<ul>
<li>结果解释</li>
</ul>
<p>还是以ABC三个分类变量来假设，我们以C作为<strong>基准变量</strong>（也就是删除的那列），那么在显示的结果中：</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">coef</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Intercept</td>
<td align="center">i</td>
</tr>
<tr>
<td align="center">A</td>
<td align="center">a</td>
</tr>
<tr>
<td align="center">B</td>
<td align="center">b</td>
</tr>
</tbody></table>
<p>1.Intercept的coef表示：如果分类为C的话，因变量即为i；</p>
<p>2.A的coef表示：如果分类为A的话，因变量为i+a;</p>
<p>3.B的coef表示：如果分类为B的话，因变量为i+b。</p>
<h3 id="潜在问题"><a href="#潜在问题" class="headerlink" title="潜在问题"></a>潜在问题</h3><p>这部分课程中给了很多额外资料的链接，理论性很重，不太好啃，建议等通关后复盘的时候试着看一看。</p>
<h3 id="多重共线性现象和分析"><a href="#多重共线性现象和分析" class="headerlink" title="多重共线性现象和分析"></a>多重共线性现象和分析</h3><p>如果我们的自变量彼此相关，就会出现多重共线性。多重共线性的一个主要问题在于：它会导致简单线性回归系数偏离我们想要的方向。要判断是否有多重共线性，最常见的办法是借助散点图或 **方差膨胀因子 (即 VIF)**。</p>
<ul>
<li>散点图</li>
</ul>
<p>散点图比较好理解，使用之前提到过的seaborn中的pairplot能很直观的看出各个变量之间的相关性。代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.pairplot(df[[<span class="string">&quot;col_1&quot;</span>, <span class="string">&quot;col_2&quot;</span>, <span class="string">&quot;col_3&quot;</span>]])</span><br></pre></td></tr></table></figure>

<ul>
<li>方差膨胀因子</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://etav.github.io/python/vif_factor_python.html">方差膨胀因子(Variance Inflation Factor，VIF)</a>是指解释变量之间存在多重共线性时的方差与不存在多重共线性时的方差之比。具体的计算方法如下（计算不做要求，但要理解） </p>
<blockquote>
<p>假若有X1 、X2 、X3三个自变量，X1的vif计算：<br>1.x1对常数项（截距）、x2、x3做多元线性回归，求出R^2<br>2.则变量X1的VIF＝1/(1-R^2)<br>3.同理计算出变量X2和X3的VIF。</p>
</blockquote>
<p>它是指示多元线性回归中多重共线性严重与否的指标，VIF越大，多重共线性就越严重。</p>
<p>经验判断方法表明：</p>
<p>当0&lt;VIF&lt;10，不存在多重共线性；</p>
<p>当10≤VIF&lt;100，存在较强的多重共线性；</p>
<p>当VIF≥100，存在严重多重共线性。</p>
<p>所以我们在处理的时候，就要去除VIF超过10的最不感兴趣的变量。</p>
<p>在python中的编程实现如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算 VIF 需要使用 statsmodel 包</span></span><br><span class="line"><span class="keyword">from</span> statsmodels.stats.outliers_influence <span class="keyword">import</span> variance_inflation_factor</span><br><span class="line"><span class="keyword">from</span> patsy <span class="keyword">import</span> dmatrices	</span><br><span class="line"></span><br><span class="line"><span class="comment"># 筛选出作线性回归的变量（截距不要加）</span></span><br><span class="line">y, X = dmatrices(<span class="string">&#x27;col_y ~ col_1 + col_2 + col_3&#x27;</span>, df, return_type=<span class="string">&#x27;dataframe&#x27;</span>)</span><br><span class="line">vif = pd.DataFrame()</span><br><span class="line"><span class="comment"># 使用 variance_inflation_factor 来计算 VIF，并储存在vif DataFrame中</span></span><br><span class="line">vif[<span class="string">&quot;VIF Factor&quot;</span>] = [variance_inflation_factor(X.values, i) <span class="keyword">for</span> i <span class="keyword">in</span> range(X.shape[<span class="number">1</span>])] </span><br><span class="line">vif[<span class="string">&quot;features&quot;</span>] = X.columns</span><br></pre></td></tr></table></figure>

<h2 id="【选修】高阶项"><a href="#【选修】高阶项" class="headerlink" title="【选修】高阶项"></a>【选修】高阶项</h2><p>高阶项就是在回归模型中添加诸如x^2,x^3,x1·x2等变量，获取的方式可以直接使用df[‘col_1’]进行高阶计算即可。</p>
<p>关键是在于观察变量之间的散点图，来确定是否需要添加高阶项。</p>
<ul>
<li>二阶、三阶的函数曲线很有辨识度，观察他们拐几个弯就可以；</li>
<li>交叉项的话，就看两自变量各自与因变量之间的回归线，如果回归线几乎平行，那就不必添加交叉项；</li>
</ul>
<p><strong>注意</strong>：如果确定要添加某变量的高阶项，一定要确保该变量也要添加进去。</p>
<p><strong>之后的24-33节也是选修，而且给了Udacity一套免费的机器学习入门课程，建议通关后再来复盘。</strong></p>
<h2 id="逻辑回归"><a href="#逻辑回归" class="headerlink" title="逻辑回归"></a>逻辑回归</h2><p>逻辑回归就是对分类变量进行预测的方法，尤其是对二分类问题（非1即0），比如说是否使用优惠券，是否存在贷款逾期问题等等。</p>
<h3 id="方程-1"><a href="#方程-1" class="headerlink" title="方程"></a>方程</h3><p>逻辑回归的方程模型就是<strong>sigmoid</strong>函数：</p>
<p><img src="https://s1.ax1x.com/2018/09/25/iKlzUe.png" alt="iKlzUe.png"></p>
<p>结合二分类问题的概率，做对数变换可得：</p>
<p><img src="https://s1.ax1x.com/2018/11/17/izcBWD.png" alt="izcBWD.png"></p>
<p>如上p/(1-p)即为事件的<strong>机会比</strong>，在该问题中，能预测范围在0到1之间。</p>
<h3 id="编程实现-2"><a href="#编程实现-2" class="headerlink" title="编程实现"></a>编程实现</h3><p>编程实现与线性回归类似，只不过将最小二乘法（OLS）替换成了逻辑回归（Logit）:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载statsmodels包</span></span><br><span class="line"><span class="keyword">import</span> statsmodels.api <span class="keyword">as</span> sm</span><br><span class="line"><span class="comment">#注意一定不要忘了截距</span></span><br><span class="line">df[<span class="string">&#x27;intercept&#x27;</span>] = <span class="number">1</span></span><br><span class="line"><span class="comment"># 构建变量模型及其拟合</span></span><br><span class="line"><span class="comment"># y为二分类变量，X表示多个自变量的矩阵（其中要包含截距），例如 df[[&quot;intercept&quot;,&quot;duration&quot;]] 包括了截距和持续时间</span></span><br><span class="line">lm = sm.Logit(y, X) 		</span><br><span class="line">result = lm.fit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取最终的拟合模型报告</span></span><br><span class="line">print(result.summary())</span><br></pre></td></tr></table></figure>

<h3 id="参数和结果解释-2"><a href="#参数和结果解释-2" class="headerlink" title="参数和结果解释"></a>参数和结果解释</h3><ul>
<li><code>coef</code>：对应变量的系数</li>
<li><code>std err</code>：标准误差</li>
<li><code>t</code>：统计检验值</li>
<li><code>P&gt;|t|</code> ：这个是对应的 <code>p</code> 值，可以指示该变量是否有利于预测反应变量，也能用于比较多个变量中哪个更重要。</li>
</ul>
<p>在这里我们并不关注截距，而重点关注各个解释变量。</p>
<p>在进行结果解释时我们常说：</p>
<p><strong>在保持其他变量不变的情况下</strong>，</p>
<ul>
<li>（对于数值变量）该变量每增加一个单位，那么作为y的分类变量则增大e^coef倍；</li>
<li>（对于分类变量）该变量为它的对立时，作为y的分类变量发生的几率为该变量基础的e^coef倍。</li>
</ul>
<h3 id="【选修】模型评估"><a href="#【选修】模型评估" class="headerlink" title="【选修】模型评估"></a>【选修】模型评估</h3><p>之后的课程已经是机器学习入门阶段的范畴，可以等通关后，再去研究。（建议先开始免费的机器学习课程，再结合本章内容复盘看，更有助于你理解）</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>本周导学的内容较难，理解起来也比较困难，对于置信区间和假设检验两节，大家可以再额外补充一些统计学方面的相关知识，更有助于你理解；对于回归知识，建议多看几遍教学视频再结合例题，在实践中不断尝试去理解，大家加油！下周就要开始项目四了，阶段性的胜利就在前方！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.capallen.top/2018/Basic-statistic-in-Data-Analysis.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Allen Jia">
      <meta itemprop="description" content="数据 算法 分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Blog">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/Basic-statistic-in-Data-Analysis.html" class="post-title-link" itemprop="url">每周导学-第十周-统计学基础</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-13 12:30:09" itemprop="dateCreated datePublished" datetime="2018-09-13T12:30:09+08:00">2018-09-13</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2019-06-06 11:26:29" itemprop="dateModified" datetime="2019-06-06T11:26:29+08:00">2019-06-06</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a>
        </span>
    </span>

  
    <span id="/2018/Basic-statistic-in-Data-Analysis.html" class="post-meta-item leancloud_visitors" data-flag-title="每周导学-第十周-统计学基础" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/Basic-statistic-in-Data-Analysis.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/Basic-statistic-in-Data-Analysis.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>If you tell yourself you can’t, you won’t.</p>
</blockquote>
<p>Hi，同学们，上一阶段我们学习了数据分析的基本流程、Pandas在数据分析各个过程中的应用以及Matplotlib&amp;Pandas的可视化基础，截至目前，你们已经算是掌握了基础的数据分析技能啦！撒花！但是在统计学理论和预测方面仍有欠缺，那么P4阶段就是解决这个欠缺哒！</p>
<p>本周开始，我们就进入到了<strong>项目四(P4)阶段</strong>，本阶段总共包含<strong>三周</strong>，在这三周内，我们要对<strong>统计学</strong>进行学习，掌握基础的<strong>描述统计学理论、基本的概率知识、二项分布和贝叶斯公式</strong>，并学会<strong>使用 Python 来实践</strong>；学习<strong>正态分布、抽样分布、置信区间以及假设检验的概念和计算方式</strong>；学习<strong>线性回归以及逻辑回归</strong>，在真实场景中应用，比如<strong>分析 A/B 测试</strong>结果，搭建简单的监督机器学习模型。可谓是时间紧任务重，但是也别怕，统计学的基础知识还是非常简单的，跟着课程内容一步步来，自己多做笔记多查资料，一定没问题的！</p>
<p>那么我们的课程安排：</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody><tr>
<td><strong>第1周</strong></td>
<td><strong>统计学基础</strong></td>
<td><strong>描述统计学 - 抽样分布与中心极限定理</strong></td>
</tr>
<tr>
<td>第2周</td>
<td>统计学进阶</td>
<td>置信区间 - 逻辑回归</td>
</tr>
<tr>
<td>第3周</td>
<td>完成项目</td>
<td>项目：分析A/B测试结果</td>
</tr>
</tbody></table>
<p>本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/必应搜索、<a target="_blank" rel="noopener" href="https://www.csdn.net/">CSDN</a>、<a target="_blank" rel="noopener" href="https://stackoverflow.com/">stack<strong>overflow</strong></a></li>
<li>额外参考资料：<ul>
<li><a target="_blank" rel="noopener" href="https://www.khanacademy.org/math/statistics-probability">可汗学院概率论与统计课程</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/%E6%9C%BA%E4%BC%9A%E7%9A%84%E6%95%B0%E5%AD%A6-%E9%99%88%E5%B8%8C%E5%AD%BA.pdf">机会的数学-陈希孺</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/%E6%9D%A1%E4%BB%B6%E6%A6%82%E7%8E%87%E5%8F%8A%E5%85%A8%E6%A6%82%E7%8E%87%E5%85%AC%E5%BC%8F%E5%8F%8A%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%85%AC%E5%BC%8F.pdf">条件概率及全概率公式及贝叶斯公式</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/statistics%20for%20data%20science.pdf">statistics for data science</a></li>
</ul>
</li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p><strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><p>学习课程中的<strong>描述统计学 - 抽样分布与中心极限定理</strong>课程，掌握统计学基础知识。</p>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody><tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>描述统计学 - 抽样分布与中心极限定理</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody></table>
<h1 id="本周知识清单"><a href="#本周知识清单" class="headerlink" title="本周知识清单"></a>本周知识清单</h1><h2 id="描述统计学基础"><a href="#描述统计学基础" class="headerlink" title="描述统计学基础"></a>描述统计学基础</h2><p>描述统计分析就是通过数字或可视化的方法，对数据集进行整理、分析，并对数据的分布状态、数字特征和随机变量之间的关系进行估计和描述。其简要可以分为集中趋势分析、离散程度分析以及相关分析三大部分。所以，虽然这部分是选修内容，但拜托各位一定要看，这部分理论是数据分析的基础。</p>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p>数据类型是基础，尤其是之后在进行回归预测时，针对不同的数据类型可以选择不同的算法，所以必须掌握。</p>
<p>数据类型可以分为两大类：数值和分类；进而分为四小类：连续、离散、定序和定类。</p>
<table>
<thead>
<tr>
<th><strong>数据类型</strong></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><strong>数值:</strong></td>
<td><strong>连续</strong></td>
<td><strong>离散</strong></td>
</tr>
<tr>
<td></td>
<td>身高、年龄、收入</td>
<td>书中的页数、院子里的树、咖啡店里的狗</td>
</tr>
<tr>
<td><strong>分类:</strong></td>
<td><strong>定序</strong></td>
<td><strong>定类</strong></td>
</tr>
<tr>
<td></td>
<td>字母成绩等级、调查评级</td>
<td>性别、婚姻状况、早餐食品</td>
</tr>
</tbody></table>
<h3 id="描述统计的量"><a href="#描述统计的量" class="headerlink" title="描述统计的量"></a>描述统计的量</h3><table>
<thead>
<tr>
<th>数据类型</th>
<th>描述方面</th>
<th>描述方式</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td><strong>数值:</strong></td>
<td><strong>集中趋势</strong></td>
<td>均值</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>中位数</td>
<td>偶数个时取中间两值均数</td>
</tr>
<tr>
<td></td>
<td></td>
<td>众数</td>
<td>存在没有或多个的可能</td>
</tr>
<tr>
<td></td>
<td><strong>离散程度</strong></td>
<td>极差</td>
<td>max - min</td>
</tr>
<tr>
<td></td>
<td></td>
<td>四分位差（IQR）</td>
<td>75%数 - 25%数</td>
</tr>
<tr>
<td></td>
<td></td>
<td>方差</td>
<td>每个观察值与均值之差平方和的平均数</td>
</tr>
<tr>
<td></td>
<td></td>
<td>标准差</td>
<td>方差的平方根</td>
</tr>
<tr>
<td></td>
<td><strong>数据形状</strong></td>
<td>左偏态</td>
<td>均值小于中位数（普遍但不绝对，下同）</td>
</tr>
<tr>
<td></td>
<td>（需做直方图）</td>
<td>右偏态</td>
<td>均值大于中位数</td>
</tr>
<tr>
<td></td>
<td></td>
<td>对称分布（通常是正态分布）</td>
<td>均值等于中位数</td>
</tr>
<tr>
<td></td>
<td><strong>异常值</strong></td>
<td>一般为上下超过1.5倍四分位差</td>
<td>处理方式见下面【异常值的处理】</td>
</tr>
<tr>
<td><strong>分类:</strong></td>
<td>分类计量个数或比例</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<ul>
<li><p>偏态分布示意图</p>
<p><img src="https://tse4.mm.bing.net/th?id=OIP.eJMf4CCd_ylkXqyGPD0NbQHaE8&pid=Api"></p>
</li>
<li><p>其他概念：</p>
<ul>
<li><p>五数概括描述法：利用<strong>最小值、第一四分位数（25%处）、第二四分位数（中位数）、第三四分位数（75%处）和最大值</strong>五个数对<strong>数值型</strong>变量的<strong>离散程度</strong>进行描述的方法。</p>
</li>
<li><p>当我们的数据遵循<strong>正态</strong>分布时，我们可以使用<code>均值</code>和<code>标准差</code>完全理解我们的数据集。        </p>
<p>但是，如果我们的数据集是<strong>偏态</strong>分布，<code>五数概括法</code>（和关联的集中趋势度量）更适用于概括数据。</p>
</li>
<li><p>除直方图外，你还可以使用<strong>箱线图</strong>进行统计描述，箱线图其实是五数概括法的可视化。</p>
</li>
</ul>
</li>
<li><p>异常值的处理：</p>
<p><strong>1.</strong> 至少注意到它们的存在并确定对概括统计的影响。        </p>
<p><strong>2.</strong> 如果是输入错误 — 删除或改正        </p>
<p><strong>3.</strong> 理解它们为何存在，以及对我们想要回答的关于数据的问题的影响。        </p>
<p><strong>4.</strong> 当有异常值时，报告五数概括法的值通常能比均值和标准差等度量更好地体现异常值的存在。        </p>
<p><strong>5.</strong> 报告时要小心。知道如何提出正确的问题。</p>
</li>
</ul>
<h3 id="随机变量"><a href="#随机变量" class="headerlink" title="随机变量"></a>随机变量</h3><p>随机变量集用大写字母，如X表示；</p>
<p>而集里面的某个变量用对应的小写字母，如x1，x2等表示。</p>
<h2 id="推论统计学基础"><a href="#推论统计学基础" class="headerlink" title="推论统计学基础"></a>推论统计学基础</h2><p>推论统计就是根据现有收集的部分数据对更大的总体数据进行推论的方法。他的几个关键要素为：</p>
<ol>
<li><strong>总体</strong> —— 我们想要研究的整个群体。        </li>
<li><strong>参数</strong> —— 描述总体的数值摘要        </li>
<li><strong>样本</strong> —— 总体的子集        </li>
<li><strong>统计量</strong> —— 描述样本的数值摘要        </li>
</ol>
<h2 id="辛普森悖论"><a href="#辛普森悖论" class="headerlink" title="辛普森悖论"></a>辛普森悖论</h2><p>本节以录取案例分析为例，展示了辛普森悖论。这个例子不必深究，只是为了提醒大家要<strong>以多种方式去观察数据</strong>，避免出现案例分析中的反例。</p>
<p>辛普森悖论是在某个条件下的两组数据，分别讨论时都会满足某种性质，可是一旦合并考虑，却可能导致相反的结论。那么如何避免辛普森悖论呢？那就要从产生它的源头——混杂因素上考虑，混杂因素就是一个与核心研究无关的变量，它会随着变量的改变而改变，就比如说在课程中的例子中，不同专业的总人数就有很大差异，它会随着专业的改变而改变。所以在之后处理类似问题时就要进行多变量分析，这样才能帮助我们认清事件的本质。</p>
<h2 id="概率"><a href="#概率" class="headerlink" title="概率"></a>概率</h2><h3 id="概率与统计的关系"><a href="#概率与统计的关系" class="headerlink" title="概率与统计的关系"></a>概率与统计的关系</h3><p>从课程中给的这幅关系图就能很明显的看出来，概率是由模型（MODEL）去预测数据（DATA），而统计是由数据去建立模型（进而再去做预测，也就是‘’根据数据去预测数据’‘）。</p>
<p><img src="https://s1.ax1x.com/2018/09/12/iAkgoj.png" alt="iAkgoj.png"></p>
<h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><p><strong>概率</strong>，是一种几率、可能性，描述是事件发生的可能性度量量。<strong>随机事件</strong>，指一个被赋予机率的事件<br>集合，针对的是事件在样本空间的一个子集。事件A发生的概率，用符号P(A)表示 。</p>
<ul>
<li><p>任何事件的发生概率在 0 和 1 之间，其中包括 0 和 1。（0表示不可能发生，1表示必然发生）</p>
</li>
<li><p>独立事件：事件每次发生的结果与前后的发生结果无关。比如说，第一次掷骰子的结果与第二次的结果</p>
</li>
<li><p>互斥事件：不可能在同一次实验中出现的俩事件。比如说，掷骰子实验中的1和6</p>
</li>
<li><p>对立事件：是一种特殊的互斥事件，即试验中只有俩种可能A和B，那么事情的发生非A即B。可以表示为</p>
<p><img src="https://s1.ax1x.com/2018/09/22/iuFI3Q.png" alt="iuFI3Q.png"></p>
<p>如掷硬币的正面和反面。</p>
</li>
<li><p>加法原理：若两种方法均能完成此事，则此事发生的概率为P(A) + P(B)</p>
</li>
<li><p>乘法原理：若两个步骤分别不能完成此事，则此事发生的概率为P(A)·P(B)</p>
</li>
</ul>
<h3 id="二项分布"><a href="#二项分布" class="headerlink" title="二项分布"></a>二项分布</h3><p>也叫伯努利分布，是指n个独立的事件A发生的概率分布。设每次试验中事件A发生的概率为p，则进行n次试验，A发生k次的概率为：</p>
<p><img src="https://s1.ax1x.com/2018/09/22/iuFocj.png" alt="iuFocj.png"></p>
<h3 id="条件概率"><a href="#条件概率" class="headerlink" title="条件概率"></a>条件概率</h3><p>在现实中，我们处理的事情并不像骰子和硬币那样简单，有些时间的结果往往依赖于其他的事情，比如说晨练的概率跟这个人是不是夜猫子有关等等。那么，这就引出了条件概率，即在事件B发生的条件下，事件A发生的概率为：</p>
<p><img src="https://s1.ax1x.com/2018/09/22/iuFTjs.png" alt="iuFTjs.png"></p>
<p>其中，P(AB)表示AB同时发生的概率。</p>
<p>在如下的文氏图中，AB同时发生的概率可以表示为两个圆的交集，那么B已经发生的条件下A发生的概率就是这个交集（橙色部分）占整个B圆的比例。</p>
<p><img src="https://s1.ax1x.com/2018/09/13/iA5UMT.png" alt="iA5UMT.png"></p>
<blockquote>
<p>之前讲过独立事件，那么用公式的方式可以表达为：<code>P(A) = P(A|B)</code>。根据条件概率公式可以推导出，当<code>P(AB) = P(A)P(B)</code>时，则可说明A事件与B事件相互独立。</p>
</blockquote>
<p><strong>全概率公式</strong></p>
<p>也就是A发生的概率为在互斥的多个事件（B1，B2…）已发生的条件下的条件概率之和。公式可以表示为：</p>
<p><img src="https://s1.ax1x.com/2018/09/22/iuFHun.png" alt="iuFHun.png"></p>
<h3 id="贝叶斯法则"><a href="#贝叶斯法则" class="headerlink" title="贝叶斯法则"></a>贝叶斯法则</h3><p>贝叶斯法则是概率推理的黄金法则，是利用先验概率计算后验概率的方法。</p>
<blockquote>
<p>课程中的癌症例子十分贴切，讲解的也十分详细，所以大家<strong>看到前20个小节</strong>，能理解贝叶斯法则就可以了，后面的是在无人驾驶中的应用例子，可以跳过不看。</p>
</blockquote>
<p>在课程示例中：</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/iuFqH0"><img src="https://s1.ax1x.com/2018/09/22/iuFqH0.md.png" alt="iuFqH0.md.png"></a></p>
<p>由条件概率能计算出患癌与检查结果为阳性同时发生的概率<code>P(C,Pos)</code>（红色区域占整个矩形的比例）和没患癌与检查结果同时发生的概率<code>P(~C,Pos)</code>（绿色区域占整个矩形的比例）。</p>
<p><img src="https://s1.ax1x.com/2018/09/22/iuFbBq.png" alt="iuFbBq.png"></p>
<p>二者相加，即为检查结果为阳性的概率（全概率公式）P(Pos)。</p>
<p>则，检查结果为阳性的条件下患癌概率为：</p>
<p><img src="https://s1.ax1x.com/2018/09/22/iuFOEV.png" alt="iuFOEV.png"></p>
<p>这样我们就得到了更接近真实的检查结果为阳性的患癌概率。</p>
<p><img src="https://s1.ax1x.com/2018/09/13/iAIrnS.png" alt="iAIrnS.png"></p>
<p>在这个例子中：</p>
<p>癌症发生的概率<code>P(C)</code>为先验概率，即在我们进行检查之前就对患癌概率的一个判断；</p>
<p>阳性结果下为癌症的概率<code>P(C|Pos)</code>为后验概率（阳性下非癌症、阴性癌症、阴性非癌症都是），这些是在检查发生之后，我们对患癌概率这件事的重新评估；</p>
<p><strong>这就是贝叶斯法则的含义。我们先预估一个”先验概率”，然后加入实验结果，由此得到更接近事实的”后验概率”。</strong></p>
<blockquote>
<p>如果感觉理解困难，可以看一下白话版的贝叶斯讲解：<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/19725590">怎样用非数学语言讲解贝叶斯定理（Bayes’s theorem）</a></p>
</blockquote>
<h2 id="Python概率练习"><a href="#Python概率练习" class="headerlink" title="Python概率练习"></a>Python概率练习</h2><p>前面我们学习了概率的基本知识，有了理论基础，本节就是利用Python落地的教学。应用的第三方包为NumPy和Pandas。</p>
<h3 id="均匀随机取整"><a href="#均匀随机取整" class="headerlink" title="均匀随机取整"></a>均匀随机取整</h3><p>使用的函数为<code>numpy.random.randint(low, high=None, size=None, dtype=&#39;l&#39;)</code>：</p>
<ul>
<li>low：当没有high参数输入时，作为取值范围的最大值+1；当有high参数输入时，则作为取值范围的最小值；</li>
<li>high：取值范围的最大值+1，默认为无输入；</li>
<li>size：输入数字则表示取值的数量，输入元组则表示取值矩阵的行和列；</li>
<li>dtype：数据类型，默认为np.int；</li>
<li>函数的输出为int或者是由int数据类型组成的ndarray。</li>
</ul>
<p>函数的具体用法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 未定义high参数，取值范围是是0到1（即low - 1）</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.random.randint(<span class="number">2</span>, size=<span class="number">10</span>)</span><br><span class="line">array([<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line"><span class="comment"># 定义了high参数，取值范围是2（即low）到4（即high - 1）</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.random.randint(<span class="number">2</span>,<span class="number">5</span>,size = <span class="number">10</span>)</span><br><span class="line">array([<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>])</span><br><span class="line"><span class="comment"># 定义一个2x4的矩阵，取值范围是0到4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.random.randint(<span class="number">5</span>, size=(<span class="number">2</span>, <span class="number">4</span>))</span><br><span class="line">array([[<span class="number">4</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>]])</span><br></pre></td></tr></table></figure>

<h3 id="不均匀随机取数"><a href="#不均匀随机取数" class="headerlink" title="不均匀随机取数"></a>不均匀随机取数</h3><p>使用的函数为<strong>numpy.random.choice</strong>(<em>a</em>, <em>size=None</em>, <em>replace=True</em>, <em>p=None</em>):</p>
<ul>
<li>a：输入列表时，取数就从该列表中取；若输入为数字时，取值范围为0到该数字 - 1；</li>
<li>size：输入数字则表示取值的数量，输入元组则表示取值矩阵的行和列；</li>
<li>replace：布尔值，默认为True，若设置为False表示取数不会重复；（以从袋子中取球为例，True是取完放回再取，而False则是取了不放回，继续取）</li>
<li>p：表示概率，与a的输入值一一对应。</li>
<li>函数的输出为int或者是由int数据类型组成的ndarray。</li>
</ul>
<p>函数的具体用法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#输入数字时取数</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.random.choice(<span class="number">5</span>, <span class="number">3</span>)</span><br><span class="line">array([<span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"><span class="comment">#设置replace参数</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.random.choice(<span class="number">5</span>, <span class="number">3</span>, replace=<span class="literal">False</span>)</span><br><span class="line">array([<span class="number">3</span>,<span class="number">1</span>,<span class="number">0</span>])</span><br><span class="line"><span class="comment">#设置概率</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.random.choice(<span class="number">5</span>, <span class="number">3</span>, replace=<span class="literal">False</span>, p=[<span class="number">0.1</span>, <span class="number">0</span>, <span class="number">0.3</span>, <span class="number">0.6</span>, <span class="number">0</span>])</span><br><span class="line">array([<span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<h3 id="二项分布-1"><a href="#二项分布-1" class="headerlink" title="二项分布"></a>二项分布</h3><p>使用的函数为<strong>numpy.random.binomial</strong>(<em>n</em>, <em>p</em>, <em>size=None</em>)，参数也很好解释。</p>
<p>参数中的n即为每次试验中取值的次数，p则为试验中的某一种事件成功的概率，size则是试验的次数。</p>
<h3 id="条件概率与贝叶斯规则测试"><a href="#条件概率与贝叶斯规则测试" class="headerlink" title="条件概率与贝叶斯规则测试"></a>条件概率与贝叶斯规则测试</h3><p>这里主要是一些Pandas函数的应用，经过上一阶段的学习应该已经很熟练了。</p>
<p>主要涉及的函数是分组和统计计数类的函数，比如说groupby，query，count等，如果忘记的话，自己查官方文档或者之前的笔记，这里不再赘述。</p>
<h2 id="正态分布"><a href="#正态分布" class="headerlink" title="正态分布"></a>正态分布</h2><p>课程中以抛硬币模型引入了二项分布进而讲解了正态分布模型，那么到底什么是正态分布或者满足什么条件就可以算是正态分布了呢？</p>
<blockquote>
<p>在相同条件下，我们随机地对某一测试对象（抛硬币20次，其中正面的次数）进行多次测试（抛很多次20次）时，测得的数值在一定范围内波动（从0到20），其中接近平均值的数据（10左右）占多数，远离平均值的占少数。具有这种分布规律的随机变量的分布就称作正态分布。</p>
</blockquote>
<p>大概长这样儿：</p>
<p><img src="https://s1.ax1x.com/2018/09/14/iEkWCR.png" alt="iEkWCR.png"></p>
<p>它的概率密度函数可以表示为：</p>
<p><img src="https://s1.ax1x.com/2018/09/22/iuFXNT.png" alt="iuFXNT.png"></p>
<p>这里为什么要引入正态分布呢？</p>
<ul>
<li>假设检验是基于正态分布的</li>
<li>许多社会和经济现象对应的随机变量分布，都可以用正态分布来描述</li>
</ul>
<h2 id="中心极限定理"><a href="#中心极限定理" class="headerlink" title="中心极限定理"></a>中心极限定理</h2><p>在此之前，先回顾下推论统计的几个概念：</p>
<ol>
<li><strong>总体</strong> —— 我们想要研究的整个群体。        </li>
<li><strong>参数</strong> —— 描述总体的数值摘要        </li>
<li><strong>样本</strong> —— 总体的子集        </li>
<li><strong>统计量</strong> —— 描述样本的数值摘要        </li>
</ol>
<p>课程中举得例子是统计优达学生中喝咖啡的人所占比例，我们看下图：</p>
<p><img src="https://s1.ax1x.com/2018/09/14/iEr4AK.png" alt="iEr4AK.png"></p>
<p>图中所有的杯子（学生）就叫做<strong>总体</strong>；此外可以看到有四个深浅不一的蓝色底框，每个底框链接了5个学生，这5个学生就是<strong>样本</strong>，每组样本我们还计算了喝咖啡的比例，这就是<strong>统计量</strong>。</p>
<blockquote>
<p>一般的，样本数≥30即可称为大样本。 大样本条件下，抽样平均数的分布接近正态分布。</p>
<p>但必要抽样数目的确定是有相关公式计算的，这里就不给出了，感兴趣的话可以去搜搜看。</p>
</blockquote>
<p>现在我们继续按照课程中的例子进行取样，样本容量为5，不断得取10000次，计算均值的分布情况如下：</p>
<p><img src="https://s1.ax1x.com/2018/09/14/iEcyUx.png" alt="iEcyUx.png"></p>
<p>（完全看不出这是个什么分布）</p>
<p>将样本容量改为50，仍然取10000次，计算均值的分布情况如下：</p>
<p><img src="https://s1.ax1x.com/2018/09/14/iEc656.png" alt="iEc656.png"></p>
<p>已经可以看出正态分布的样子了，那如果继续增加样本容量，改为5000，同样取10000次，计算均值的分布情况如下：</p>
<p><img src="C:\Users\Administrator\AppData\Local\Temp\1536915532459.png" alt="1536915532459"></p>
<p>想比上一幅图，这幅可视化更接近正态分布，均值处于相同的位置，但方差（离散程度）明显小了很多。</p>
<p>上面的这个过程就是<strong>中心极限定理</strong>的含义，随着样本容量的逐渐增大，平均数的抽样分布越接近正态分布（但也不一定必须要很大很大才能近似于正态分布），同样这也适用于求和，比例等，但<strong>不适用于所有的统计量</strong>，比如说最大值，方差等等。</p>
<p><strong>中心极限定理的妙处就在于，我们可以从任意的乱七八糟的分布取任意数量的样本值（比如上面例子中的5,50），然后计算样本的均值（或者和），不断得取值求均，最终做他们频率的可视化，你会发现这是一个非常完美的正态分布。</strong></p>
<p>现实生活中有很多的随机过程，有的分布就是乱七八糟，但是你可以通过中心极限定理，得到他们均值或者和的正态分布，这也是为什么正态分布在统计中如此常用的原因之一。</p>
<blockquote>
<p>如果感觉理解起来还是有点儿困难的话，你可以戳<a target="_blank" rel="noopener" href="http://onlinestatbook.com/stat_sim/sampling_dist/">在线抽样分布模拟器</a>，自己动手试一试。</p>
</blockquote>
<h2 id="大数定理"><a href="#大数定理" class="headerlink" title="大数定理"></a>大数定理</h2><p>大数定理表达的是<strong>随着样本容量增加，样本平均数越来越接近总体平均数</strong>，字面上的意思很好理解，但这里有一点要注意，我们举例来说明一下：</p>
<p>比如说，我现在有100枚硬币，放在一个盒子里，随便摇一下盒子，打开，对正面朝上的硬币进行计数（当然，我们知道期望为100 x 0.5 = 50）：</p>
<p>第一次实验的结果是55；第二次是60；第三次是70，三次实验的均值为（(55+60+70)/3 ≈62），那你觉得，下次实验的结果是更有可能小于50还是大于50呢？</p>
<p>你有可能这样想，根据大数定理，随着我们试验次数的不断增加，均值肯定是不断趋向于50的，前三次的实验中每次都超过50，那么下次的实验会有更大的可能小于50，来纠正前三次实验的偏差。</p>
<p>如果你真的这样想，你就陷入了<strong>赌徒悖论</strong>。大数定理不关心前面发生的有限次实验，因为后面还有无限次的实验，而这无限次实验的期望值是50。这个例子可能比较随意，但这就是大数定理的含义。</p>
<h2 id="自助法"><a href="#自助法" class="headerlink" title="自助法"></a>自助法</h2><p>自助法，bootstrap，也就是重复抽样。还记得上一节导学中讲到的numpy.random.choice函数吗？里面有一个<em>replace</em>参数，默认为True表示重复取样，也就是自助法；若设置为False，则表示不重复取样。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>本期导学主要对描述统计学和概率的基础知识进行了总结，这部分偏理论一些，如果觉得理解起来有点吃力，可以通过重复看视频，边看边用笔去算或者去网上搜集一些资料或者找一些教科书去查阅，要求是：不一定要完全掌握其原理，但求理解和会用。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.capallen.top/2018/P3%E9%98%B6%E6%AE%B5%E6%80%BB%E7%BB%93.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Allen Jia">
      <meta itemprop="description" content="数据 算法 分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Blog">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/P3%E9%98%B6%E6%AE%B5%E6%80%BB%E7%BB%93.html" class="post-title-link" itemprop="url">每周导学-第九周-P3阶段总结</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-09 12:30:09" itemprop="dateCreated datePublished" datetime="2018-09-09T12:30:09+08:00">2018-09-09</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2019-06-06 10:32:23" itemprop="dateModified" datetime="2019-06-06T10:32:23+08:00">2019-06-06</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a>
        </span>
    </span>

  
    <span id="/2018/P3%E9%98%B6%E6%AE%B5%E6%80%BB%E7%BB%93.html" class="post-meta-item leancloud_visitors" data-flag-title="每周导学-第九周-P3阶段总结" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/P3%E9%98%B6%E6%AE%B5%E6%80%BB%E7%BB%93.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/P3%E9%98%B6%E6%AE%B5%E6%80%BB%E7%BB%93.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>Nothing is particularly hard if you divide it into small jobs.</p>
</blockquote>
<p>Hi，同学们，本周是我们P3阶段的最后一周，前三周我们掌握了数据分析的基本流程、Pandas在数据分析各个流程中的基本应用，使用matplotlib&amp;Pandas进行可视化的技巧，并且在项目三中得到了巩固和锻炼。我也陆续收到了大家的项目展示，都十分厉害，尤其是问题的提出以及可视化，非常能吸引人，只是数据整理阶段的代码还需再慢慢磨练，得以精简。本周导学呢，我们就是对之前所学做一个总结，希望大家也能自己做一份总结（这份总结才是最贴切你自己需求的），优达日的时候我们会一起交流一下自己的项目心得以及踩过的坑，等你们哦~</p>
<p><strong>项目三(P3)阶段</strong>总共包含<strong>四周</strong>，在这一个月内，我们要对<strong>数据分析入门</strong>进行学习，学习数据分析思维，掌握Python数据分析及可视化方法，并使用所学知识完成<strong>项目三：探索数据集</strong>，尝试着自己完成整个数据分析的流程，得到一些饶有兴趣的结论，你一定会非常有成就感哒！那么以下便是这四周的学习安排：</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody><tr>
<td>第1周</td>
<td>数据分析过程-1</td>
<td>数据分析过程&amp;案例研究-1</td>
</tr>
<tr>
<td>第2周</td>
<td>数据分析过程-2</td>
<td>案例研究-1&amp;案例研究-2</td>
</tr>
<tr>
<td>第3周</td>
<td>完成项目</td>
<td>项目：探索数据集</td>
</tr>
<tr>
<td><strong>第4周</strong></td>
<td><strong>项目修改与通过</strong></td>
<td><strong>修改项目、查缺补漏、休息调整</strong></td>
</tr>
</tbody></table>
<p><font size = '3' color = 'red'>！！看这里！！：在P3课程里面安排了SQL的高阶课程，但是因为在项目三中并不会涉及到SQL知识，所以为了保证大家学习的连贯性，在完成前两周的课程之后，就开始项目。至于！！SQL的高阶知识，大家可以放在课程通关后进行选修！！； </font></p>
<p>本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/百度搜索、<a target="_blank" rel="noopener" href="http://www.runoob.com/python3/python3-tutorial.html">菜鸟教程</a>、<a target="_blank" rel="noopener" href="https://www.csdn.net/">CSDN</a>、<a target="_blank" rel="noopener" href="https://stackoverflow.com/">stack<strong>overflow</strong></a>、<a target="_blank" rel="noopener" href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/Python%20for%20Data%20Analysis%2C%202nd%20Edition.pdf"><strong>Python for Data Analysis, 2nd Edition</strong> </a>、<a target="_blank" rel="noopener" href="http://python3-cookbook.readthedocs.io/zh_CN/latest/">Python Cookbook</a></li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p><strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><ul>
<li>完成你的项目，并且对P3阶段做一个自我总结，最好能以博客或者朋友圈文章的形式进行输出。</li>
</ul>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody><tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>项目三</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody></table>
<h1 id="知识点清单"><a href="#知识点清单" class="headerlink" title="知识点清单"></a>知识点清单</h1><h2 id="第六周-数据分析过程"><a href="#第六周-数据分析过程" class="headerlink" title="第六周-数据分析过程"></a><a href="http://www.capallen.top/dand-vip/2018/08/19/%E7%AC%AC%E5%85%AD%E5%91%A8-1-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E8%BF%87%E7%A8%8B/">第六周-数据分析过程</a></h2><ul>
<li><p>数据分析的基本流程</p>
<ul>
<li>提出问题</li>
<li>整理数据（收集、评估、清理）</li>
<li>探索性数据分析</li>
<li>得出结论，传达结果</li>
</ul>
</li>
<li><p>Pandas在数据分析中的应用</p>
<ul>
<li>导入文件（read_csv/excel/sep/encoding）</li>
<li>数据评估（shape / info / describe / columns/ isnull/ duplicated/ value_counts/ sort_values/ ascending/ unique/ nunique）</li>
<li>数据筛选（df[‘col_name’]/loc/iloc/np.r_/isin/query/groupby/<code>&amp;</code>/<code>|</code>）</li>
<li>数据清理（drop/inplace/fillna/dropna/drop_duplicates/rename/replace）</li>
<li>数据融合（merge/concat/append/join）</li>
<li>可视化（plot）</li>
<li>导出数据（to_csv/index/encoding = ‘utf-8-sig’）</li>
</ul>
</li>
</ul>
<h2 id="第七周-可视化"><a href="#第七周-可视化" class="headerlink" title="第七周-可视化"></a><a href="http://www.capallen.top/dand-vip/2018/08/28/%E7%AC%AC%E4%B8%83%E5%91%A8-%E5%8F%AF%E8%A7%86%E5%8C%96/">第七周-可视化</a></h2><ul>
<li><p>基本概念（fig/ax）</p>
</li>
<li><p>开始绘图（plt.subplots/plt.add_subplot/plt.figure）</p>
</li>
<li><p>坐标轴设置</p>
<ul>
<li><p>调整范围（ax.axis/xlim/ylim）</p>
</li>
<li><p>调整刻度</p>
<ul>
<li>设置间隔（locator_params）</li>
<li>设置顺序，角度（xticks(order_list,tick_names,rotation)</li>
</ul>
</li>
<li><p>双轴（twinx）</p>
</li>
</ul>
</li>
<li><p>标题与轴标题（title,xlabel,ylabel）</p>
</li>
<li><p>图例（legend）</p>
</li>
<li><p>颜色与样式（plot(x,y,’<code>color``marker``line</code>‘）</p>
</li>
<li><p>网格（grid）</p>
</li>
<li><p>图像注释（annote）</p>
</li>
<li><p>平行于坐标轴的线（vline/hline）</p>
</li>
<li><p>常用可视化图形</p>
<ul>
<li>散点图（scatter）</li>
<li>条形图（bar/barh）</li>
<li>直方图（hist）</li>
<li>饼状图（pie）</li>
<li>箱线图（box）</li>
</ul>
</li>
</ul>
<h2 id="第八周-TMDb数据分析"><a href="#第八周-TMDb数据分析" class="headerlink" title="第八周-TMDb数据分析"></a><a href="http://www.capallen.top/dand-vip/2018/09/05/%E7%AC%AC%E5%85%AB%E5%91%A8-TMDB%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">第八周-TMDb数据分析</a></h2><ul>
<li>如何提出问题？ 找出关键变量，提与之相关的问题</li>
<li>数据备份（copy）</li>
<li>如何将一列处理为多列？（<a href="http://www.capallen.top/dand-vip/2018/09/05/%E7%AC%AC%E5%85%AB%E5%91%A8-TMDB%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#%E6%B8%85%E7%90%86%E6%95%B0%E6%8D%AE">genres列的处理</a>）<ul>
<li>拓展：pivot函数</li>
</ul>
</li>
</ul>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/reshaping_pivot.png"></p>
<ul>
<li><p>如何着手探索性数据分析？</p>
<ul>
<li>单变量 - 双变量 - 多变量</li>
<li>关键变量 - 其他变量与关键变量</li>
</ul>
</li>
<li><p>可视化</p>
<ul>
<li>热度图（heatmap）</li>
<li>pairplot</li>
</ul>
</li>
<li><p>一些函数：</p>
<ul>
<li>获取某一位置的数值 quantile</li>
<li>按列表筛选 isin</li>
</ul>
</li>
</ul>
<h2 id="第八周-FBI枪支数据分析"><a href="#第八周-FBI枪支数据分析" class="headerlink" title="第八周-FBI枪支数据分析"></a><a href="http://www.capallen.top/dand-vip/2018/09/08/%E7%AC%AC%E5%85%AB%E5%91%A8-FBI%E6%9E%AA%E6%94%AF%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">第八周-FBI枪支数据分析</a></h2><ul>
<li>DataFrame行列变换：transpose</li>
<li>按字符串内容筛选：contains</li>
<li>按索引进行数据融合：join</li>
</ul>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>通过这四周的学习，你又掌握了：</p>
<ul>
<li>数据分析的基本流程</li>
<li>Pandas在数据分析各个流程中的基本应用</li>
<li>Pandas常用函数的用法</li>
<li>Matplotlib在可视化中的应用</li>
</ul>
<p>此外，你还增长了这些软技能：</p>
<ul>
<li>数据分析思维（化繁为简、化难为易、关键信息的提取）</li>
<li>耐心（EDA的过程，做过的都知道）</li>
<li>细心（有没有调试半天最终才发现是自己马虎导致的问题？）</li>
</ul>
<p>如果你学习时间充裕，你还有可能掌握了：</p>
<ul>
<li>Seaborn在可视化中的应用</li>
<li>如何快速有效地使用搜索引擎</li>
<li>在Stackoverflow注册账户，提出问题，成为一名铜牌用户</li>
<li>有了自己的技术博客，并发表了第一篇总结性文章</li>
<li>… …</li>
</ul>
<p>哈！这么总结下来，发现不知不觉间，又掌握了很多！又进步了很多！我导师之前教育我说：“<strong>你之所以现在这么焦虑，都是因为你自己的能力满足不了你的欲望。</strong>”那么，同样因为对未来感到焦虑来到这里学习的你们，经过这段时间的学习，焦虑是不是缓解了许多呢？哈哈，所以，请不要放松脚步，KEEP GOING！</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.capallen.top/2018/FBI%E6%9E%AA%E6%94%AF%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Allen Jia">
      <meta itemprop="description" content="数据 算法 分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Blog">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/FBI%E6%9E%AA%E6%94%AF%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html" class="post-title-link" itemprop="url">每周导学-第八周-FBI枪支数据分析</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-08 12:30:09" itemprop="dateCreated datePublished" datetime="2018-09-08T12:30:09+08:00">2018-09-08</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2019-06-06 10:32:23" itemprop="dateModified" datetime="2019-06-06T10:32:23+08:00">2019-06-06</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a>
        </span>
    </span>

  
    <span id="/2018/FBI%E6%9E%AA%E6%94%AF%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html" class="post-meta-item leancloud_visitors" data-flag-title="每周导学-第八周-FBI枪支数据分析" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/FBI%E6%9E%AA%E6%94%AF%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/FBI%E6%9E%AA%E6%94%AF%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>Stop being afraid of what could go wrong and start being positive about what could go right.</p>
</blockquote>
<p>Hi，同学们，经过了前两周的学习，我们掌握了数据分析的基本流程、Pandas在数据分析各个流程中的基本应用以及使用matplotlib&amp;Pandas进行可视化的技巧，那么本周我们就真刀实枪地找一套数据集练练手。本周的导学有两期，分别选用了项目三中的两个数据集（<strong>TMDb电影数据和FBI枪支数据</strong>）进行分析，只是分享思路和方法，起一个抛砖引玉的作用，大家选择其他的数据集也可以举一反三，如果有什么棘手的问题随时微信联系我就OK~</p>
<p>本周开始，我们就进入到了<strong>项目三(P3)阶段</strong>，本阶段总共包含<strong>四周</strong>，在这一个月内，我们要对<strong>数据分析入门</strong>进行学习，学习数据分析思维，掌握Python数据分析及可视化方法，并使用所学知识完成<strong>项目三：探索数据集</strong>，尝试着自己完成整个数据分析的流程，得到一些饶有兴趣的结论，你一定会非常有成就感哒！那么以下便是这四周的学习安排：</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody><tr>
<td>第1周</td>
<td>数据分析过程-1</td>
<td>数据分析过程&amp;案例研究-1</td>
</tr>
<tr>
<td>第2周</td>
<td>数据分析过程-2</td>
<td>案例研究-1&amp;案例研究-2</td>
</tr>
<tr>
<td><strong>第3周</strong></td>
<td><strong>完成项目</strong></td>
<td><strong>项目：探索数据集</strong></td>
</tr>
<tr>
<td>第4周</td>
<td>项目修改与通过</td>
<td>修改项目、查缺补漏、休息调整</td>
</tr>
</tbody></table>
<p><font size = '3' color = 'red'><strong>！！看这里！！</strong>：在P3课程里面安排了SQL的高阶课程，但是因为在项目三中并不会涉及到SQL知识，所以为了保证大家学习的连贯性，在完成前两周的课程之后，就开始项目。至于<strong>！！SQL的高阶知识，大家可以放在课程通关后进行选修！！</strong>； </font></p>
<p>本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/百度搜索、<a target="_blank" rel="noopener" href="http://www.runoob.com/python3/python3-tutorial.html">菜鸟教程</a>、<a target="_blank" rel="noopener" href="https://www.csdn.net/">CSDN</a>、<a target="_blank" rel="noopener" href="https://stackoverflow.com/">stack<strong>overflow</strong></a>、<a target="_blank" rel="noopener" href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/Python%20for%20Data%20Analysis%2C%202nd%20Edition.pdf"><strong>Python for Data Analysis, 2nd Edition</strong> </a>、<a target="_blank" rel="noopener" href="http://python3-cookbook.readthedocs.io/zh_CN/latest/">Python Cookbook</a></li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p><strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><ul>
<li>在<a target="_blank" rel="noopener" href="https://github.com/udacity/new-dand-basic-china/blob/master/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%A5%E9%97%A8/%E9%A1%B9%E7%9B%AE-%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86/%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86%20-%20%E5%A4%87%E9%80%89%E6%95%B0%E6%8D%AE%E9%9B%86.md">此处</a>挑选和你确认过眼神的数据集，并对其进行数据分析和探索，得出你自己的结论，然后进行提交。</li>
</ul>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody><tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>项目三</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody></table>
<h1 id="项目准备"><a href="#项目准备" class="headerlink" title="项目准备"></a>项目准备</h1><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>强烈建议大家完成本地环境的搭建，在本地完成此项目。搭建本地环境的方法请参考<a target="_blank" rel="noopener" href="https://classroom.udacity.com/nanodegrees/nd002-cn-basic-vip/parts/e566ad37-6119-4448-a6bc-7ade73ef3992">Anaconda的安装与配置</a>一节，完成后你将获得本项目中会用到的关键软件：<strong>Spyder</strong>和<strong>Jupyter Notebook</strong>。</p>
<h2 id="文件准备"><a href="#文件准备" class="headerlink" title="文件准备"></a>文件准备</h2><ul>
<li>项目文件：依次进入到<strong>项目：探索数据集</strong> –&gt; <strong>3.实战项目</strong>中，下载项目文件的ipynb格式。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/Pz6nds"><img src="https://s1.ax1x.com/2018/09/03/Pz6nds.md.png" alt="Pz6nds.md.png"></a></p>
<ul>
<li><p>数据集选择：在<a target="_blank" rel="noopener" href="https://github.com/udacity/new-dand-basic-china/blob/master/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%A5%E9%97%A8/%E9%A1%B9%E7%9B%AE-%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86/%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86%20-%20%E5%A4%87%E9%80%89%E6%95%B0%E6%8D%AE%E9%9B%86.md">此处</a>选择你感兴趣的数据集并下载至与<strong>项目文件相同的文件夹</strong>。（若下载失败，请微信联系我索取）</p>
</li>
<li><p>本地打开：在项目文件的文件夹下，按住<code>Shift</code>键，右击选择<code>在此处打开命令窗口</code>，输入<code>jupyter notebook</code>，待打开本地页面之后，选择项目文件打开，之后就请开始你的表演。</p>
<p><img src="https://ws2.sinaimg.cn/large/9150e4e5ly1fg4xzdddjhj20b407u74k.jpg"></p>
</li>
</ul>
<h2 id="方法准备"><a href="#方法准备" class="headerlink" title="方法准备"></a>方法准备</h2><p>项目文件中已经给大家列好了基本流程，所以请在开始项目之前，一定要<strong>先整体浏览一遍项目文件</strong>，着重看一下：</p>
<ul>
<li>项目流程</li>
<li>每一个流程中你需要做哪些工作</li>
<li>每一个流程中的提示</li>
</ul>
<p>要记得，数据分析过程不是一蹴而就的，是螺旋上升接近目标的过程，所以一定要保持耐心，对照着<a target="_blank" rel="noopener" href="https://review.udacity.com/#!/rubrics/306/view">项目评估准则</a>一步步完成。</p>
<p>另外，一开始你的notebook会显得很乱没有章法，那在<strong>提交之前最好能再修改一个整理好的版本</strong>。</p>
<h1 id="项目流程（FBI枪支数据）"><a href="#项目流程（FBI枪支数据）" class="headerlink" title="项目流程（FBI枪支数据）"></a>项目流程（FBI枪支数据）</h1><h2 id="数据集说明"><a href="#数据集说明" class="headerlink" title="数据集说明"></a>数据集说明</h2><p>该数据来自联邦调查局 (FBI) 的全国即时犯罪背景调查系统 (NICS)。NICS 用于确定潜在买家是否有资格购买枪支或爆炸物。枪支店可以进入这个系统，以确保每位客户没有犯罪记录或符合资格购买。该数据已经收纳了来自<br>census.gov 的州级数据作为补充数据。<a target="_blank" rel="noopener" href="https://d17h27t6h515a5.cloudfront.net/topher/2017/November/5a0a4db8_gun-data/gun-data.xlsx">NICS 数据</a>在一个 xlsx 文件格式的一个表格中，它包含了按照月份(month)、州 (state) 、类型 (type) 统计的武器调查数量 (the number of firearm checks) ;美国的<a target="_blank" rel="noopener" href="https://d17h27t6h515a5.cloudfront.net/topher/2017/November/5a0a554c_u.s.-census-data/u.s.-census-data.csv">人口普查数据</a> (U.S. census data) 储存在一个 csv 文件中。它包含了州级的几个变量，每个州的大多数变量在 2016 年只有一个数据点，但一些变量有一年以上的数据。</p>
<h2 id="提出问题"><a href="#提出问题" class="headerlink" title="提出问题"></a>提出问题</h2><p>虽说本数据集有两个数据文件，但围绕的关键词只有一个，那就是<strong>枪支</strong>，所以提出问题时，也一定要围绕着该关键词进行提问。问题示例：</p>
<ul>
<li>就本数据集统计而言，哪个州的枪支总量增长最高？该州的增长速率如何？  </li>
<li>就本数据集统计而言，全美整体购买枪支总量及各种类的趋势是什么？  </li>
<li>2016年哪个州的人均拥有枪支量最高？  </li>
<li>结合2016年各州的人口普查数据，是否有哪项数据与人均拥有枪支量线性相关？</li>
</ul>
<h2 id="导入拓展包"><a href="#导入拓展包" class="headerlink" title="导入拓展包"></a>导入拓展包</h2><p>一般来说，就导入如下几个拓展包就够了，当然如果后续操作中还需导入其他包的话，再补充即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用这个框对你计划使用的所有数据包进行设置</span></span><br><span class="line"><span class="comment">#   导入语句。</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="comment"># 务必包含一个‘magic word’，以便将你的视图与 notebook 保持一致。</span></span><br><span class="line">%matplotlib inline</span><br><span class="line"><span class="comment">#关于更多信息，请访问该网页：</span></span><br><span class="line"><span class="comment">#   http://ipython.readthedocs.io/en/stable/interactive/magics.html</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="数据整理"><a href="#数据整理" class="headerlink" title="数据整理"></a>数据整理</h2><h3 id="导入数据"><a href="#导入数据" class="headerlink" title="导入数据"></a>导入数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导入枪支数据</span></span><br><span class="line">df_gun = pd.read_excel(<span class="string">&#x27;gun_data.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment">#导入人口普查数据,这里有一点需要注意，若数据集中全部是包含有千位分隔符的数据，可以在read_csv中添加参数&quot;thousands = &#x27;,&#x27;&quot;。</span></span><br><span class="line">df_census = pd.read_csv(<span class="string">&#x27;U.S. Census Data.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="评估数据"><a href="#评估数据" class="headerlink" title="评估数据"></a>评估数据</h3><h4 id="枪支数据"><a href="#枪支数据" class="headerlink" title="枪支数据"></a>枪支数据</h4><ul>
<li>浏览数据</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_gun.head()</span><br></pre></td></tr></table></figure>

<p>这里要注意一点，因为数据集的列数较多，jupyter会自动折叠中间的部分列，导致我们预览数据时总是看不完整，这时候你可以尝试下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#col_numbers设置为不小于你数据集列数的某一值</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;max_columns&#x27;</span>,col_numbers)</span><br></pre></td></tr></table></figure>

<p>同理，也可以用’max_rows’设置最大显示行数。</p>
<ul>
<li>列及数据类型</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_gun.info()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">pandas</span>.<span class="title">core</span>.<span class="title">frame</span>.<span class="title">DataFrame</span>&#x27;&gt;</span></span><br><span class="line"><span class="class"><span class="title">RangeIndex</span>:</span> <span class="number">12485</span> entries, <span class="number">0</span> to <span class="number">12484</span></span><br><span class="line">Data columns (total <span class="number">27</span> columns):</span><br><span class="line">month                        <span class="number">12485</span> non-null object</span><br><span class="line">state                        <span class="number">12485</span> non-null object</span><br><span class="line">permit                       <span class="number">12461</span> non-null float64</span><br><span class="line">permit_recheck               <span class="number">1100</span> non-null float64</span><br><span class="line">handgun                      <span class="number">12465</span> non-null float64</span><br><span class="line">long_gun                     <span class="number">12466</span> non-null float64</span><br><span class="line">other                        <span class="number">5500</span> non-null float64</span><br><span class="line">multiple                     <span class="number">12485</span> non-null int64</span><br><span class="line">admin                        <span class="number">12462</span> non-null float64</span><br><span class="line">prepawn_handgun              <span class="number">10542</span> non-null float64</span><br><span class="line">prepawn_long_gun             <span class="number">10540</span> non-null float64</span><br><span class="line">prepawn_other                <span class="number">5115</span> non-null float64</span><br><span class="line">redemption_handgun           <span class="number">10545</span> non-null float64</span><br><span class="line">redemption_long_gun          <span class="number">10544</span> non-null float64</span><br><span class="line">redemption_other             <span class="number">5115</span> non-null float64</span><br><span class="line">returned_handgun             <span class="number">2200</span> non-null float64</span><br><span class="line">returned_long_gun            <span class="number">2145</span> non-null float64</span><br><span class="line">returned_other               <span class="number">1815</span> non-null float64</span><br><span class="line">rentals_handgun              <span class="number">990</span> non-null float64</span><br><span class="line">rentals_long_gun             <span class="number">825</span> non-null float64</span><br><span class="line">private_sale_handgun         <span class="number">2750</span> non-null float64</span><br><span class="line">private_sale_long_gun        <span class="number">2750</span> non-null float64</span><br><span class="line">private_sale_other           <span class="number">2750</span> non-null float64</span><br><span class="line">return_to_seller_handgun     <span class="number">2475</span> non-null float64</span><br><span class="line">return_to_seller_long_gun    <span class="number">2750</span> non-null float64</span><br><span class="line">return_to_seller_other       <span class="number">2255</span> non-null float64</span><br><span class="line">totals                       <span class="number">12485</span> non-null int64</span><br><span class="line">dtypes: float64(<span class="number">23</span>), int64(<span class="number">2</span>), object(<span class="number">2</span>)</span><br><span class="line">memory usage: <span class="number">2.6</span>+ MB</span><br></pre></td></tr></table></figure>

<p>纵览了一下，各列的数据类型基本没什么问题，唯一有问题的是<code>month</code>列，应该是<code>datetime</code>类型。整个数据集就是由时间、州名和各式各样的枪支数据组成的。</p>
<ul>
<li>查看各列的缺失值情况</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#这里我们计算的缺失比例</span></span><br><span class="line">df_gun.isnull().sum()/df_gun.shape[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">month                        <span class="number">0.000000</span></span><br><span class="line">state                        <span class="number">0.000000</span></span><br><span class="line">permit                       <span class="number">0.001922</span></span><br><span class="line">permit_recheck               <span class="number">0.911894</span></span><br><span class="line">handgun                      <span class="number">0.001602</span></span><br><span class="line">long_gun                     <span class="number">0.001522</span></span><br><span class="line">other                        <span class="number">0.559471</span></span><br><span class="line">multiple                     <span class="number">0.000000</span></span><br><span class="line">admin                        <span class="number">0.001842</span></span><br><span class="line">prepawn_handgun              <span class="number">0.155627</span></span><br><span class="line">prepawn_long_gun             <span class="number">0.155787</span></span><br><span class="line">prepawn_other                <span class="number">0.590308</span></span><br><span class="line">redemption_handgun           <span class="number">0.155386</span></span><br><span class="line">redemption_long_gun          <span class="number">0.155467</span></span><br><span class="line">redemption_other             <span class="number">0.590308</span></span><br><span class="line">returned_handgun             <span class="number">0.823789</span></span><br><span class="line">returned_long_gun            <span class="number">0.828194</span></span><br><span class="line">returned_other               <span class="number">0.854626</span></span><br><span class="line">rentals_handgun              <span class="number">0.920705</span></span><br><span class="line">rentals_long_gun             <span class="number">0.933921</span></span><br><span class="line">private_sale_handgun         <span class="number">0.779736</span></span><br><span class="line">private_sale_long_gun        <span class="number">0.779736</span></span><br><span class="line">private_sale_other           <span class="number">0.779736</span></span><br><span class="line">return_to_seller_handgun     <span class="number">0.801762</span></span><br><span class="line">return_to_seller_long_gun    <span class="number">0.779736</span></span><br><span class="line">return_to_seller_other       <span class="number">0.819383</span></span><br><span class="line">totals                       <span class="number">0.000000</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>

<p>可见数据集的缺失情况非常严重，这时候需要你直接运行<code>df_gun</code>去观察全部数据，这样才能有据猜想数据缺失的原因。简要通览数据后，我们发现近年的数据缺失不大，猜想之前的统计中没有对枪支进行详细分类或者是统计不全导致的，而且就枪支数量而言，缺失数据较少的permit、handgun、long_gun和other等列占绝对优势，所以我们完全可以只筛选最有代表性的这几列进行分析。</p>
<blockquote>
<p>因为筛选后的数据跟之前相差较大，为了提高后续步骤的效率，可以在此先进行数据清理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#因为此次筛选的数据列是间隔的，所以调用了numpy的r_函数生成列表，按照列序号筛选间隔的列。</span></span><br><span class="line">df_gun = df_gun.iloc[:,np.r_[<span class="number">0</span>:<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">26</span>]].dropna()</span><br></pre></td></tr></table></figure>

<p>之后，还需对最后一列<code>totals</code>进行修正</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_gun[<span class="string">&#x27;totals&#x27;</span>] = df_gun[<span class="string">&#x27;permit&#x27;</span>]+df_gun[<span class="string">&#x27;handgun&#x27;</span>]+df_gun[<span class="string">&#x27;long_gun&#x27;</span>]+df_gun[<span class="string">&#x27;multiple&#x27;</span>]+df_gun[<span class="string">&#x27;admin&#x27;</span>]</span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li>查看重复值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#检查是否有数据重复</span></span><br><span class="line">sum(df_gun.duplicated())</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>无重复数据。</p>
<ul>
<li>查看state列的唯一值数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_gun[<span class="string">&#x27;state&#x27;</span>].nunique()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">55</span></span><br></pre></td></tr></table></figure>

<p>美国一共有50个州，多出来的5个是什么鬼？是不是有缩写的州名导致的重复？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_gun[<span class="string">&#x27;state&#x27;</span>].value_counts()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">New Mexico              <span class="number">227</span></span><br><span class="line">California              <span class="number">227</span></span><br><span class="line">South Carolina          <span class="number">227</span></span><br><span class="line">Arkansas                <span class="number">227</span></span><br><span class="line">Kansas                  <span class="number">227</span></span><br><span class="line">New Jersey              <span class="number">227</span></span><br><span class="line">West Virginia           <span class="number">227</span></span><br><span class="line">Texas                   <span class="number">227</span></span><br><span class="line">Maryland                <span class="number">227</span></span><br><span class="line">District of Columbia    <span class="number">227</span></span><br><span class="line">New Hampshire           <span class="number">227</span></span><br><span class="line">Alaska                  <span class="number">227</span></span><br><span class="line">Mississippi             <span class="number">227</span></span><br><span class="line">Alabama                 <span class="number">227</span></span><br><span class="line">Vermont                 <span class="number">227</span></span><br><span class="line">Illinois                <span class="number">227</span></span><br><span class="line">North Dakota            <span class="number">227</span></span><br><span class="line">Rhode Island            <span class="number">227</span></span><br><span class="line">Pennsylvania            <span class="number">227</span></span><br><span class="line">Oklahoma                <span class="number">227</span></span><br><span class="line">Kentucky                <span class="number">227</span></span><br><span class="line">Florida                 <span class="number">227</span></span><br><span class="line">North Carolina          <span class="number">227</span></span><br><span class="line">Utah                    <span class="number">227</span></span><br><span class="line">Idaho                   <span class="number">227</span></span><br><span class="line">Connecticut             <span class="number">227</span></span><br><span class="line">Missouri                <span class="number">227</span></span><br><span class="line">Nebraska                <span class="number">227</span></span><br><span class="line">Tennessee               <span class="number">227</span></span><br><span class="line">Massachusetts           <span class="number">227</span></span><br><span class="line">Nevada                  <span class="number">227</span></span><br><span class="line">Arizona                 <span class="number">227</span></span><br><span class="line">Hawaii                  <span class="number">227</span></span><br><span class="line">Indiana                 <span class="number">227</span></span><br><span class="line">Oregon                  <span class="number">227</span></span><br><span class="line">Michigan                <span class="number">227</span></span><br><span class="line">Minnesota               <span class="number">227</span></span><br><span class="line">Ohio                    <span class="number">227</span></span><br><span class="line">New York                <span class="number">227</span></span><br><span class="line">Wyoming                 <span class="number">227</span></span><br><span class="line">Iowa                    <span class="number">227</span></span><br><span class="line">Maine                   <span class="number">227</span></span><br><span class="line">Guam                    <span class="number">227</span></span><br><span class="line">Wisconsin               <span class="number">227</span></span><br><span class="line">South Dakota            <span class="number">227</span></span><br><span class="line">Puerto Rico             <span class="number">227</span></span><br><span class="line">Georgia                 <span class="number">227</span></span><br><span class="line">Washington              <span class="number">227</span></span><br><span class="line">Delaware                <span class="number">227</span></span><br><span class="line">Louisiana               <span class="number">226</span></span><br><span class="line">Virginia                <span class="number">226</span></span><br><span class="line">Montana                 <span class="number">226</span></span><br><span class="line">Colorado                <span class="number">226</span></span><br><span class="line">Mariana Islands         <span class="number">218</span></span><br><span class="line">Virgin Islands          <span class="number">214</span></span><br><span class="line">Name: state, dtype: int64</span><br></pre></td></tr></table></figure>

<p>结果一目了然，不仅有美国各州，还包括了Mariana Islands 、Virgin Islands 等地，感兴趣可以去搜了一下，都是老美宣誓主权的一些群岛。</p>
<h4 id="人口普查数据"><a href="#人口普查数据" class="headerlink" title="人口普查数据"></a>人口普查数据</h4><p>评估的步骤差不多，所以只罗列一些需要注意的点。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_census.info()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">pandas</span>.<span class="title">core</span>.<span class="title">frame</span>.<span class="title">DataFrame</span>&#x27;&gt;</span></span><br><span class="line"><span class="class"><span class="title">RangeIndex</span>:</span> <span class="number">85</span> entries, <span class="number">0</span> to <span class="number">84</span></span><br><span class="line">Data columns (total <span class="number">52</span> columns):</span><br><span class="line">Fact              <span class="number">80</span> non-null object</span><br><span class="line">Fact Note         <span class="number">28</span> non-null object</span><br><span class="line">Alabama           <span class="number">65</span> non-null object</span><br><span class="line">Alaska            <span class="number">65</span> non-null object</span><br><span class="line">Arizona           <span class="number">65</span> non-null object</span><br><span class="line">Arkansas          <span class="number">65</span> non-null object</span><br><span class="line">California        <span class="number">65</span> non-null object</span><br><span class="line">Colorado          <span class="number">65</span> non-null object</span><br><span class="line">Connecticut       <span class="number">65</span> non-null object</span><br><span class="line">Delaware          <span class="number">65</span> non-null object</span><br><span class="line">Florida           <span class="number">65</span> non-null object</span><br><span class="line">Georgia           <span class="number">65</span> non-null object</span><br><span class="line">Hawaii            <span class="number">65</span> non-null object</span><br><span class="line">Idaho             <span class="number">65</span> non-null object</span><br><span class="line">Illinois          <span class="number">65</span> non-null object</span><br><span class="line">Indiana           <span class="number">65</span> non-null object</span><br><span class="line">Iowa              <span class="number">65</span> non-null object</span><br><span class="line">Kansas            <span class="number">65</span> non-null object</span><br><span class="line">Kentucky          <span class="number">65</span> non-null object</span><br><span class="line">Louisiana         <span class="number">65</span> non-null object</span><br><span class="line">Maine             <span class="number">65</span> non-null object</span><br><span class="line">Maryland          <span class="number">65</span> non-null object</span><br><span class="line">Massachusetts     <span class="number">65</span> non-null object</span><br><span class="line">Michigan          <span class="number">65</span> non-null object</span><br><span class="line">Minnesota         <span class="number">65</span> non-null object</span><br><span class="line">Mississippi       <span class="number">65</span> non-null object</span><br><span class="line">Missouri          <span class="number">65</span> non-null object</span><br><span class="line">Montana           <span class="number">65</span> non-null object</span><br><span class="line">Nebraska          <span class="number">65</span> non-null object</span><br><span class="line">Nevada            <span class="number">65</span> non-null object</span><br><span class="line">New Hampshire     <span class="number">65</span> non-null object</span><br><span class="line">New Jersey        <span class="number">65</span> non-null object</span><br><span class="line">New Mexico        <span class="number">65</span> non-null object</span><br><span class="line">New York          <span class="number">65</span> non-null object</span><br><span class="line">North Carolina    <span class="number">65</span> non-null object</span><br><span class="line">North Dakota      <span class="number">65</span> non-null object</span><br><span class="line">Ohio              <span class="number">65</span> non-null object</span><br><span class="line">Oklahoma          <span class="number">65</span> non-null object</span><br><span class="line">Oregon            <span class="number">65</span> non-null object</span><br><span class="line">Pennsylvania      <span class="number">65</span> non-null object</span><br><span class="line">Rhode Island      <span class="number">65</span> non-null object</span><br><span class="line">South Carolina    <span class="number">65</span> non-null object</span><br><span class="line">South Dakota      <span class="number">65</span> non-null object</span><br><span class="line">Tennessee         <span class="number">65</span> non-null object</span><br><span class="line">Texas             <span class="number">65</span> non-null object</span><br><span class="line">Utah              <span class="number">65</span> non-null object</span><br><span class="line">Vermont           <span class="number">65</span> non-null object</span><br><span class="line">Virginia          <span class="number">65</span> non-null object</span><br><span class="line">Washington        <span class="number">65</span> non-null object</span><br><span class="line">West Virginia     <span class="number">65</span> non-null object</span><br><span class="line">Wisconsin         <span class="number">65</span> non-null object</span><br><span class="line">Wyoming           <span class="number">65</span> non-null object</span><br><span class="line">dtypes: object(<span class="number">52</span>)</span><br><span class="line">memory usage: <span class="number">34.6</span>+ KB</span><br></pre></td></tr></table></figure>

<p>发现一个奇怪的事情，基本上所有列数据都在65行之后没有了，肯定有什么猫腻，可以用tail()或者直接打开文件查看（因为数据量很小），发现后面几行都是对数据统计的一些说明，没有实际意义，直接删除即可。而且在该数据中只有50个州的数据。</p>
<h3 id="清理数据"><a href="#清理数据" class="headerlink" title="清理数据"></a>清理数据</h3><blockquote>
<p>清理数据就是对上一步中发现的问题进行清理，并且删除无关列，最终得到的是一个方便你进行分析及可视化的干净数据。</p>
<p><strong>清理前记得备份数据</strong></p>
</blockquote>
<ul>
<li><p>删除无关列</p>
<p>建议使用drop函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除列</span></span><br><span class="line">df_census.drop(<span class="string">&#x27;Fact Note&#x27;</span>,axis = <span class="number">1</span>,inplace = <span class="literal">True</span>)</span><br><span class="line"><span class="comment">#删除行</span></span><br><span class="line">df_census.drop(np.arange(<span class="number">64</span>,<span class="number">85</span>),inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>数据融合</p>
<p>想要找出人口普查的数据与枪支数据之间的关系，肯定要把这两个数据进行融合。</p>
<p>融合前，我们先观察一下人口普查数据中到底有哪些，发现每个州的大部分变量都只在2016年有记录点，所以我们就要分别从人口普查数据和枪支数据中筛选出2016年的数据，再以州作为键（key）进行合并。</p>
<p><strong>筛选数据</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#先筛选出人口普查数据中2016年的数据，并将Fact列作为索引</span></span><br><span class="line">df_census_2016 = df_census[df_census.Fact.str.contains(<span class="string">&#x27;2016&#x27;</span>)].set_index(<span class="string">&#x27;Fact&#x27;</span>)</span><br><span class="line"><span class="comment">#转秩</span></span><br><span class="line">df_census_2016 = df_census_2016.transpose()</span><br><span class="line"><span class="comment">#筛选2016年的枪支数据,并按照州分组计算全年均值</span></span><br><span class="line">df_gun_2016 = df_gun[df_gun[<span class="string">&#x27;month&#x27;</span>].str.contains(<span class="string">&#x27;2016&#x27;</span>)].groupby(<span class="string">&#x27;state&#x27;</span>).mean()</span><br></pre></td></tr></table></figure>

<p><strong>处理千位分隔符和百分号</strong></p>
<p>在人口普查数据中数字中均包含有千位分隔符或者是百分号，这会给我们之后进行分析带来不便，处理掉他们，并且转换为浮点型数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#先将有千位分隔符的列转为float类型</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [ <span class="string">&#x27;Population estimates, July 1, 2016,  (V2016)&#x27;</span>,<span class="string">&#x27;Housing units,  July 1, 2016,  (V2016)&#x27;</span>, <span class="string">&#x27;Building permits, 2016&#x27;</span>]:</span><br><span class="line">    df_census_2016[i] = df_census_2016[i].str.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    df_census_2016[i] = df_census_2016[i].str.join(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    df_census_2016[i] = df_census_2016[i].astype(float)</span><br></pre></td></tr></table></figure>

<p>百分号的处理方式同上类似。</p>
<p><strong>数据融合</strong></p>
<p>我们在之前的导学中总结过Pandas做数据融合的方法，就此项目而言，两个数据以索引（Index，也就是各州的州名）为键进行融合，最简单的方法就是用join()函数了。如果你忘了，可以点<a href="http://www.capallen.top/dand-vip/2018/08/21/%E7%AC%AC%E5%85%AD%E5%91%A8-2-%E6%95%B0%E6%8D%AE%E8%9E%8D%E5%90%88/">这里</a>复习一下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_2016 = df_gun_2016.join(df_census_2016)</span><br></pre></td></tr></table></figure>

<p>好，至此我们的数据就算是整理完毕了，接下来就是探索性分析及可视化阶段，这里没有什么特别需要注意的地方，大家就随性而为。</p>
</li>
</ul>
<h2 id="探索性数据分析"><a href="#探索性数据分析" class="headerlink" title="探索性数据分析"></a>探索性数据分析</h2><p>在这个阶段你可以随意做可视化，尽可能多得去探索你想解决的问题。<strong>在探索阶段，作图可以不用很规范，你自己知道是什么意思就可以</strong>，而且可能会有些探索的问题结果意义不大，所以<strong>在提交项目时，要进行择优保留并对其润色修饰</strong>。</p>
<ul>
<li>探索不同年份，美国或者是不同州的枪支数量变化就使用df_gun数据集；</li>
<li>探索不同州的人口普查数据与枪支持有量之间的关系就使用我们之后整理的df_2016数据集。</li>
</ul>
<h2 id="得出结论"><a href="#得出结论" class="headerlink" title="得出结论"></a>得出结论</h2><p>对你整理好的可视化图像进行总结，结论要有根有据但也不要只是停留在<code>描述</code>，可以进行适当的猜测。</p>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><ul>
<li>导学只是参考和分享，我是还原了自己在做项目时的思路历程，这并不是提交项目时应有的样子。</li>
<li>记得提交前一定要再重新审视一遍，调整代码，注释，修缮可视化及结论。</li>
<li>经过P3的历练，相信你能更自信，也更能有成就感，坚持！！</li>
<li>加油！！！</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.capallen.top/2018/TMDB%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Allen Jia">
      <meta itemprop="description" content="数据 算法 分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Blog">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/TMDB%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html" class="post-title-link" itemprop="url">每周导学-第八周-TMDb数据分析</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-09-05 12:30:09" itemprop="dateCreated datePublished" datetime="2018-09-05T12:30:09+08:00">2018-09-05</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2019-06-06 10:32:23" itemprop="dateModified" datetime="2019-06-06T10:32:23+08:00">2019-06-06</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a>
        </span>
    </span>

  
    <span id="/2018/TMDB%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html" class="post-meta-item leancloud_visitors" data-flag-title="每周导学-第八周-TMDb数据分析" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/TMDB%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/TMDB%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>Awareness is the greatest agent for change.</p>
</blockquote>
<p>Hi，同学们，经过了前两周的学习，我们掌握了数据分析的基本流程、Pandas在数据分析各个流程中的基本应用以及使用matplotlib&amp;Pandas进行可视化的技巧，那么本周我们就真刀实枪地找一套数据集练练手。本周的导学有两期，分别选用了项目三中的两个数据集（<strong>TMDb电影数据和FBI枪支数据</strong>）进行分析，只是分享思路和方法，起一个抛砖引玉的作用，大家选择其他的数据集也可以举一反三，如果有什么棘手的问题随时微信联系我就OK~</p>
<p>本周开始，我们就进入到了<strong>项目三(P3)阶段</strong>，本阶段总共包含<strong>四周</strong>，在这一个月内，我们要对<strong>数据分析入门</strong>进行学习，学习数据分析思维，掌握Python数据分析及可视化方法，并使用所学知识完成<strong>项目三：探索数据集</strong>，尝试着自己完成整个数据分析的流程，得到一些饶有兴趣的结论，你一定会非常有成就感哒！那么以下便是这四周的学习安排：</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody><tr>
<td>第1周</td>
<td>数据分析过程-1</td>
<td>数据分析过程&amp;案例研究-1</td>
</tr>
<tr>
<td>第2周</td>
<td>数据分析过程-2</td>
<td>案例研究-1&amp;案例研究-2</td>
</tr>
<tr>
<td><strong>第3周</strong></td>
<td><strong>完成项目</strong></td>
<td><strong>项目：探索数据集</strong></td>
</tr>
<tr>
<td>第4周</td>
<td>项目修改与通过</td>
<td>修改项目、查缺补漏、休息调整</td>
</tr>
</tbody></table>
<p><font size = '3' color = 'red'><strong>！！看这里！！</strong>：在P3课程里面安排了SQL的高阶课程，但是因为在项目三中并不会涉及到SQL知识，所以为了保证大家学习的连贯性，在完成前两周的课程之后，就开始项目。至于<strong>！！SQL的高阶知识，大家可以放在课程通关后进行选修！！</strong>； </font></p>
<p>本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/百度搜索、<a target="_blank" rel="noopener" href="http://www.runoob.com/python3/python3-tutorial.html">菜鸟教程</a>、<a target="_blank" rel="noopener" href="https://www.csdn.net/">CSDN</a>、<a target="_blank" rel="noopener" href="https://stackoverflow.com/">stack<strong>overflow</strong></a>、<a target="_blank" rel="noopener" href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/Python%20for%20Data%20Analysis%2C%202nd%20Edition.pdf"><strong>Python for Data Analysis, 2nd Edition</strong> </a>、<a target="_blank" rel="noopener" href="http://python3-cookbook.readthedocs.io/zh_CN/latest/">Python Cookbook</a></li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p><strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><ul>
<li>在<a target="_blank" rel="noopener" href="https://github.com/udacity/new-dand-basic-china/blob/master/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%A5%E9%97%A8/%E9%A1%B9%E7%9B%AE-%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86/%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86%20-%20%E5%A4%87%E9%80%89%E6%95%B0%E6%8D%AE%E9%9B%86.md">此处</a>挑选和你确认过眼神的数据集，并对其进行数据分析和探索，得出你自己的结论，然后进行提交。</li>
</ul>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody><tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>项目三</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody></table>
<h1 id="项目准备"><a href="#项目准备" class="headerlink" title="项目准备"></a>项目准备</h1><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>强烈建议大家完成本地环境的搭建，在本地完成此项目。搭建本地环境的方法请参考<a target="_blank" rel="noopener" href="https://classroom.udacity.com/nanodegrees/nd002-cn-basic-vip/parts/e566ad37-6119-4448-a6bc-7ade73ef3992">Anaconda的安装与配置</a>一节，完成后你将获得本项目中会用到的关键软件：<strong>Spyder</strong>和<strong>Jupyter Notebook</strong>。</p>
<h2 id="文件准备"><a href="#文件准备" class="headerlink" title="文件准备"></a>文件准备</h2><ul>
<li>项目文件：依次进入到<strong>项目：探索数据集</strong> –&gt; <strong>3.实战项目</strong>中，下载项目文件的ipynb格式。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/Pz6nds"><img src="https://s1.ax1x.com/2018/09/03/Pz6nds.md.png" alt="Pz6nds.md.png"></a></p>
<ul>
<li><p>数据集选择：在<a target="_blank" rel="noopener" href="https://github.com/udacity/new-dand-basic-china/blob/master/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%A5%E9%97%A8/%E9%A1%B9%E7%9B%AE-%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86/%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86%20-%20%E5%A4%87%E9%80%89%E6%95%B0%E6%8D%AE%E9%9B%86.md">此处</a>选择你感兴趣的数据集并下载至与<strong>项目文件相同的文件夹</strong>。（若下载失败，请微信联系我索取）</p>
</li>
<li><p>本地打开：在项目文件的文件夹下，按住<code>Shift</code>键，右击选择<code>在此处打开命令窗口</code>，输入<code>jupyter notebook</code>，待打开本地页面之后，选择项目文件打开，之后就请开始你的表演。</p>
<p><img src="https://ws2.sinaimg.cn/large/9150e4e5ly1fg4xzdddjhj20b407u74k.jpg"></p>
</li>
</ul>
<h2 id="方法准备"><a href="#方法准备" class="headerlink" title="方法准备"></a>方法准备</h2><p>项目文件中已经给大家列好了基本流程，所以请在开始项目之前，一定要<strong>先整体浏览一遍项目文件</strong>，着重看一下：</p>
<ul>
<li>项目流程</li>
<li>每一个流程中你需要做哪些工作</li>
<li>每一个流程中的提示</li>
</ul>
<p>要记得，数据分析过程不是一蹴而就的，是螺旋上升接近目标的过程，所以一定要保持耐心，对照着<a target="_blank" rel="noopener" href="https://review.udacity.com/#!/rubrics/306/view">项目评估准则</a>一步步完成。</p>
<p>另外，一开始你的notebook会显得很乱没有章法，那在<strong>提交之前最好能再修改一个整理好的版本</strong>。</p>
<h1 id="项目流程（TMDb）"><a href="#项目流程（TMDb）" class="headerlink" title="项目流程（TMDb）"></a>项目流程（TMDb）</h1><h2 id="数据集说明"><a href="#数据集说明" class="headerlink" title="数据集说明"></a>数据集说明</h2><p>本项目选择的数据集为Kaggle提供的TMDb电影数据。此数据集中包含 1 万条电影信息，信息来源为“电影数据库”（TMDb，The Movie Database），包括用户评分和票房等。数据已进行了简单清理，涉及到的变量如下表所示：</p>
<table>
<thead>
<tr>
<th align="center">变量名</th>
<th align="center">注释</th>
<th align="center">变量名</th>
<th align="center">注释</th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td align="center">电影序号</td>
<td align="center">keywords</td>
<td align="center">电影关键词</td>
</tr>
<tr>
<td align="center">imdb_id</td>
<td align="center">imdb电影序号</td>
<td align="center">overview</td>
<td align="center">剧情摘要</td>
</tr>
<tr>
<td align="center">popularity</td>
<td align="center">受欢迎程度</td>
<td align="center">runtime</td>
<td align="center">电影时长（min）</td>
</tr>
<tr>
<td align="center">budget</td>
<td align="center">预算（$）</td>
<td align="center">genres</td>
<td align="center">电影风格</td>
</tr>
<tr>
<td align="center">revenue</td>
<td align="center">收入</td>
<td align="center">production_companies</td>
<td align="center">制作公司</td>
</tr>
<tr>
<td align="center">original_title</td>
<td align="center">电影名称</td>
<td align="center">release_date</td>
<td align="center">发布日期(月/日/年)</td>
</tr>
<tr>
<td align="center">cast</td>
<td align="center">演员表</td>
<td align="center">vote_count</td>
<td align="center">评价次数</td>
</tr>
<tr>
<td align="center">homepage</td>
<td align="center">电影网址</td>
<td align="center">vote_average</td>
<td align="center">平均评分</td>
</tr>
<tr>
<td align="center">director</td>
<td align="center">导演</td>
<td align="center">release_year</td>
<td align="center">发布年份</td>
</tr>
<tr>
<td align="center">tagline</td>
<td align="center">宣传词</td>
<td align="center">budget_adj</td>
<td align="center">预算（考虑通胀）</td>
</tr>
<tr>
<td align="center">revenue_adj</td>
<td align="center">收入（考虑通胀）</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
<h2 id="提出问题"><a href="#提出问题" class="headerlink" title="提出问题"></a>提出问题</h2><p>对数据简单浏览之后，你要进行角色扮演了，假如你现在就是一名<strong>电影行业的数据分析师</strong>，通过分析此数据集，你能<strong>为公司提供哪些有用的发现或者规律呢？</strong>或者你只是一名会数据分析的<strong>电影爱好者</strong>，通过分析此数据集，<strong>你能否给小伙伴们推荐一些合适的电影呢？</strong>这里提供几个参考：</p>
<ul>
<li><p>电影类型相关：</p>
<ul>
<li>哪些类型的受欢迎程度最高？随着时间推移有什么变化呢？</li>
<li>随着时间的推移，各类型的数量身上有什么变化呢？</li>
<li>哪些类型赚钱最多？投资收益比呢？</li>
<li>哪些类型拍摄的数量最多？</li>
</ul>
</li>
<li><p>导演相关：</p>
<ul>
<li>哪些导演最能吸金？</li>
<li>哪些导演的电影平均评分最稳定或者最高？</li>
</ul>
</li>
<li><p>制作公司相关：</p>
<ul>
<li>哪些公司最能赚钱？最能赚口碑？评分最稳定或者最高？</li>
</ul>
</li>
<li><p>影响电影评分的要素有哪些？</p>
</li>
<li><p>影响电影收益的要素有哪些？</p>
</li>
<li><p>最近几年的电影都有哪些关键词？</p>
<p>……</p>
</li>
</ul>
<p>整理好你感兴趣的问题后，那就开始吧~</p>
<p>在本示例中，选择的主题为<strong>今晚有空，让好电影与你相伴</strong>，所以我们的目标就是筛选出好看的电影咯~</p>
<h2 id="导入拓展包"><a href="#导入拓展包" class="headerlink" title="导入拓展包"></a>导入拓展包</h2><p>一般来说，就导入如下几个拓展包就够了，当然如果后续操作中还需导入其他包的话，再补充即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用这个框对你计划使用的所有数据包进行设置</span></span><br><span class="line"><span class="comment">#   导入语句。</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="comment"># 务必包含一个‘magic word’，以便将你的视图与 notebook 保持一致。</span></span><br><span class="line">%matplotlib inline</span><br><span class="line"><span class="comment">#关于更多信息，请访问该网页：</span></span><br><span class="line"><span class="comment">#   http://ipython.readthedocs.io/en/stable/interactive/magics.html</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="数据整理"><a href="#数据整理" class="headerlink" title="数据整理"></a>数据整理</h2><h3 id="导入数据"><a href="#导入数据" class="headerlink" title="导入数据"></a>导入数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;tmdb-movies.csv&#x27;</span>)</span><br><span class="line">df.head(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h3 id="评估数据"><a href="#评估数据" class="headerlink" title="评估数据"></a>评估数据</h3><ul>
<li>列及数据类型</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.info()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">pandas</span>.<span class="title">core</span>.<span class="title">frame</span>.<span class="title">DataFrame</span>&#x27;&gt;</span></span><br><span class="line"><span class="class"><span class="title">RangeIndex</span>:</span> <span class="number">10866</span> entries, <span class="number">0</span> to <span class="number">10865</span></span><br><span class="line">Data columns (total <span class="number">21</span> columns):</span><br><span class="line">id                      <span class="number">10866</span> non-null int64</span><br><span class="line">imdb_id                 <span class="number">10856</span> non-null object</span><br><span class="line">popularity              <span class="number">10866</span> non-null float64</span><br><span class="line">budget                  <span class="number">10866</span> non-null int64</span><br><span class="line">revenue                 <span class="number">10866</span> non-null int64</span><br><span class="line">original_title          <span class="number">10866</span> non-null object</span><br><span class="line">cast                    <span class="number">10790</span> non-null object</span><br><span class="line">homepage                <span class="number">2936</span> non-null object</span><br><span class="line">director                <span class="number">10822</span> non-null object</span><br><span class="line">tagline                 <span class="number">8042</span> non-null object</span><br><span class="line">keywords                <span class="number">9373</span> non-null object</span><br><span class="line">overview                <span class="number">10862</span> non-null object</span><br><span class="line">runtime                 <span class="number">10866</span> non-null int64</span><br><span class="line">genres                  <span class="number">10843</span> non-null object</span><br><span class="line">production_companies    <span class="number">9836</span> non-null object</span><br><span class="line">release_date            <span class="number">10866</span> non-null object</span><br><span class="line">vote_count              <span class="number">10866</span> non-null int64</span><br><span class="line">vote_average            <span class="number">10866</span> non-null float64</span><br><span class="line">release_year            <span class="number">10866</span> non-null int64</span><br><span class="line">budget_adj              <span class="number">10866</span> non-null float64</span><br><span class="line">revenue_adj             <span class="number">10866</span> non-null float64</span><br><span class="line">dtypes: float64(<span class="number">4</span>), int64(<span class="number">6</span>), object(<span class="number">11</span>)</span><br><span class="line">memory usage: <span class="number">1.7</span>+ MB</span><br></pre></td></tr></table></figure>

<p>纵然了一下，各列的数据类型没什么问题，唯一一个可能有问题的是<code>release_date</code>列，应该是<code>datetime</code>类型，但因为我们后面的分析中只会用到电影的上映年份，也就是<code>release_year</code>列，所以这列不处理也罢。</p>
<ul>
<li>查看各列的缺失值情况</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.isnull().sum()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">id                         <span class="number">0</span></span><br><span class="line">imdb_id                   <span class="number">10</span></span><br><span class="line">popularity                 <span class="number">0</span></span><br><span class="line">budget                     <span class="number">0</span></span><br><span class="line">revenue                    <span class="number">0</span></span><br><span class="line">original_title             <span class="number">0</span></span><br><span class="line">cast                      <span class="number">76</span></span><br><span class="line">homepage                <span class="number">7930</span></span><br><span class="line">director                  <span class="number">44</span></span><br><span class="line">tagline                 <span class="number">2824</span></span><br><span class="line">keywords                <span class="number">1493</span></span><br><span class="line">overview                   <span class="number">4</span></span><br><span class="line">runtime                    <span class="number">0</span></span><br><span class="line">genres                    <span class="number">23</span></span><br><span class="line">production_companies    <span class="number">1030</span></span><br><span class="line">release_date               <span class="number">0</span></span><br><span class="line">vote_count                 <span class="number">0</span></span><br><span class="line">vote_average               <span class="number">0</span></span><br><span class="line">release_year               <span class="number">0</span></span><br><span class="line">budget_adj                 <span class="number">0</span></span><br><span class="line">revenue_adj                <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>可见数据集的情况很不错，几个关键列几乎没有缺失。至于<code>director</code>列的缺失，你可以依照电影标题去搜索它的导演，然后进行填充，或者干脆直接删除掉。</p>
<ul>
<li>查看重复值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum(df.duplicated())</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>有一行重复数据，过会儿直接清理掉。</p>
<ul>
<li>查看基本数据统计情况</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe()</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/09/04/iSxdmD.png" alt="iSxdmD.png"></p>
<p>因为这是在数据评估阶段，所以着重看min和max，检查是否有异常值。本数据集中没什么问题。</p>
<ul>
<li><p>查看各列元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;column_name&#x27;</span>]</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>可以查看各列的详细情况，避免因为折叠而忽略了某些严重问题。</p>
<p>比如说，我们通过查看各列情况，发现<code>cast</code>、<code>keywords</code>、<code>genres</code>和<code>production_companies</code>这四列中的都包含有以<code>|</code>分隔开的多个平级元素，这在进行之后的按类分析时会非常不便，所以需要清理。（但也不是这四列都要清理，只用清理你的分析中会用到的就行。）</p>
<p> <a target="_blank" rel="noopener" href="https://imgchr.com/i/iSzMgP"><img src="https://s1.ax1x.com/2018/09/04/iSzMgP.png" alt="iSzMgP.png"></a></p>
<p>还有就是<code>budget_adj</code>和<code>revenue_adj</code>两列是科学记数法，在进行可视化的时候，坐标轴的显示肯定就会很丑，到时候要注意处理。</p>
<h3 id="清理数据"><a href="#清理数据" class="headerlink" title="清理数据"></a>清理数据</h3><blockquote>
<p>清理数据就是对上一步中发现的问题进行清理，并且删除无关列，最终得到的是一个方便你进行分析及可视化的干净数据。</p>
<p><strong>清理前记得备份数据</strong></p>
</blockquote>
<ul>
<li><p>数据备份</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_clean = df.copy()</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除无关列</p>
<p>在本次示例项目中，我们的目的是找出好看的电影，所以评分和受欢迎程度是关键参数，然后再探索下他们与其他参数之间是否存在联系。</p>
<p>那就按照如下方法删除一些无关列（其实是筛选出想要的列，顺便再拍一下序）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = df[[<span class="string">&#x27;original_title&#x27;</span>,<span class="string">&#x27;production_companies&#x27;</span>,<span class="string">&#x27;director&#x27;</span>,<span class="string">&#x27;cast&#x27;</span>,<span class="string">&#x27;genres&#x27;</span>,<span class="string">&#x27;keywords&#x27;</span>,<span class="string">&#x27;runtime&#x27;</span>,<span class="string">&#x27;popularity&#x27;</span>,<span class="string">&#x27;vote_count&#x27;</span>,<span class="string">&#x27;vote_average&#x27;</span>,<span class="string">&#x27;release_year&#x27;</span>,<span class="string">&#x27;budget_adj&#x27;</span>,<span class="string">&#x27;revenue_adj&#x27;</span>]]</span><br></pre></td></tr></table></figure>
</li>
<li><p>缺失值的处理</p>
<p>因为关键列并没有出现数据缺失，所以并未进行处理。</p>
</li>
<li><p>删除重复值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.drop_duplicates(inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>genres</code>列处理</p>
<p>电影类型是关键筛选条件，所以要细分。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将genres列转为str格式（因为NaN是float格式的）</span></span><br><span class="line">df_clean.genres = df_clean.genres.astype(str)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取所有的电影类型</span></span><br><span class="line">genres_set = set()   <span class="comment">#定义空集合</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> df_clean[<span class="string">&#x27;genres&#x27;</span>]:</span><br><span class="line">    genres_set.update(x.split(<span class="string">&#x27;|&#x27;</span>)) </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#从genres_set中删除nan</span></span><br><span class="line">genres_set.remove(<span class="string">&#x27;nan&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将各电影类型作为列添加到数据集中,并用1表示‘是’，0表示‘否’</span></span><br><span class="line"><span class="keyword">for</span> genres <span class="keyword">in</span> genres_set:</span><br><span class="line">    df_clean[genres] = df_clean[<span class="string">&#x27;genres&#x27;</span>].str.contains(genres).apply(<span class="keyword">lambda</span> x:<span class="number">1</span> <span class="keyword">if</span> x <span class="keyword">else</span> <span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除genres列，并检查</span></span><br><span class="line">df_clean.drop(<span class="string">&#x27;genres&#x27;</span>,axis = <span class="number">1</span>,inplace = <span class="literal">True</span>)</span><br><span class="line">df_clean.head(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>production_companies</code>列处理</p>
<p>属于电影的参考列，所以我们只筛选首公司。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#只筛选第一家主要投资的公司</span></span><br><span class="line">df_clean.production_companies = df_clean.production_companies.str.split(<span class="string">&#x27;|&#x27;</span>).str[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#为了符合逻辑，更改列名</span></span><br><span class="line">df_clean.rename(columns = &#123;<span class="string">&#x27;production_companies&#x27;</span>:<span class="string">&#x27;production_company&#x27;</span>&#125;,inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>cast</code>列处理</p>
<p>演员也是电影的参考列，只筛选出两名主演。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#筛选前两位主演</span></span><br><span class="line">df_clean[<span class="string">&#x27;major_actor_1&#x27;</span>] = df_clean.cast.str.split(<span class="string">&#x27;|&#x27;</span>).str[<span class="number">0</span>]</span><br><span class="line">df_clean[<span class="string">&#x27;major_actor_2&#x27;</span>] = df_clean.cast.str.split(<span class="string">&#x27;|&#x27;</span>).str[<span class="number">1</span>]</span><br><span class="line"><span class="comment">#删除cast列</span></span><br><span class="line">df_clean.drop(<span class="string">&#x27;cast&#x27;</span>,axis = <span class="number">1</span>,inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加<code>income_adj</code>列</p>
<p>原数据中只有<code>budget_adj</code>和<code>revenue_adj</code>列，后者减去前者即为电影的收益。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_clean[<span class="string">&#x27;income_adj&#x27;</span>] = df_clean[<span class="string">&#x27;revenue_adj&#x27;</span>] - df_clean[<span class="string">&#x27;budget_adj&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>至此，清理数据告一段落。</p>
</li>
</ul>
<h2 id="探索性数据分析"><a href="#探索性数据分析" class="headerlink" title="探索性数据分析"></a>探索性数据分析</h2><p>在这个阶段你可以随意做可视化，尽可能多得去探索你想解决的问题。<strong>在探索阶段，作图可以不用很规范，你自己知道是什么意思就可以</strong>，而且可能会有些探索的问题结果意义不大，所以<strong>在提交项目时，要进行择优保留并对其润色修饰</strong>。</p>
<h3 id="探索受欢迎程度及评分"><a href="#探索受欢迎程度及评分" class="headerlink" title="探索受欢迎程度及评分"></a>探索受欢迎程度及评分</h3><p>电影的受欢迎程度和平均评分是我们在进行电影推荐时的主要参考，所以我们先来观察下这两列的主要分布情况以及与其他列的相关性。</p>
<ul>
<li>分布情况</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#受欢迎程度的分布情况</span></span><br><span class="line">df_clean[<span class="string">&#x27;popularity&#x27;</span>].plot(kind = <span class="string">&#x27;hist&#x27;</span>,bins = <span class="number">200</span>,title = <span class="string">&#x27;The Distribution of Popularity(log)&#x27;</span>,logx = <span class="literal">True</span>,figsize = (<span class="number">8</span>,<span class="number">6</span>))<span class="comment">#这里采用了x轴的对数坐标，考虑下为什么呢？</span></span><br><span class="line">plt.ylabel(<span class="string">&#x27;Count of Movies&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Popularity(log)&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/ipxy2q"><img src="https://s1.ax1x.com/2018/09/05/ipxy2q.png" alt="ipxy2q.png"></a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#平均评分的分布情况</span></span><br><span class="line">df_clean[<span class="string">&#x27;vote_average&#x27;</span>].plot(kind = <span class="string">&#x27;hist&#x27;</span>,bins = <span class="number">30</span>,title = <span class="string">&#x27;The Distribution of Average Rating&#x27;</span>,figsize = (<span class="number">8</span>,<span class="number">6</span>))<span class="comment">#这里就是用的普通的x轴坐标，为什么呢？</span></span><br><span class="line">plt.ylabel(<span class="string">&#x27;Count of Movies&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Average Rating&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/ipx7xx"><img src="https://s1.ax1x.com/2018/09/05/ipx7xx.png" alt="ipx7xx.png"></a></p>
<p>通过观察这两幅图我们可以发现：绝大部分的电影受欢迎程度都在10以下，平均评分却是一个类正态分布，电影评分集中在5到7之间。</p>
<ul>
<li><p>与上映年份的关系</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#受欢迎程度</span></span><br><span class="line">df_clean.groupby(<span class="string">&#x27;release_year&#x27;</span>)[<span class="string">&#x27;popularity&#x27;</span>].mean().plot(kind = <span class="string">&#x27;line&#x27;</span>)</span><br><span class="line">plt.hlines(df_clean[<span class="string">&#x27;popularity&#x27;</span>].quantile(<span class="number">.75</span>),xmin = <span class="number">1960</span>,xmax = <span class="number">2015</span>,color = <span class="string">&#x27;red&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/ipz9zt"><img src="https://s1.ax1x.com/2018/09/05/ipz9zt.png" alt="ipz9zt.png"></a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#评分</span></span><br><span class="line">df_clean.groupby(<span class="string">&#x27;release_year&#x27;</span>)[<span class="string">&#x27;vote_average&#x27;</span>].mean().plot(kind = <span class="string">&#x27;line&#x27;</span>)</span><br><span class="line">plt.hlines(df_clean[<span class="string">&#x27;vote_average&#x27;</span>].quantile(<span class="number">.75</span>),xmin = <span class="number">1960</span>,xmax = <span class="number">2015</span>,color = <span class="string">&#x27;red&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/ipzpRI"><img src="https://s1.ax1x.com/2018/09/05/ipzpRI.png" alt="ipzpRI.png"></a></p>
</li>
</ul>
<p>通过观察这两幅可视化，我们发现：随着上映日期逐渐接近现在，受欢迎程度呈波动上升趋势，但是评分却是波动下降。这应该是因为年代越久远的电影观看人数越少，评分次数也就越少（需附图验证），个别的高评分对平均评分的影响也就越大，这才导致了受欢迎程度低却评分高的现象。</p>
<ul>
<li>与其他数值型变量的关系</li>
</ul>
<p>本数据集中的数值型变量不是很多，但要是一对一对的去看他们之间的相关性会很累，<del>懒人</del>智者推动科技进步嘛，前辈们帮我们都考虑好了，可以参考下面的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#筛选出数值变量</span></span><br><span class="line">df_corr = df_clean[[<span class="string">&#x27;runtime&#x27;</span>,<span class="string">&#x27;popularity&#x27;</span>,<span class="string">&#x27;vote_count&#x27;</span>,<span class="string">&#x27;vote_average&#x27;</span>,<span class="string">&#x27;budget_adj&#x27;</span>,<span class="string">&#x27;revenue_adj&#x27;</span>,<span class="string">&#x27;income_adj&#x27;</span>]]</span><br></pre></td></tr></table></figure>

<p><strong>各变量之间相关性的热度图</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots(figsize=(<span class="number">10</span>, <span class="number">6</span>)) </span><br><span class="line">corr = df_corr.corr() <span class="comment">#计算相关性</span></span><br><span class="line">hm = sns.heatmap(round(corr,<span class="number">2</span>), annot=<span class="literal">True</span>, ax=ax, cmap=<span class="string">&quot;coolwarm&quot;</span>,fmt=<span class="string">&#x27;.2f&#x27;</span>, linewidths=<span class="number">.05</span>) </span><br><span class="line">fig.subplots_adjust(top=<span class="number">0.93</span>) </span><br><span class="line">fig.suptitle(<span class="string">&#x27;Movie Attributes Correlation Heatmap&#x27;</span>, fontsize=<span class="number">14</span>);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/i97tOJ"><img src="https://s1.ax1x.com/2018/09/06/i97tOJ.png" alt="i97tOJ.png"></a></p>
<p>从这幅图里面，可以很明显的读出一些信息：</p>
<ul>
<li>受欢迎程度与评分人数有较强的正相关关系，与收益的正相关程度也稍强，这很好理解；</li>
<li>平均评分却鲜有相关的变量，那影响评分的因素都有哪些呢？（导演？主演？制片公司？）</li>
</ul>
<p><strong>pairplot</strong></p>
<p>你不满足于只看冷冰冰的数字，想看到更直观的散点图或者直方图，那就请参考如下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pp = sns.pairplot(df_corr, size=<span class="number">1.8</span>, aspect=<span class="number">1.8</span>, plot_kws=dict(edgecolor=<span class="string">&quot;k&quot;</span>, linewidth=<span class="number">0.5</span>), diag_kind=<span class="string">&quot;kde&quot;</span>, diag_kws=dict(shade=<span class="literal">True</span>)) </span><br><span class="line">fig = pp.fig </span><br><span class="line">fig.subplots_adjust(top=<span class="number">0.93</span>, wspace=<span class="number">0.3</span>) </span><br><span class="line">t = fig.suptitle(<span class="string">&#x27;Movie Attributes Pairwise Plots&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/09/06/i9HinJ.png" alt="i9HinJ.png"></p>
<p>从上面这幅可视化中，我们不仅能看到各变量两两之间的散点图（相关性），还能看到各变量的分布情况，真可谓是大杀器。</p>
<p>那，热度与评分和其他分类变量有没有什么关系呢？</p>
<p>…（请继续探索）</p>
<p>… KEEP GOING</p>
<h3 id="电影推荐"><a href="#电影推荐" class="headerlink" title="电影推荐"></a>电影推荐</h3><p>在做电影推荐时，受欢迎程度和评分是我们的关键评估指标。</p>
<ul>
<li>按电影类型推荐</li>
</ul>
<p>比如说，你有一个哥们比较喜欢看<code>Adventure</code>类的电影，听说你在做TMDb的电影数据分析，所以来找你推荐，你会推荐哪些呢？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#首先我们要筛选出Adventure类的电影</span></span><br><span class="line">df_Ad = df_clean[df_clean[<span class="string">&#x27;Adventure&#x27;</span>] == <span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#既然是推荐，自然要筛选一些热门的评分高的电影，所以这里我们选择了好于其他90%的电影（结果为15部电影）</span></span><br><span class="line">df_Ad_po = df_Ad[df_Ad.popularity &gt; df_Ad.popularity.quantile(<span class="number">.9</span>)]</span><br><span class="line">df_Ad_po_vo = df_Ad_po[df_Ad_po.vote_average &gt; df_Ad_po.vote_average.quantile(<span class="number">.9</span>)]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#排序</span></span><br><span class="line">df_Ad_po_vo.sort_values(by = <span class="string">&#x27;popularity&#x27;</span>,inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可视化</span></span><br><span class="line">sns.set(style=<span class="string">&quot;white&quot;</span>)<span class="comment">#小美化一下</span></span><br><span class="line"></span><br><span class="line">x = df_Ad_po_vo.original_title</span><br><span class="line">y = df_Ad_po_vo[<span class="string">&#x27;popularity&#x27;</span>]</span><br><span class="line"><span class="comment">#排序能让可视化更美观</span></span><br><span class="line">plt.yticks(np.arange(len(x)), x)</span><br><span class="line">plt.barh(np.arange(len(x)),y);</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/09/05/i9kJRe.png" alt="i9kJRe.png"></p>
<p>结论立马就出来了，首推的电影就是Interstellar（星际穿越）。当然这种方法可以定义成一个函数，参数即为<code>电影类型</code>，这样就能省心省力的得到所有电影的最热最佳推荐了。</p>
<p>当然，你还可以尝试：</p>
<ul>
<li><p>按导演推荐</p>
<p> 我一开始想着用groupby直接按照导演分类，然后求评分的均值再作图，可是结果并不如人意。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_clean.groupby(<span class="string">&#x27;director&#x27;</span>)[<span class="string">&#x27;vote_average&#x27;</span>].mean().sort_values()[<span class="number">-15</span>:].plot(kind = <span class="string">&#x27;barh&#x27;</span>,color = <span class="string">&#x27;b&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/09/06/iCNGXd.png" alt="iCNGXd.png"></p>
<p>这些导演好像都不是很熟悉，应该是数据集中只收录了一部或者很少的电影作品，然而又因为这些作品的评分较高，才导致这种情况，所以我们要先对导演做一个筛选，比如说，筛选出收入作品数量在10部及以上的导演。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#先对原数据中的director列作计数统计，然后筛选大于等于10的数据存为一个新的DataFrame（目的是为了方便筛选）</span></span><br><span class="line">df_director = pd.DataFrame(df_clean.director.value_counts() &gt;= <span class="number">10</span>)</span><br><span class="line"><span class="comment">#将10部及以上作品的导演存为一个列表</span></span><br><span class="line">directors = list(df_director[df_director[<span class="string">&#x27;director&#x27;</span>]].index)</span><br><span class="line"><span class="comment">#然后使用isin函数，筛选原数据中在directors列表中的导演，并求均值作图</span></span><br><span class="line"><span class="comment">#平均评分</span></span><br><span class="line">df_clean[df_clean.director.isin(directors)].groupby(<span class="string">&#x27;director&#x27;</span>)[<span class="string">&#x27;vote_average&#x27;</span>].mean().sort_values()[<span class="number">-10</span>:].plot(kind = <span class="string">&#x27;barh&#x27;</span>,color = <span class="string">&#x27;b&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/09/06/iCUhVI.png" alt="iCUhVI.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#受欢迎程度</span></span><br><span class="line">df_clean[df_clean.director.isin(directors)].groupby(<span class="string">&#x27;director&#x27;</span>)[<span class="string">&#x27;popularity&#x27;</span>].mean().sort_values()[<span class="number">-10</span>:].plot(kind = <span class="string">&#x27;barh&#x27;</span>,color = <span class="string">&#x27;b&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/09/06/iCUWqA.png" alt="iCUWqA.png"></p>
<p>这次得到的结果更大众一些，出现的导演名字也基本都听过。Christopher Nolan和Quentin分别获得了双料榜首和榜眼，这两个人的名字也算是电影的品质保证了吧。</p>
<ul>
<li><p>按主演推荐</p>
</li>
<li><p>按制片公司推荐</p>
<p> … …</p>
</li>
</ul>
<p>当然，你还可以分析电影评分与其他变量的相关性，或者从效益角度出发，去分析票房、预算、收益等等。但万变不离其宗，用数据分析的流程做指导，所学知识为基础，Bing或者Google为利剑（搜索的时间可能要占到一半以上，所以不要慌，搜索完记在小本本上），开始你的项目三征服之路吧！</p>
<h2 id="得出结论"><a href="#得出结论" class="headerlink" title="得出结论"></a>得出结论</h2><p>对你整理好的可视化图像进行总结，结论要有根有据但也不要只是停留在<code>描述</code>，可以进行适当的猜测。</p>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><ul>
<li>导学只是参考和分享，我是还原了自己在做项目时的思路历程，这并不是提交项目时应有的样子。</li>
<li>记得提交前一定要再重新审视一遍，调整代码，注释，修缮可视化及结论。</li>
<li>经过P3的历练，相信你能更自信，也更能有成就感，坚持！！</li>
<li>加油！！！</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.capallen.top/2018/Matplotlib%E5%8F%AF%E8%A7%86%E5%8C%96.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Allen Jia">
      <meta itemprop="description" content="数据 算法 分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Allen's Blog">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/Matplotlib%E5%8F%AF%E8%A7%86%E5%8C%96.html" class="post-title-link" itemprop="url">每周导学-第七周-Matplotlib可视化</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-08-28 12:30:09" itemprop="dateCreated datePublished" datetime="2018-08-28T12:30:09+08:00">2018-08-28</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2019-06-06 11:27:43" itemprop="dateModified" datetime="2019-06-06T11:27:43+08:00">2019-06-06</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a>
        </span>
    </span>

  
    <span id="/2018/Matplotlib%E5%8F%AF%E8%A7%86%E5%8C%96.html" class="post-meta-item leancloud_visitors" data-flag-title="每周导学-第七周-Matplotlib可视化" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/Matplotlib%E5%8F%AF%E8%A7%86%E5%8C%96.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/Matplotlib%E5%8F%AF%E8%A7%86%E5%8C%96.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>If you don’t like where you are , change it. You’re not a tree.</p>
</blockquote>
<p>Hi，同学们，上一周我们学习了数据分析的基本流程，以及Pandas在数据分析各个流程中的应用，本周呢就是在上周的基础上，掌握Python数据分析可视化的基础知识，包括<strong>matplotlib</strong>及<strong>pandas可视化</strong>。可视化是数据分析的重要环节，是你进行探索性数据分析、得出结论、传达结果的关键，所以，一定的可视化技巧是非常必须的，除了本章涉及到的两个知识点外，我还会在最后提供一些其他的python可视化库链接和其他可视化软件的链接，希望大家能不满足于导学，而去积极求索，加油！！</p>
<p>本周开始，我们就进入到了<strong>项目三(P3)阶段</strong>，本阶段总共包含<strong>四周</strong>，在这一个月内，我们要对<strong>数据分析入门</strong>进行学习，学习数据分析思维，掌握Python数据分析及可视化方法，并使用所学知识完成<strong>项目三：探索数据集</strong>，尝试着自己完成整个数据分析的流程，得到一些饶有兴趣的结论，你一定会非常有成就感哒！那么以下便是这四周的学习安排：</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody><tr>
<td>第1周</td>
<td>数据分析过程-1</td>
<td>数据分析过程&amp;案例研究-1</td>
</tr>
<tr>
<td><strong>第2周</strong></td>
<td><strong>数据分析过程-2</strong></td>
<td><strong>案例研究-1&amp;案例研究-2</strong></td>
</tr>
<tr>
<td>第3周</td>
<td>完成项目</td>
<td>项目：探索数据集</td>
</tr>
<tr>
<td>第4周</td>
<td>项目修改与通过</td>
<td>修改项目、查缺补漏、休息调整</td>
</tr>
</tbody></table>
<p><font size = '3' color = 'red'><strong>！！看这里！！</strong>：在P3课程里面安排了SQL的高阶课程，但是因为在项目三中并不会涉及到SQL知识，所以为了保证大家学习的连贯性，在完成前两周的课程之后，就开始项目。至于<strong>！！SQL的高阶知识，大家可以放在课程通关后进行选修！！</strong>； </font></p>
<p>本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/百度搜索、<a target="_blank" rel="noopener" href="http://www.runoob.com/python3/python3-tutorial.html">菜鸟教程</a>、<a target="_blank" rel="noopener" href="https://www.csdn.net/">CSDN</a>、<a target="_blank" rel="noopener" href="https://stackoverflow.com/">stack<strong>overflow</strong></a>、<a target="_blank" rel="noopener" href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/Python%20for%20Data%20Analysis%2C%202nd%20Edition.pdf"><strong>Python for Data Analysis, 2nd Edition</strong> </a>、<a target="_blank" rel="noopener" href="http://python3-cookbook.readthedocs.io/zh_CN/latest/">Python Cookbook</a></li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p><strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><ul>
<li>学习总结课程中<strong>数据分析过程</strong>及<strong>案例研究1&amp;2</strong>中所用到的可视化知识，掌握可视化在数据分析中的应用。</li>
</ul>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody><tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>案例研究1&amp;2</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody></table>
<h1 id="本周知识清单"><a href="#本周知识清单" class="headerlink" title="本周知识清单"></a>本周知识清单</h1><h1 id="matplotlib"><a href="#matplotlib" class="headerlink" title="matplotlib"></a>matplotlib</h1><p>matplotlib是Python泰斗级别的绘图库，因受到Matlab的启发构建而成，所以你会觉得它的命令API，还有那九十年代感强烈的可视化图像跟matlab很相似。它非常适合在jupyter notebook中交互式作图，这个库“功能非常强大”，但也“非常复杂”，所以这里只能介绍matplotlib的一些基础和常用的方法，想了解更多就需要你自主探索啦！</p>
<ul>
<li>导入matplotlib</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>

<ul>
<li>在notebook中使用</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#想在Jupyter Notebook中顺利显示出可视化图像，你需要添加如下代码</span></span><br><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure>

<h2 id="官方链接"><a href="#官方链接" class="headerlink" title="官方链接"></a>官方链接</h2><p>你可以点击<a target="_blank" rel="noopener" href="https://matplotlib.org/api/pyplot_summary.html">matplotlib.pyplot</a>搜索查看一些函数的说明和用法；或者你可以点击<a target="_blank" rel="noopener" href="https://matplotlib.org/gallery/index.html#pyplot">Pyplot Gallery</a>查看一些代码实例，找到灵感。</p>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p>在使用matplotlib生成图像时，整个图像为一个Figure对象。在Figure对象中可以包含一个，或者多个Axes对象。每个Axes对象都是一个拥有自己坐标系统的绘图区域。其逻辑关系如下：</p>
<p><img src="https://s1.ax1x.com/2018/08/24/P7zm2n.jpg" alt="P7zm2n.jpg"></p>
<p>在如下的单图fig中，我们给出了我们的绘图中只有一个坐标系区域（也就是ax），此外还有以下对象：</p>
<ul>
<li>Data: 数据区，包括数据点、描绘形状</li>
<li>Axis: 坐标轴，包括 X 轴、 Y 轴及其标签、刻度尺及其标签</li>
<li>Title: 标题，数据图的描述</li>
<li>Legend: 图例，区分图中包含的多种曲线或不同分类的数据</li>
<li>其他的还有图形文本 (Text)、注解 (Annotate)等其他描述</li>
</ul>
<p><img src="https://s1.ax1x.com/2018/08/24/P7zQbT.jpg" alt="P7zQbT.jpg"></p>
<p>各个对象之间的隶属关系如下图所示：</p>
<p><img src="https://s1.ax1x.com/2018/08/24/P7zMrV.jpg" alt="P7zMrV.jpg"></p>
<p>所以大家在之后进行可视化的时候，根据这些隶属关系来去对参数进行设置，这样逻辑不乱，代码也清晰。</p>
<h2 id="常用参数设置"><a href="#常用参数设置" class="headerlink" title="常用参数设置"></a>常用参数设置</h2><h3 id="开始绘图"><a href="#开始绘图" class="headerlink" title="开始绘图"></a>开始绘图</h3><p>在绘图前，首先需要设置的就是fig(画布)和ax(图)，我们主要通过plt.subplots()函数来定义</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#绘制单图</span></span><br><span class="line">fig, ax = plt.subplots()</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/Pbp9aT"><img src="https://s1.ax1x.com/2018/08/25/Pbp9aT.png" alt="Pbp9aT.png"></a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#绘制多图，subplots的第一个参数为行数，第二个参数为列数</span></span><br><span class="line">fig,(ax1,ax2) = plt.subplots(<span class="number">1</span>,<span class="number">2</span>,sharey = <span class="literal">True</span>)<span class="comment">#设置共享y轴</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/PbSzq0"><img src="https://s1.ax1x.com/2018/08/25/PbSzq0.png" alt="PbSzq0.png"></a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#绘制多图时，注意前面的变量为一个矩阵的形式，如下前面为2x2矩阵，则后面subplots的行列参数也应该都为2</span></span><br><span class="line">fig,((ax1,ax2),(ax3,ax4)) = plt.subplots(<span class="number">2</span>,<span class="number">2</span>,sharex = <span class="literal">True</span>)<span class="comment">#设置共享x轴</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/PbppZV"><img src="https://s1.ax1x.com/2018/08/25/PbppZV.png" alt="PbppZV.png"></a></p>
<h3 id="另一种添加子图的方法"><a href="#另一种添加子图的方法" class="headerlink" title="另一种添加子图的方法"></a>另一种添加子图的方法</h3><p>绘制子图主要使用的函数为：add_subplot(abc)，调用该函数会生成一个包含axb个子图的画布，而c则表示位置，按照从左至右，从上至下的顺序依次排列。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x &#x3D; np.arange(1,100)</span><br><span class="line"></span><br><span class="line">fig &#x3D; plt.figure() #定义画布</span><br><span class="line">ax1 &#x3D; fig.add_subplot(221) # 定义2*2个子图（1表示左一）</span><br><span class="line">ax1.plot(x,x) # 绘制左一折线图</span><br><span class="line"></span><br><span class="line">ax2 &#x3D; fig.add_subplot(222)</span><br><span class="line">ax2.plot(x,-x) # 绘制右一折线图（右一）</span><br><span class="line"></span><br><span class="line">ax3 &#x3D; fig.add_subplot(223)</span><br><span class="line">ax3.plot(x,x*x) # 绘制左二折线图（左二）</span><br><span class="line"></span><br><span class="line">ax4 &#x3D; fig.add_subplot(224)</span><br><span class="line">ax4.plot(x,np.log(x)); # 绘制右二折线图（右二），添加分号可以只显示图像</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/24/PHCqtU.png" alt="PHCqtU.png"></p>
<h3 id="坐标轴设置"><a href="#坐标轴设置" class="headerlink" title="坐标轴设置"></a>坐标轴设置</h3><ul>
<li><p>调整范围</p>
<p>主要是用来利用调整坐标轴范围进行图像的截取，可以使用ax.axis()函数，也可使用plt.xlim()或者plt.ylim()函数，具体用法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ax.axis([0,10,0,50]) [x左，x右，y下，y上]</span></span><br><span class="line">x = np.arange(<span class="number">-10</span>,<span class="number">10</span>,<span class="number">0.1</span>)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax.plot(x,x**<span class="number">2</span>)</span><br><span class="line">ax.axis([<span class="number">0</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">50</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#plt.xlim([0,10]) ，调整x轴坐标范围</span></span><br><span class="line"><span class="comment">#plt.ylim([0,50]) ，调整y轴坐标范围</span></span><br><span class="line">fig1 = plt.figure()</span><br><span class="line">ax1 = fig1.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax1.plot(x,x**<span class="number">2</span>)</span><br><span class="line">plt.xlim([<span class="number">0</span>,<span class="number">10</span>])</span><br><span class="line">plt.ylim([<span class="number">0</span>,<span class="number">50</span>]);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/PHO6UJ"><img src="https://s1.ax1x.com/2018/08/25/PHO6UJ.png" alt="PHO6UJ.png"></a><br><a target="_blank" rel="noopener" href="https://imgchr.com/i/PHOyE4"><img src="https://s1.ax1x.com/2018/08/25/PHOyE4.png" alt="PHOyE4.png"></a></p>
</li>
<li><p>坐标轴刻度调整</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#利用ax.locator_params()设置刻度间隔</span></span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">0</span>,<span class="number">11</span>,<span class="number">0.1</span>)</span><br><span class="line">fig1 = plt.figure()</span><br><span class="line">ax1  = fig1.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax1.plot(x,x)</span><br><span class="line"><span class="comment">#ax1.locator_params(nbins=20) #同时调整x轴与y轴</span></span><br><span class="line"><span class="comment">#ax1.locator_params(&#x27;x&#x27;,nbins=20) #只调整x轴</span></span><br><span class="line">ax1.locator_params(<span class="string">&#x27;y&#x27;</span>,nbins=<span class="number">20</span>) <span class="comment">#只调整y轴</span></span><br><span class="line">plt.axis([<span class="number">0</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">10</span>]);</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/25/PHv3DK.png" alt="PHv3DK.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#利用plt.xticks()设置x轴刻度顺序/旋转角度</span></span><br><span class="line">plt.xticks([<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">4</span>], [<span class="string">&#x27;Tom&#x27;</span>, <span class="string">&#x27;Dick&#x27;</span>, <span class="string">&#x27;Harry&#x27;</span>, <span class="string">&#x27;Sally&#x27;</span>, <span class="string">&#x27;Sue&#x27;</span>],  rotation=<span class="number">30</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/25/PHvH54.png" alt="PHvH54.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#时间刻度调整</span></span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"></span><br><span class="line">start = datetime.datetime(<span class="number">2018</span>,<span class="number">7</span>,<span class="number">1</span>)</span><br><span class="line">stop  = datetime.datetime(<span class="number">2018</span>,<span class="number">8</span>,<span class="number">1</span>)</span><br><span class="line">delta = datetime.timedelta(days=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">dates = mpl.dates.drange(start,stop,delta)</span><br><span class="line">y = np.random.rand(len(dates))</span><br><span class="line"></span><br><span class="line">fig2 = plt.figure()</span><br><span class="line">ax2  = fig2.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax2.plot_date(dates,y,linestyle=<span class="string">&#x27;-&#x27;</span>,marker=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#日期格式调整，关键代码</span></span><br><span class="line">date_format= mpl.dates.DateFormatter(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line">ax2.xaxis.set_major_formatter(date_format)</span><br><span class="line">fig2.autofmt_xdate();<span class="comment">#防止刻度重叠</span></span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/25/PHxRoD.png" alt="PHxRoD.png"></p>
</li>
<li><p>双轴</p>
<p>有时候想要在同一张图中显示两种不同范围的变量，这时候就要设置双轴</p>
<p>双轴的关键代码为twinx()函数（也就是双胞胎x轴？）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x &#x3D; np.arange(1,11,0.1)</span><br><span class="line">y1 &#x3D; x*x</span><br><span class="line">y2 &#x3D; np.log(x)</span><br><span class="line"></span><br><span class="line">fig1 &#x3D; plt.figure()</span><br><span class="line">ax1 &#x3D; fig1.add_subplot(111)</span><br><span class="line">plt.ylabel(&#39;Y1&#39;)</span><br><span class="line">ax2 &#x3D; ax1.twinx()#关键代码</span><br><span class="line">plt.ylabel(&#39;Y2&#39;,rotation&#x3D;270)#注意添加ylabel的顺序不能错，旋转显示</span><br><span class="line"></span><br><span class="line">ax1.plot(x,y1)</span><br><span class="line">ax2.plot(x,y2,&#39;--r&#39;);</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/25/PbpYLt.png" alt="PbpYLt.png"></p>
</li>
</ul>
<h3 id="标题与轴标题"><a href="#标题与轴标题" class="headerlink" title="标题与轴标题"></a>标题与轴标题</h3><p>标题与轴标题都是一幅可视化图像中的必须要素。你可以参考如下示例来设置你的标题与轴标题。</p>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">plt.title(<span class="string">&#x27;This is title&#x27;</span>,color = <span class="string">&#x27;r&#x27;</span>,fontsize = <span class="number">17</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;This is xlabel&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;This is ylabel&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">##其等效于：</span></span><br><span class="line"><span class="comment"># fig,ax = plt.subplots()</span></span><br><span class="line"><span class="comment"># ax.set_title(&#x27;This is title&#x27;,color = &#x27;r&#x27;,fontsize = 17)</span></span><br><span class="line"><span class="comment"># ax.set_xlabel(&#x27;This is xlabel&#x27;)</span></span><br><span class="line"><span class="comment"># ax.set_ylabel(&#x27;This is xlabel&#x27;);</span></span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/28/PLvbp4.png" alt="PLvbp4.png"></p>
<h3 id="图例"><a href="#图例" class="headerlink" title="图例"></a>图例</h3><p>图例在进行多变量比较的可视化中必不可少。你可以通过在plot()函数中添加参数’label’来对所绘曲线设置图例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(<span class="number">1</span>,<span class="number">11</span>,<span class="number">1</span>)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">line1 = ax.plot(x,x*<span class="number">2</span>,label=<span class="string">&#x27;Bad&#x27;</span>)</span><br><span class="line">line2 = ax.plot(x,x*<span class="number">3</span>,label=<span class="string">&#x27;Normal&#x27;</span>)</span><br><span class="line">line3 = ax.plot(x,x*<span class="number">4</span>,label=<span class="string">&#x27;Good&#x27;</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;best&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/PLKnTU"><img src="https://s1.ax1x.com/2018/08/27/PLKnTU.png" alt="PLKnTU.png"></a></p>
<p>也可以通过调用plt.legend()函数对图例进行设置。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(<span class="number">1</span>,<span class="number">11</span>,<span class="number">1</span>)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">line1, = ax.plot(x,x*<span class="number">2</span>) <span class="comment">#注意line1后面的逗号,不可缺少</span></span><br><span class="line">line2, = ax.plot(x,x*<span class="number">3</span>)</span><br><span class="line">line3, = ax.plot(x,x*<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">plt.legend(handles = [line1, line2, line3],labels = [<span class="string">&#x27;Bad&#x27;</span>, <span class="string">&#x27;Normal&#x27;</span>, <span class="string">&#x27;Good&#x27;</span>],loc = <span class="string">&#x27;best&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/PLKmwT"><img src="https://s1.ax1x.com/2018/08/27/PLKmwT.png" alt="PLKmwT.png"></a></p>
<h3 id="颜色与样式"><a href="#颜色与样式" class="headerlink" title="颜色与样式"></a>颜色与样式</h3><p>调用matplotlib.pyplot.plot函数即可设置所画图像的颜色与样式，设置方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(x,y,&#39;[color][marker][line]&#39;)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>常用颜色</p>
<table>
<thead>
<tr>
<th>字符</th>
<th>颜色</th>
<th>字符</th>
<th>颜色</th>
</tr>
</thead>
<tbody><tr>
<td>b</td>
<td>蓝色</td>
<td>g</td>
<td>绿色</td>
</tr>
<tr>
<td>r</td>
<td>红色</td>
<td>y</td>
<td>黄色</td>
</tr>
<tr>
<td>c</td>
<td>青色</td>
<td>k</td>
<td>黑色</td>
</tr>
<tr>
<td>m</td>
<td>洋红色</td>
<td>w</td>
<td>白色</td>
</tr>
<tr>
<td>#rrggbb</td>
<td>RGB颜色</td>
<td>0.7</td>
<td>灰度值</td>
</tr>
</tbody></table>
</li>
<li><p>常用线条样式</p>
<table>
<thead>
<tr>
<th>字符</th>
<th>描述</th>
<th>字符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>‘-‘</td>
<td>实线</td>
<td>‘:’</td>
<td>虚线(·······)</td>
</tr>
<tr>
<td>‘–’</td>
<td>虚线(——)</td>
<td>‘None’或’ ‘或’’</td>
<td>什么都不画</td>
</tr>
<tr>
<td>‘-.’</td>
<td>点划线</td>
<td></td>
<td></td>
</tr>
</tbody></table>
</li>
<li><p>线条标记</p>
<table>
<thead>
<tr>
<th>字符</th>
<th>描述</th>
<th>字符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>‘o’</td>
<td>圆圈</td>
<td>‘.’</td>
<td>点</td>
</tr>
<tr>
<td>‘D’</td>
<td>菱形</td>
<td>‘s’</td>
<td>正方形</td>
</tr>
<tr>
<td>‘h’</td>
<td>六边形1</td>
<td>‘*’</td>
<td>星号</td>
</tr>
<tr>
<td>‘H’</td>
<td>六边形2</td>
<td>‘d’</td>
<td>小菱形</td>
</tr>
<tr>
<td>‘_’</td>
<td>水平线</td>
<td>‘v’</td>
<td>一角朝下的三角形</td>
</tr>
<tr>
<td>‘8’</td>
<td>八边形</td>
<td>‘&lt;’</td>
<td>一角朝左的三角形</td>
</tr>
<tr>
<td>‘p’</td>
<td>五边形</td>
<td>‘&gt;’</td>
<td>一角朝右的三角形</td>
</tr>
<tr>
<td>‘,’</td>
<td>像素</td>
<td>‘^’</td>
<td>一角朝上的三角形</td>
</tr>
<tr>
<td>‘+’</td>
<td>加号</td>
<td>‘\‘</td>
<td>竖线</td>
</tr>
<tr>
<td>‘None’,’’,’ ‘</td>
<td>无</td>
<td>‘x’</td>
<td>X</td>
</tr>
</tbody></table>
</li>
</ul>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fig,ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">y=np.arange(<span class="number">1</span>,<span class="number">5</span>)</span><br><span class="line">ax.plot(y,<span class="string">&#x27;cx--&#x27;</span>)</span><br><span class="line">ax.plot(y+<span class="number">1</span>,<span class="string">&#x27;kp:&#x27;</span>)</span><br><span class="line">ax.plot(y+<span class="number">2</span>,<span class="string">&#x27;mo-.&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/27/PLZy3q.png" alt="PLZy3q.png"></p>
<h3 id="网格"><a href="#网格" class="headerlink" title="网格"></a>网格</h3><p>也就是可视化图像中的网格，可以方便读者快速估取某点的横纵坐标。我们通过调用plt.grid()函数来对启用网格。一般情况下，使用该函数的默认参数即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#采用默认参数</span></span><br><span class="line">x= np.arange(<span class="number">1</span>,<span class="number">10</span>,<span class="number">0.1</span>)</span><br><span class="line">fig1 = plt.figure()</span><br><span class="line">ax1 = fig1.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax1.grid()</span><br><span class="line">ax1.plot(x,np.log(x))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/27/PLZWbF.png" alt="PLZWbF.png"></p>
<p>但你也可以通过如下方式进行设置。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">y = np.arange(<span class="number">1</span>,<span class="number">5</span>,<span class="number">0.1</span>)</span><br><span class="line">plt.plot(y,y**<span class="number">2</span>)</span><br><span class="line">plt.grid(color=<span class="string">&#x27;r&#x27;</span>,linestyle=<span class="string">&#x27;:&#x27;</span>,linewidth=<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"><span class="comment"># color 设置网格的颜色(颜色与样式中的均可用)</span></span><br><span class="line"><span class="comment"># linestyle 设置线显示的类型(一共四种即&#x27;-&#x27;,&#x27;--&#x27;,&#x27;-.&#x27;,&#x27;:&#x27;)</span></span><br><span class="line"><span class="comment"># linewidth 设置网格线宽</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/27/PLeToQ.png" alt="PLeToQ.png"></p>
<h3 id="添加图中注释"><a href="#添加图中注释" class="headerlink" title="添加图中注释"></a>添加图中注释</h3><p>有时候你需要为可视化图中的某个关键点做出注释，方便读者能一眼看出，这时候你就需要调用plt.annote()函数来实现你的目的了。</p>
<p>该函数中几个关键的参数分别为：</p>
<ul>
<li><p>str：一个字符串，来写出你想要标注的内容；</p>
</li>
<li><p>xy：标注点的坐标</p>
</li>
<li><p>xytext：标注内容起始位置的坐标（也就是从该点开始显示你的注释内容）</p>
</li>
<li><p>arrowprops：设置注释指向标注点的箭头</p>
<ul>
<li>facecolor：箭头颜色</li>
<li>width：箭头宽度</li>
<li>headlength：箭头头部长度（单位为磅）</li>
<li>headwidth：箭头头部宽度  </li>
</ul>
</li>
</ul>
<p>你也可以去搜索该函数，获取更多参数的设置方法。</p>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">x =np.arange(<span class="number">-10</span>,<span class="number">11</span>,<span class="number">1</span>)</span><br><span class="line">y = x*x</span><br><span class="line"></span><br><span class="line">fig1 = plt.figure()</span><br><span class="line">ax1 = fig1.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax1.plot(x,y)</span><br><span class="line">ax1.annotate(<span class="string">&#x27;this is minimum&#x27;</span>,xy=(<span class="number">0</span>,<span class="number">0</span>),xytext=(<span class="number">-1.5</span>,<span class="number">20</span>),</span><br><span class="line">             arrowprops=dict(facecolor=<span class="string">&#x27;r&#x27;</span>,headlength=<span class="number">10</span>))；</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/27/PLMhVK.png" alt="PLMhVK.png"></p>
<h3 id="添加平行于坐标轴的线"><a href="#添加平行于坐标轴的线" class="headerlink" title="添加平行于坐标轴的线"></a>添加平行于坐标轴的线</h3><p>你可能需要添加一条平行于x轴或者是y轴的线，在图像中分割不同区域。这时候，你就需要调用vlines(x, ymin, ymax)函数或者是hlines(y, xmin, xmax)函数，除了括号内的参数之外，你还可以设置颜色(color)参数和线型(linestyles)参数。（设置方法参考<strong>颜色与样式</strong>章节）</p>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plt.vlines(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>, colors = <span class="string">&quot;c&quot;</span>, linestyles = <span class="string">&quot;--&quot;</span>);</span><br><span class="line">plt.hlines(<span class="number">0.25</span>, <span class="number">-0.04</span>, <span class="number">0.04</span>, colors = <span class="string">&quot;r&quot;</span>, linestyles = <span class="string">&quot;-.&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/28/PLvCyn.png" alt="PLvCyn.png"></p>
<h2 id="常用图形"><a href="#常用图形" class="headerlink" title="常用图形"></a>常用图形</h2><h3 id="可视化图形参考"><a href="#可视化图形参考" class="headerlink" title="可视化图形参考"></a>可视化图形参考</h3><p>如何能选择最适合的图形来表示你想分析的结果呢？这里提供一个简单的参考~</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/POERc6"><img src="https://s1.ax1x.com/2018/08/28/POERc6.md.jpg" alt="POERc6.md.jpg"></a></p>
<h3 id="散点图（scatter）"><a href="#散点图（scatter）" class="headerlink" title="散点图（scatter）"></a>散点图（scatter）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">7</span>)<span class="comment">#设置随机种子，可以保证每次的随机数是一致的</span></span><br><span class="line"></span><br><span class="line">N = <span class="number">50</span></span><br><span class="line">x = np.random.rand(N)<span class="comment">#生成50个0到1的随机数</span></span><br><span class="line">y = np.random.rand(N)</span><br><span class="line">colors = np.random.rand(N)</span><br><span class="line">area = (<span class="number">30</span> * np.random.rand(N))**<span class="number">2</span>  <span class="comment">#随便设置的一个计算值，来表示大小</span></span><br><span class="line"></span><br><span class="line">plt.scatter(x, y, s=area, c=colors, alpha=<span class="number">0.5</span>);<span class="comment">#用s设置大小区分，用c设置颜色区分</span></span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/28/POEJts.png" alt="POEJts.png"></p>
<h3 id="条形图（bar）"><a href="#条形图（bar）" class="headerlink" title="条形图（bar）"></a>条形图（bar）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例1</span></span><br><span class="line"><span class="comment">#函数使用包</span></span><br><span class="line"><span class="keyword">from</span> matplotlib.ticker <span class="keyword">import</span> FuncFormatter</span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">4</span>)</span><br><span class="line">money = [<span class="number">1.5e5</span>, <span class="number">2.5e6</span>, <span class="number">5.5e6</span>, <span class="number">2.0e7</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">millions</span>(<span class="params">x, pos</span>):</span></span><br><span class="line">  <span class="string">&#x27;&#x27;&#x27;定义一个函数，将科学记数法转为以million为单位，保留一位小数，并添加美元$和单位M；</span></span><br><span class="line"><span class="string">    两个参数分别表示导入的值和位置。&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;$%.1fM&#x27;</span> % (x * <span class="number">1e-6</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">formatter = FuncFormatter(millions)<span class="comment">#调用函数，将millions函数作为模块化函数</span></span><br><span class="line"></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.yaxis.set_major_formatter(formatter)<span class="comment">#设置y轴按函数模块化</span></span><br><span class="line">plt.bar(x, money)</span><br><span class="line">plt.xticks(x, (<span class="string">&#x27;Bill&#x27;</span>, <span class="string">&#x27;Fred&#x27;</span>, <span class="string">&#x27;Mary&#x27;</span>, <span class="string">&#x27;Sue&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/28/POV8KK.png" alt="POV8KK.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例2 横向柱形图</span></span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">4</span>)</span><br><span class="line">money = [<span class="number">1.5e5</span>, <span class="number">2.5e6</span>, <span class="number">5.5e6</span>, <span class="number">2.0e7</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">millions</span>(<span class="params">x, pos</span>):</span></span><br><span class="line">  <span class="string">&#x27;&#x27;&#x27;定义一个函数，将科学记数法转为以million为单位，保留一位小数，并添加美元$和单位M；</span></span><br><span class="line"><span class="string">    两个参数分别表示导入的值和位置。&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;$%.1fM&#x27;</span> % (x * <span class="number">1e-6</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">formatter = FuncFormatter(millions)<span class="comment">#调用函数，将millions函数作为模块化函数</span></span><br><span class="line"></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.xaxis.set_major_formatter(formatter)</span><br><span class="line">plt.barh(x, money)<span class="comment">#关键代码：barh</span></span><br><span class="line">plt.yticks(x, (<span class="string">&#x27;Bill&#x27;</span>, <span class="string">&#x27;Fred&#x27;</span>, <span class="string">&#x27;Mary&#x27;</span>, <span class="string">&#x27;Sue&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/28/POV4x0.png" alt="POV4x0.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例3 拼接柱状图</span></span><br><span class="line">N = <span class="number">5</span></span><br><span class="line">menMeans = (<span class="number">20</span>, <span class="number">35</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">27</span>)</span><br><span class="line">womenMeans = (<span class="number">25</span>, <span class="number">32</span>, <span class="number">34</span>, <span class="number">20</span>, <span class="number">25</span>)</span><br><span class="line">ind = np.arange(N)    <span class="comment"># 等效于[0,1,2,3,4]</span></span><br><span class="line">width = <span class="number">0.35</span>       <span class="comment"># 柱的宽度</span></span><br><span class="line"></span><br><span class="line">p1 = plt.bar(ind, menMeans, width)</span><br><span class="line">p2 = plt.bar(ind, womenMeans, width,bottom=menMeans) <span class="comment">#关键代码：bottom</span></span><br><span class="line"></span><br><span class="line">plt.ylabel(<span class="string">&#x27;Scores&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Scores by group and gender&#x27;</span>)</span><br><span class="line">plt.xticks(ind, (<span class="string">&#x27;G1&#x27;</span>, <span class="string">&#x27;G2&#x27;</span>, <span class="string">&#x27;G3&#x27;</span>, <span class="string">&#x27;G4&#x27;</span>, <span class="string">&#x27;G5&#x27;</span>))</span><br><span class="line">plt.yticks(np.arange(<span class="number">0</span>, <span class="number">81</span>, <span class="number">10</span>))</span><br><span class="line">plt.legend((p1, p2), (<span class="string">&#x27;Men&#x27;</span>, <span class="string">&#x27;Women&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/28/POZPde.png" alt="POZPde.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例4 并列柱状图</span></span><br><span class="line">N = <span class="number">5</span></span><br><span class="line">menMeans = (<span class="number">20</span>, <span class="number">35</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">27</span>)</span><br><span class="line">womenMeans = (<span class="number">25</span>, <span class="number">32</span>, <span class="number">34</span>, <span class="number">20</span>, <span class="number">25</span>)</span><br><span class="line">ind = np.arange(N)    </span><br><span class="line">width = <span class="number">0.35</span>      </span><br><span class="line"></span><br><span class="line">p1 = plt.bar(ind-width/<span class="number">2</span>, menMeans, width) <span class="comment">#关键代码 -width/2，也就是将柱子向左移动了width/2</span></span><br><span class="line">p2 = plt.bar(ind+width/<span class="number">2</span>, womenMeans, width) <span class="comment">#关键代码 +width/2</span></span><br><span class="line"></span><br><span class="line">plt.ylabel(<span class="string">&#x27;Scores&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Scores by group and gender&#x27;</span>)</span><br><span class="line">plt.xticks(ind, (<span class="string">&#x27;G1&#x27;</span>, <span class="string">&#x27;G2&#x27;</span>, <span class="string">&#x27;G3&#x27;</span>, <span class="string">&#x27;G4&#x27;</span>, <span class="string">&#x27;G5&#x27;</span>))</span><br><span class="line">plt.yticks(np.arange(<span class="number">0</span>, <span class="number">81</span>, <span class="number">10</span>))</span><br><span class="line">plt.legend((p1[<span class="number">0</span>], p2[<span class="number">0</span>]), (<span class="string">&#x27;Men&#x27;</span>, <span class="string">&#x27;Women&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/28/POZKeS.png" alt="POZKeS.png"></p>
<h3 id="直方图（hist）"><a href="#直方图（hist）" class="headerlink" title="直方图（hist）"></a>直方图（hist）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure()</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">221</span>)</span><br><span class="line">ax2 = fig.add_subplot(<span class="number">222</span>)</span><br><span class="line">ax3 = fig.add_subplot(<span class="number">212</span>)</span><br><span class="line"></span><br><span class="line">mu = <span class="number">100</span> <span class="comment">#定义均值</span></span><br><span class="line">sigma = <span class="number">20</span> <span class="comment">#定义标准差</span></span><br><span class="line">x = mu +sigma * np.random.randn(<span class="number">2000</span>) <span class="comment">#生成一个标准正态分布函数</span></span><br><span class="line"></span><br><span class="line">ax1.hist(x,bins=<span class="number">10</span>,color=<span class="string">&#x27;green&#x27;</span>,normed=<span class="literal">True</span>) <span class="comment">#输入数据，bins=总共有几条条状图，color=颜色，normed=True:图形面积之和为1</span></span><br><span class="line"></span><br><span class="line">ax2.hist(x,bins=<span class="number">50</span>,color=<span class="string">&#x27;red&#x27;</span>,normed=<span class="literal">False</span>) <span class="comment">#normed=False:纵坐标显示实际值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x = np.random.randn(<span class="number">1000</span>)+<span class="number">2</span></span><br><span class="line">y = np.random.randn(<span class="number">1000</span>)+<span class="number">3</span></span><br><span class="line"></span><br><span class="line">ax3.hist2d(x,y,bins=<span class="number">10</span>); <span class="comment">#二维直方图</span></span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/28/POZXTg.png" alt="POZXTg.png"></p>
<h3 id="饼状图（pie）"><a href="#饼状图（pie）" class="headerlink" title="饼状图（pie）"></a>饼状图（pie）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">labels = <span class="string">&#x27;Frogs&#x27;</span>, <span class="string">&#x27;Hogs&#x27;</span>, <span class="string">&#x27;Dogs&#x27;</span>, <span class="string">&#x27;Logs&#x27;</span></span><br><span class="line">sizes = [<span class="number">15</span>, <span class="number">30</span>, <span class="number">45</span>, <span class="number">10</span>] <span class="comment">#占比</span></span><br><span class="line">explode = (<span class="number">0</span>, <span class="number">0.1</span>, <span class="number">0</span>, <span class="number">0</span>)  <span class="comment">#设置第二位也就是‘Hogs’凸显，间距为0.1</span></span><br><span class="line"></span><br><span class="line">fig1, ax1 = plt.subplots()</span><br><span class="line">ax1.pie(sizes, explode=explode, labels=labels, autopct=<span class="string">&#x27;%1.1f%%&#x27;</span>,shadow=<span class="literal">True</span>, startangle=<span class="number">90</span>)<span class="comment">#autopct对输出进行格式化，startangle为起始角度，一般设置为90比较好看</span></span><br><span class="line">ax1.axis(<span class="string">&#x27;equal&#x27;</span>);<span class="comment">#保证为正圆</span></span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/28/POnmsx.png" alt="POnmsx.png"></p>
<h3 id="箱线图（box）"><a href="#箱线图（box）" class="headerlink" title="箱线图（box）"></a>箱线图（box）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure()</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">211</span>)</span><br><span class="line">ax2 = fig.add_subplot(<span class="number">212</span>)</span><br><span class="line"></span><br><span class="line">data = np.random.normal(size=<span class="number">1000</span>, loc=<span class="number">0.0</span>, scale=<span class="number">1.0</span>)</span><br><span class="line"></span><br><span class="line">ax1.boxplot(data,sym=<span class="string">&#x27;o&#x27;</span>,whis=<span class="number">1.5</span>)</span><br><span class="line"><span class="comment"># plt.boxplot(x, notch=None, sym=None, vert=None, whis=None, positions=None, widths=None, patch_artist=None, meanline=None, showmeans=None, showcaps=None, showbox=None, showfliers=None, boxprops=None, labels=None, flierprops=None, medianprops=None, meanprops=None, capprops=None, whiskerprops=None)</span></span><br><span class="line"><span class="comment"># x：指定要绘制箱线图的数据；</span></span><br><span class="line"><span class="comment"># notch：是否是凹口的形式展现箱线图，默认非凹口；</span></span><br><span class="line"><span class="comment"># sym：指定异常点的形状，默认为+号显示；</span></span><br><span class="line"><span class="comment"># vert：是否需要将箱线图垂直摆放，默认垂直摆放；</span></span><br><span class="line"><span class="comment"># whis：指定上下须与上下四分位的距离，默认为1.5倍的四分位差；</span></span><br><span class="line"><span class="comment"># positions：指定箱线图的位置，默认为[0,1,2…]；</span></span><br><span class="line"><span class="comment"># widths：指定箱线图的宽度，默认为0.5；</span></span><br><span class="line"><span class="comment"># patch_artist：是否填充箱体的颜色；</span></span><br><span class="line"><span class="comment"># meanline：是否用线的形式表示均值，默认用点来表示；</span></span><br><span class="line"><span class="comment"># showmeans：是否显示均值，默认不显示；</span></span><br><span class="line"><span class="comment"># showcaps：是否显示箱线图顶端和末端的两条线，默认显示；</span></span><br><span class="line"><span class="comment"># showbox：是否显示箱线图的箱体，默认显示；</span></span><br><span class="line"><span class="comment"># showfliers：是否显示异常值，默认显示；</span></span><br><span class="line"><span class="comment"># boxprops：设置箱体的属性，如边框色，填充色等；</span></span><br><span class="line"><span class="comment"># labels：为箱线图添加标签，类似于图例的作用；</span></span><br><span class="line"><span class="comment"># filerprops：设置异常值的属性，如异常点的形状、大小、填充色等；</span></span><br><span class="line"><span class="comment"># medianprops：设置中位数的属性，如线的类型、粗细等；</span></span><br><span class="line"><span class="comment"># meanprops：设置均值的属性，如点的大小、颜色等；</span></span><br><span class="line"><span class="comment"># capprops：设置箱线图顶端和末端线条的属性，如颜色、粗细等；</span></span><br><span class="line"><span class="comment"># whiskerprops：设置须的属性，如颜色、粗细、线的类型等；</span></span><br><span class="line">data = np.random.normal(size=(<span class="number">100</span>, <span class="number">4</span>), loc=<span class="number">0.0</span>, scale=<span class="number">1.0</span>)</span><br><span class="line"></span><br><span class="line">labels = [<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;D&#x27;</span>]</span><br><span class="line"></span><br><span class="line">ax2.boxplot(data, labels=labels);</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/28/POnIfJ.png" alt="POnIfJ.png"></p>
<h3 id="散点直方图（scatter-hist）"><a href="#散点直方图（scatter-hist）" class="headerlink" title="散点直方图（scatter hist）"></a>散点直方图（scatter hist）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">x = np.random.randn(<span class="number">200</span>)</span><br><span class="line">y = x + np.random.randn(<span class="number">200</span>)*<span class="number">0.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义坐标轴参数</span></span><br><span class="line">margin_border = <span class="number">0.1</span> </span><br><span class="line">width = <span class="number">0.6</span></span><br><span class="line">margin_between = <span class="number">0.02</span></span><br><span class="line">height = <span class="number">0.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#散点图参数</span></span><br><span class="line">left_s = margin_border <span class="comment">#距左边框距离</span></span><br><span class="line">bottom_s = margin_border <span class="comment">#距底部距离</span></span><br><span class="line">height_s = width <span class="comment">#散点图高度</span></span><br><span class="line">width_s = width <span class="comment">#散点图宽度</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#顶部直方图参数</span></span><br><span class="line">left_x = margin_border <span class="comment">#距左边框距离</span></span><br><span class="line">bottom_x = margin_border+width+margin_between <span class="comment">#距底部距离 = 散点图距底部距离+散点图高度+散点图与直方图的间距</span></span><br><span class="line">height_x = height <span class="comment">#直方图高度</span></span><br><span class="line">width_x = width <span class="comment">#直方图宽度</span></span><br><span class="line"></span><br><span class="line">left_y = margin_border+width+margin_between</span><br><span class="line">bottom_y = margin_border</span><br><span class="line">height_y = width</span><br><span class="line">width_y = height</span><br><span class="line"></span><br><span class="line">plt.figure(<span class="number">1</span>,figsize=(<span class="number">8</span>,<span class="number">8</span>))</span><br><span class="line">rect_s = [left_s,bottom_s,width_s,height_s]</span><br><span class="line">rect_x = [left_x,bottom_x,width_x,height_x]</span><br><span class="line">rect_y = [left_y,bottom_y,width_y,height_y]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开始按照定义的尺寸绘图</span></span><br><span class="line">axScatter = plt.axes(rect_s)</span><br><span class="line">axHisX = plt.axes(rect_x)</span><br><span class="line">axHisY = plt.axes(rect_y)</span><br><span class="line">axHisX.set_xticks([])<span class="comment">#取消顶部直方图的x轴刻度显示</span></span><br><span class="line">axHisY.set_yticks([])<span class="comment">#取消右侧直方图的y轴刻度显示</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#绘制散点图</span></span><br><span class="line">axScatter.scatter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设定边界</span></span><br><span class="line">bin_width = <span class="number">0.25</span></span><br><span class="line">xymax = np.max([np.max(np.fabs(x)),np.max(np.fabs(y))])<span class="comment">#取出x与y中最大的绝对值</span></span><br><span class="line">lim =int(xymax/bin_width+<span class="number">1</span>) * bin_width </span><br><span class="line">axScatter.set_xlim(-lim,lim)</span><br><span class="line">axScatter.set_ylim(-lim,lim)</span><br><span class="line"></span><br><span class="line">bins = np.arange(-lim,lim+bin_width,bin_width)</span><br><span class="line"></span><br><span class="line">axHisX.hist(x,bins=bins)</span><br><span class="line">axHisY.hist(y,bins=bins,orientation=<span class="string">&#x27;horizontal&#x27;</span>)<span class="comment">#水平作图</span></span><br><span class="line"></span><br><span class="line">axHisX.set_xlim(axScatter.get_xlim())</span><br><span class="line">axHisY.set_ylim(axScatter.get_ylim());</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/28/POmosP.png" alt="POmosP.png"></p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="保存图像到本地"><a href="#保存图像到本地" class="headerlink" title="保存图像到本地"></a>保存图像到本地</h3><p>参考如下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#保存至当下路径</span></span><br><span class="line">fig.savefig(<span class="string">&#x27;test.jpg&#x27;</span>);</span><br><span class="line"><span class="comment">#保存至其他路径</span></span><br><span class="line">fig.savefig(<span class="string">&#x27;E:/DAND/DAND_VIP/test.jpg&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="显示中文"><a href="#显示中文" class="headerlink" title="显示中文"></a>显示中文</h3><p>使用matplotlib做可视化不能显示中文，根本原因是因为官方配置中没有中文字体，所以，我们把中文字体添加进去就ok啦。具体方法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>]=[<span class="string">&#x27;simhei&#x27;</span>]<span class="comment">#simhei为‘黑体’</span></span><br></pre></td></tr></table></figure>

<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(<span class="number">1</span>,<span class="number">11</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">line1 = ax.plot(x,-x*<span class="number">2</span>,label=<span class="string">&#x27;优&#x27;</span>)</span><br><span class="line">line2 = ax.plot(x,-x*<span class="number">3</span>,label=<span class="string">&#x27;良&#x27;</span>)</span><br><span class="line">line3 = ax.plot(x,-x*<span class="number">4</span>,label=<span class="string">&#x27;差&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.legend(loc=<span class="string">&#x27;best&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;标题&#x27;</span>,color = <span class="string">&#x27;r&#x27;</span>,fontsize = <span class="number">17</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;x轴&#x27;</span>,fontsize = <span class="number">13</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;-y轴&#x27;</span>,fontsize = <span class="number">13</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://s1.ax1x.com/2018/08/28/POSpSe.png" alt="POSpSe.png"></p>
<h3 id="坐标轴显示负号"><a href="#坐标轴显示负号" class="headerlink" title="坐标轴显示负号"></a>坐标轴显示负号</h3><p>有可能你做得可视化图像中，坐标轴的符号显示一个框框，这时候你添加如下设置即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>]=<span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h1 id="Pandas-Plot"><a href="#Pandas-Plot" class="headerlink" title="Pandas Plot"></a>Pandas Plot</h1><p>pandas plot函数是基于matplotlib的一个在pandas中快速绘图的方法，用法简单，而且兼容所有matplotlib属性设置的函数，所以，你可以用pandas plot函数来绘图，然后调用matplotlib中的函数对可视化图形进行设置，最终达到你心中的预期。</p>
<h2 id="官方链接-1"><a href="#官方链接-1" class="headerlink" title="官方链接"></a>官方链接</h2><p><a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.plot.html#pandas-dataframe-plot">pandas.DataFrame.plot</a></p>
<h2 id="常用参数设置-1"><a href="#常用参数设置-1" class="headerlink" title="常用参数设置"></a>常用参数设置</h2><ul>
<li>data：你可以直接调取DataFrame作为参数输入</li>
<li>x：x轴数据</li>
<li>y：y轴数据</li>
<li>kind：绘图类型<ul>
<li>line ：折线图</li>
<li>bar ：条形图</li>
<li>barh：水平条形图</li>
<li>hist：直方图</li>
<li>box：箱线图</li>
<li>kde：就是在条形图的基础上添加了概率密度曲线</li>
<li>area ：相当于填充面积的折线图</li>
<li>pie：饼状图</li>
<li>scatter：散点图</li>
<li>hexbin：热度图</li>
</ul>
</li>
</ul>
<p>其余参数与matplotlib的参数设置类似，这里不再赘述。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>matplotlib是python可视化的鼻祖，绘图全面，多功能是他的优点，几乎没有他不能完成的可视化任务；</p>
<p>但是，他的缺点也很明显，比如：可视化图形配色丑；参数太多，设置琐碎；没有交互式。。。</p>
<p>所以针对这些问题，后人们又开发了许多python的可视化包，比如说：以美观、简洁著称的<a target="_blank" rel="noopener" href="https://seaborn.pydata.org/">seaborn</a>、做交互式的<a target="_blank" rel="noopener" href="https://plot.ly/python/">plotly</a>、<a target="_blank" rel="noopener" href="http://pyecharts.org/#/">pyecharts</a>等等，后续我看时间允许的话，再出一些教程，大家也可以按需去官网学习，主要是看给出的示例，看关键代码，自己多总结。</p>
<h1 id="项目相关"><a href="#项目相关" class="headerlink" title="项目相关"></a>项目相关</h1><p>P3的项目需要你完完整整得过一遍数据分析的过程，所以呢，单独的某一个数据集肯定满足不了大家，贴心的Udacity给大家准备了几个数据集备选，戳<a target="_blank" rel="noopener" href="https://github.com/udacity/new-dand-basic-china/blob/master/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%A5%E9%97%A8/%E9%A1%B9%E7%9B%AE-%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86/%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86%20-%20%E5%A4%87%E9%80%89%E6%95%B0%E6%8D%AE%E9%9B%86.md">数据集预览</a>，挑一个自己感兴趣的先~</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/pipisorry/article/details/37742423">matplotlib绘图基础</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 2018 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Allen Jia</span>
</div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  <script src="/js/local-search.js"></script>















  








  

  
      <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = '//cdn.jsdelivr.net/npm/mathjax@3.1.0/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@2.0.0/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink.listen({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://www.capallen.top/page/2/',]
      });
      });
  </script>
<script>
NexT.utils.loadComments('#valine-comments', () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', () => {
    new Valine(Object.assign({
      el  : '#valine-comments',
      path: "/page/2/",
    }, {"enable":true,"appId":"1GIsNa4yl3cJmXFEcFxWgNJX-gzGzoHsz","appKey":"sAf2Iz8P4JMH7Ac7YKeoojii","placeholder":"畅所欲言吧，朋友！","avatar":"mm","meta":["nick","mail"],"pageSize":10,"lang":null,"visitor":true,"comment_count":true,"recordIP":false,"serverURLs":null,"enableQQ":false,"requiredFields":[]}
    ));
  }, window.Valine);
});
</script>

</body>
</html>
