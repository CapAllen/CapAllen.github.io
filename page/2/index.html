<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">





  
  
  <link rel="canonical" href="http://yoursite.com/page/2/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Hexo</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/08/2018-9-7-第八周-FBI枪支数据分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/09/08/2018-9-7-第八周-FBI枪支数据分析/" class="post-title-link" itemprop="url">每周导学-第八周-FBI枪支数据分析</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-09-08 12:30:09" itemprop="dateCreated datePublished" datetime="2018-09-08T12:30:09+08:00">2018-09-08</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-03 12:51:55" itemprop="dateModified" datetime="2019-04-03T12:51:55+08:00">2019-04-03</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2018/09/08/2018-9-7-第八周-FBI枪支数据分析/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/09/08/2018-9-7-第八周-FBI枪支数据分析/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Stop being afraid of what could go wrong and start being positive about what could go right.</p>
</blockquote>
<p>Hi，同学们，经过了前两周的学习，我们掌握了数据分析的基本流程、Pandas在数据分析各个流程中的基本应用以及使用matplotlib&amp;Pandas进行可视化的技巧，那么本周我们就真刀实枪地找一套数据集练练手。本周的导学有两期，分别选用了项目三中的两个数据集（<strong>TMDb电影数据和FBI枪支数据</strong>）进行分析，只是分享思路和方法，起一个抛砖引玉的作用，大家选择其他的数据集也可以举一反三，如果有什么棘手的问题随时微信联系我就OK~</p>
<p>本周开始，我们就进入到了<strong>项目三(P3)阶段</strong>，本阶段总共包含<strong>四周</strong>，在这一个月内，我们要对<strong>数据分析入门</strong>进行学习，学习数据分析思维，掌握Python数据分析及可视化方法，并使用所学知识完成<strong>项目三：探索数据集</strong>，尝试着自己完成整个数据分析的流程，得到一些饶有兴趣的结论，你一定会非常有成就感哒！那么以下便是这四周的学习安排：</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody>
<tr>
<td>第1周</td>
<td>数据分析过程-1</td>
<td>数据分析过程&amp;案例研究-1</td>
</tr>
<tr>
<td>第2周</td>
<td>数据分析过程-2</td>
<td>案例研究-1&amp;案例研究-2</td>
</tr>
<tr>
<td><strong>第3周</strong></td>
<td><strong>完成项目</strong></td>
<td><strong>项目：探索数据集</strong></td>
</tr>
<tr>
<td>第4周</td>
<td>项目修改与通过</td>
<td>修改项目、查缺补漏、休息调整</td>
</tr>
</tbody>
</table>
<font size="3" color="red"><strong>！！看这里！！</strong>：在P3课程里面安排了SQL的高阶课程，但是因为在项目三中并不会涉及到SQL知识，所以为了保证大家学习的连贯性，在完成前两周的课程之后，就开始项目。至于<strong>！！SQL的高阶知识，大家可以放在课程通关后进行选修！！</strong>； </font>

<p>本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/百度搜索、<a href="http://www.runoob.com/python3/python3-tutorial.html" target="_blank" rel="noopener">菜鸟教程</a>、<a href="https://www.csdn.net/" target="_blank" rel="noopener">CSDN</a>、<a href="https://stackoverflow.com/" target="_blank" rel="noopener">stack<strong>overflow</strong></a>、<a href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/Python%20for%20Data%20Analysis%2C%202nd%20Edition.pdf" target="_blank" rel="noopener"><strong>Python for Data Analysis, 2nd Edition</strong> </a>、<a href="http://python3-cookbook.readthedocs.io/zh_CN/latest/" target="_blank" rel="noopener">Python Cookbook</a></li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p><strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><ul>
<li>在<a href="https://github.com/udacity/new-dand-basic-china/blob/master/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%A5%E9%97%A8/%E9%A1%B9%E7%9B%AE-%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86/%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86%20-%20%E5%A4%87%E9%80%89%E6%95%B0%E6%8D%AE%E9%9B%86.md" target="_blank" rel="noopener">此处</a>挑选和你确认过眼神的数据集，并对其进行数据分析和探索，得出你自己的结论，然后进行提交。</li>
</ul>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>项目三</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody>
</table>
<h1 id="项目准备"><a href="#项目准备" class="headerlink" title="项目准备"></a>项目准备</h1><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>强烈建议大家完成本地环境的搭建，在本地完成此项目。搭建本地环境的方法请参考<a href="https://classroom.udacity.com/nanodegrees/nd002-cn-basic-vip/parts/e566ad37-6119-4448-a6bc-7ade73ef3992" target="_blank" rel="noopener">Anaconda的安装与配置</a>一节，完成后你将获得本项目中会用到的关键软件：<strong>Spyder</strong>和<strong>Jupyter Notebook</strong>。</p>
<h2 id="文件准备"><a href="#文件准备" class="headerlink" title="文件准备"></a>文件准备</h2><ul>
<li>项目文件：依次进入到<strong>项目：探索数据集</strong> –&gt; <strong>3.实战项目</strong>中，下载项目文件的ipynb格式。</li>
</ul>
<p><a href="https://imgchr.com/i/Pz6nds" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/03/Pz6nds.md.png" alt="Pz6nds.md.png"></a></p>
<ul>
<li><p>数据集选择：在<a href="https://github.com/udacity/new-dand-basic-china/blob/master/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%A5%E9%97%A8/%E9%A1%B9%E7%9B%AE-%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86/%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86%20-%20%E5%A4%87%E9%80%89%E6%95%B0%E6%8D%AE%E9%9B%86.md" target="_blank" rel="noopener">此处</a>选择你感兴趣的数据集并下载至与<strong>项目文件相同的文件夹</strong>。（若下载失败，请微信联系我索取）</p>
</li>
<li><p>本地打开：在项目文件的文件夹下，按住<code>Shift</code>键，右击选择<code>在此处打开命令窗口</code>，输入<code>jupyter notebook</code>，待打开本地页面之后，选择项目文件打开，之后就请开始你的表演。</p>
<p><img src="https://ws2.sinaimg.cn/large/9150e4e5ly1fg4xzdddjhj20b407u74k.jpg" alt></p>
</li>
</ul>
<h2 id="方法准备"><a href="#方法准备" class="headerlink" title="方法准备"></a>方法准备</h2><p>项目文件中已经给大家列好了基本流程，所以请在开始项目之前，一定要<strong>先整体浏览一遍项目文件</strong>，着重看一下：</p>
<ul>
<li>项目流程</li>
<li>每一个流程中你需要做哪些工作</li>
<li>每一个流程中的提示</li>
</ul>
<p>要记得，数据分析过程不是一蹴而就的，是螺旋上升接近目标的过程，所以一定要保持耐心，对照着<a href="https://review.udacity.com/#!/rubrics/306/view" target="_blank" rel="noopener">项目评估准则</a>一步步完成。</p>
<p>另外，一开始你的notebook会显得很乱没有章法，那在<strong>提交之前最好能再修改一个整理好的版本</strong>。</p>
<h1 id="项目流程（FBI枪支数据）"><a href="#项目流程（FBI枪支数据）" class="headerlink" title="项目流程（FBI枪支数据）"></a>项目流程（FBI枪支数据）</h1><h2 id="数据集说明"><a href="#数据集说明" class="headerlink" title="数据集说明"></a>数据集说明</h2><p>该数据来自联邦调查局 (FBI) 的全国即时犯罪背景调查系统 (NICS)。NICS 用于确定潜在买家是否有资格购买枪支或爆炸物。枪支店可以进入这个系统，以确保每位客户没有犯罪记录或符合资格购买。该数据已经收纳了来自<br>census.gov 的州级数据作为补充数据。<a href="https://d17h27t6h515a5.cloudfront.net/topher/2017/November/5a0a4db8_gun-data/gun-data.xlsx" target="_blank" rel="noopener">NICS 数据</a>在一个 xlsx 文件格式的一个表格中，它包含了按照月份(month)、州 (state) 、类型 (type) 统计的武器调查数量 (the number of firearm checks) ;美国的<a href="https://d17h27t6h515a5.cloudfront.net/topher/2017/November/5a0a554c_u.s.-census-data/u.s.-census-data.csv" target="_blank" rel="noopener">人口普查数据</a> (U.S. census data) 储存在一个 csv 文件中。它包含了州级的几个变量，每个州的大多数变量在 2016 年只有一个数据点，但一些变量有一年以上的数据。</p>
<h2 id="提出问题"><a href="#提出问题" class="headerlink" title="提出问题"></a>提出问题</h2><p>虽说本数据集有两个数据文件，但围绕的关键词只有一个，那就是<strong>枪支</strong>，所以提出问题时，也一定要围绕着该关键词进行提问。问题示例：</p>
<ul>
<li>就本数据集统计而言，哪个州的枪支总量增长最高？该州的增长速率如何？  </li>
<li>就本数据集统计而言，全美整体购买枪支总量及各种类的趋势是什么？  </li>
<li>2016年哪个州的人均拥有枪支量最高？  </li>
<li>结合2016年各州的人口普查数据，是否有哪项数据与人均拥有枪支量线性相关？</li>
</ul>
<h2 id="导入拓展包"><a href="#导入拓展包" class="headerlink" title="导入拓展包"></a>导入拓展包</h2><p>一般来说，就导入如下几个拓展包就够了，当然如果后续操作中还需导入其他包的话，再补充即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用这个框对你计划使用的所有数据包进行设置</span></span><br><span class="line"><span class="comment">#   导入语句。</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="comment"># 务必包含一个‘magic word’，以便将你的视图与 notebook 保持一致。</span></span><br><span class="line">%matplotlib inline</span><br><span class="line"><span class="comment">#关于更多信息，请访问该网页：</span></span><br><span class="line"><span class="comment">#   http://ipython.readthedocs.io/en/stable/interactive/magics.html</span></span><br></pre></td></tr></table></figure>
<h2 id="数据整理"><a href="#数据整理" class="headerlink" title="数据整理"></a>数据整理</h2><h3 id="导入数据"><a href="#导入数据" class="headerlink" title="导入数据"></a>导入数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导入枪支数据</span></span><br><span class="line">df_gun = pd.read_excel(<span class="string">'gun_data.xlsx'</span>)</span><br><span class="line"><span class="comment">#导入人口普查数据,这里有一点需要注意，若数据集中全部是包含有千位分隔符的数据，可以在read_csv中添加参数"thousands = ','"。</span></span><br><span class="line">df_census = pd.read_csv(<span class="string">'U.S. Census Data.csv'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="评估数据"><a href="#评估数据" class="headerlink" title="评估数据"></a>评估数据</h3><h4 id="枪支数据"><a href="#枪支数据" class="headerlink" title="枪支数据"></a>枪支数据</h4><ul>
<li>浏览数据</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_gun.head()</span><br></pre></td></tr></table></figure>
<p>这里要注意一点，因为数据集的列数较多，jupyter会自动折叠中间的部分列，导致我们预览数据时总是看不完整，这时候你可以尝试下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#col_numbers设置为不小于你数据集列数的某一值</span></span><br><span class="line">pd.set_option(<span class="string">'max_columns'</span>,col_numbers)</span><br></pre></td></tr></table></figure>
<p>同理，也可以用’max_rows’设置最大显示行数。</p>
<ul>
<li>列及数据类型</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_gun.info()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">pandas</span>.<span class="title">core</span>.<span class="title">frame</span>.<span class="title">DataFrame</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">RangeIndex</span>:</span> <span class="number">12485</span> entries, <span class="number">0</span> to <span class="number">12484</span></span><br><span class="line">Data columns (total <span class="number">27</span> columns):</span><br><span class="line">month                        <span class="number">12485</span> non-null object</span><br><span class="line">state                        <span class="number">12485</span> non-null object</span><br><span class="line">permit                       <span class="number">12461</span> non-null float64</span><br><span class="line">permit_recheck               <span class="number">1100</span> non-null float64</span><br><span class="line">handgun                      <span class="number">12465</span> non-null float64</span><br><span class="line">long_gun                     <span class="number">12466</span> non-null float64</span><br><span class="line">other                        <span class="number">5500</span> non-null float64</span><br><span class="line">multiple                     <span class="number">12485</span> non-null int64</span><br><span class="line">admin                        <span class="number">12462</span> non-null float64</span><br><span class="line">prepawn_handgun              <span class="number">10542</span> non-null float64</span><br><span class="line">prepawn_long_gun             <span class="number">10540</span> non-null float64</span><br><span class="line">prepawn_other                <span class="number">5115</span> non-null float64</span><br><span class="line">redemption_handgun           <span class="number">10545</span> non-null float64</span><br><span class="line">redemption_long_gun          <span class="number">10544</span> non-null float64</span><br><span class="line">redemption_other             <span class="number">5115</span> non-null float64</span><br><span class="line">returned_handgun             <span class="number">2200</span> non-null float64</span><br><span class="line">returned_long_gun            <span class="number">2145</span> non-null float64</span><br><span class="line">returned_other               <span class="number">1815</span> non-null float64</span><br><span class="line">rentals_handgun              <span class="number">990</span> non-null float64</span><br><span class="line">rentals_long_gun             <span class="number">825</span> non-null float64</span><br><span class="line">private_sale_handgun         <span class="number">2750</span> non-null float64</span><br><span class="line">private_sale_long_gun        <span class="number">2750</span> non-null float64</span><br><span class="line">private_sale_other           <span class="number">2750</span> non-null float64</span><br><span class="line">return_to_seller_handgun     <span class="number">2475</span> non-null float64</span><br><span class="line">return_to_seller_long_gun    <span class="number">2750</span> non-null float64</span><br><span class="line">return_to_seller_other       <span class="number">2255</span> non-null float64</span><br><span class="line">totals                       <span class="number">12485</span> non-null int64</span><br><span class="line">dtypes: float64(<span class="number">23</span>), int64(<span class="number">2</span>), object(<span class="number">2</span>)</span><br><span class="line">memory usage: <span class="number">2.6</span>+ MB</span><br></pre></td></tr></table></figure>
<p>纵览了一下，各列的数据类型基本没什么问题，唯一有问题的是<code>month</code>列，应该是<code>datetime</code>类型。整个数据集就是由时间、州名和各式各样的枪支数据组成的。</p>
<ul>
<li>查看各列的缺失值情况</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#这里我们计算的缺失比例</span></span><br><span class="line">df_gun.isnull().sum()/df_gun.shape[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">month                        <span class="number">0.000000</span></span><br><span class="line">state                        <span class="number">0.000000</span></span><br><span class="line">permit                       <span class="number">0.001922</span></span><br><span class="line">permit_recheck               <span class="number">0.911894</span></span><br><span class="line">handgun                      <span class="number">0.001602</span></span><br><span class="line">long_gun                     <span class="number">0.001522</span></span><br><span class="line">other                        <span class="number">0.559471</span></span><br><span class="line">multiple                     <span class="number">0.000000</span></span><br><span class="line">admin                        <span class="number">0.001842</span></span><br><span class="line">prepawn_handgun              <span class="number">0.155627</span></span><br><span class="line">prepawn_long_gun             <span class="number">0.155787</span></span><br><span class="line">prepawn_other                <span class="number">0.590308</span></span><br><span class="line">redemption_handgun           <span class="number">0.155386</span></span><br><span class="line">redemption_long_gun          <span class="number">0.155467</span></span><br><span class="line">redemption_other             <span class="number">0.590308</span></span><br><span class="line">returned_handgun             <span class="number">0.823789</span></span><br><span class="line">returned_long_gun            <span class="number">0.828194</span></span><br><span class="line">returned_other               <span class="number">0.854626</span></span><br><span class="line">rentals_handgun              <span class="number">0.920705</span></span><br><span class="line">rentals_long_gun             <span class="number">0.933921</span></span><br><span class="line">private_sale_handgun         <span class="number">0.779736</span></span><br><span class="line">private_sale_long_gun        <span class="number">0.779736</span></span><br><span class="line">private_sale_other           <span class="number">0.779736</span></span><br><span class="line">return_to_seller_handgun     <span class="number">0.801762</span></span><br><span class="line">return_to_seller_long_gun    <span class="number">0.779736</span></span><br><span class="line">return_to_seller_other       <span class="number">0.819383</span></span><br><span class="line">totals                       <span class="number">0.000000</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p>可见数据集的缺失情况非常严重，这时候需要你直接运行<code>df_gun</code>去观察全部数据，这样才能有据猜想数据缺失的原因。简要通览数据后，我们发现近年的数据缺失不大，猜想之前的统计中没有对枪支进行详细分类或者是统计不全导致的，而且就枪支数量而言，缺失数据较少的permit、handgun、long_gun和other等列占绝对优势，所以我们完全可以只筛选最有代表性的这几列进行分析。</p>
<blockquote>
<p>因为筛选后的数据跟之前相差较大，为了提高后续步骤的效率，可以在此先进行数据清理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="comment">#因为此次筛选的数据列是间隔的，所以调用了numpy的r_函数生成列表，按照列序号筛选间隔的列。</span></span><br><span class="line">&gt; df_gun = df_gun.iloc[:,np.r_[<span class="number">0</span>:<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">26</span>]].dropna()</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>之后，还需对最后一列<code>totals</code>进行修正</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; df_gun[<span class="string">'totals'</span>] = df_gun[<span class="string">'permit'</span>]+df_gun[<span class="string">'handgun'</span>]+df_gun[<span class="string">'long_gun'</span>]+df_gun[<span class="string">'multiple'</span>]+df_gun[<span class="string">'admin'</span>]</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li>查看重复值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#检查是否有数据重复</span></span><br><span class="line">sum(df_gun.duplicated())</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>无重复数据。</p>
<ul>
<li>查看state列的唯一值数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_gun[<span class="string">'state'</span>].nunique()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">55</span></span><br></pre></td></tr></table></figure>
<p>美国一共有50个州，多出来的5个是什么鬼？是不是有缩写的州名导致的重复？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_gun[<span class="string">'state'</span>].value_counts()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">New Mexico              <span class="number">227</span></span><br><span class="line">California              <span class="number">227</span></span><br><span class="line">South Carolina          <span class="number">227</span></span><br><span class="line">Arkansas                <span class="number">227</span></span><br><span class="line">Kansas                  <span class="number">227</span></span><br><span class="line">New Jersey              <span class="number">227</span></span><br><span class="line">West Virginia           <span class="number">227</span></span><br><span class="line">Texas                   <span class="number">227</span></span><br><span class="line">Maryland                <span class="number">227</span></span><br><span class="line">District of Columbia    <span class="number">227</span></span><br><span class="line">New Hampshire           <span class="number">227</span></span><br><span class="line">Alaska                  <span class="number">227</span></span><br><span class="line">Mississippi             <span class="number">227</span></span><br><span class="line">Alabama                 <span class="number">227</span></span><br><span class="line">Vermont                 <span class="number">227</span></span><br><span class="line">Illinois                <span class="number">227</span></span><br><span class="line">North Dakota            <span class="number">227</span></span><br><span class="line">Rhode Island            <span class="number">227</span></span><br><span class="line">Pennsylvania            <span class="number">227</span></span><br><span class="line">Oklahoma                <span class="number">227</span></span><br><span class="line">Kentucky                <span class="number">227</span></span><br><span class="line">Florida                 <span class="number">227</span></span><br><span class="line">North Carolina          <span class="number">227</span></span><br><span class="line">Utah                    <span class="number">227</span></span><br><span class="line">Idaho                   <span class="number">227</span></span><br><span class="line">Connecticut             <span class="number">227</span></span><br><span class="line">Missouri                <span class="number">227</span></span><br><span class="line">Nebraska                <span class="number">227</span></span><br><span class="line">Tennessee               <span class="number">227</span></span><br><span class="line">Massachusetts           <span class="number">227</span></span><br><span class="line">Nevada                  <span class="number">227</span></span><br><span class="line">Arizona                 <span class="number">227</span></span><br><span class="line">Hawaii                  <span class="number">227</span></span><br><span class="line">Indiana                 <span class="number">227</span></span><br><span class="line">Oregon                  <span class="number">227</span></span><br><span class="line">Michigan                <span class="number">227</span></span><br><span class="line">Minnesota               <span class="number">227</span></span><br><span class="line">Ohio                    <span class="number">227</span></span><br><span class="line">New York                <span class="number">227</span></span><br><span class="line">Wyoming                 <span class="number">227</span></span><br><span class="line">Iowa                    <span class="number">227</span></span><br><span class="line">Maine                   <span class="number">227</span></span><br><span class="line">Guam                    <span class="number">227</span></span><br><span class="line">Wisconsin               <span class="number">227</span></span><br><span class="line">South Dakota            <span class="number">227</span></span><br><span class="line">Puerto Rico             <span class="number">227</span></span><br><span class="line">Georgia                 <span class="number">227</span></span><br><span class="line">Washington              <span class="number">227</span></span><br><span class="line">Delaware                <span class="number">227</span></span><br><span class="line">Louisiana               <span class="number">226</span></span><br><span class="line">Virginia                <span class="number">226</span></span><br><span class="line">Montana                 <span class="number">226</span></span><br><span class="line">Colorado                <span class="number">226</span></span><br><span class="line">Mariana Islands         <span class="number">218</span></span><br><span class="line">Virgin Islands          <span class="number">214</span></span><br><span class="line">Name: state, dtype: int64</span><br></pre></td></tr></table></figure>
<p>结果一目了然，不仅有美国各州，还包括了Mariana Islands 、Virgin Islands 等地，感兴趣可以去搜了一下，都是老美宣誓主权的一些群岛。</p>
<h4 id="人口普查数据"><a href="#人口普查数据" class="headerlink" title="人口普查数据"></a>人口普查数据</h4><p>评估的步骤差不多，所以只罗列一些需要注意的点。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_census.info()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">pandas</span>.<span class="title">core</span>.<span class="title">frame</span>.<span class="title">DataFrame</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">RangeIndex</span>:</span> <span class="number">85</span> entries, <span class="number">0</span> to <span class="number">84</span></span><br><span class="line">Data columns (total <span class="number">52</span> columns):</span><br><span class="line">Fact              <span class="number">80</span> non-null object</span><br><span class="line">Fact Note         <span class="number">28</span> non-null object</span><br><span class="line">Alabama           <span class="number">65</span> non-null object</span><br><span class="line">Alaska            <span class="number">65</span> non-null object</span><br><span class="line">Arizona           <span class="number">65</span> non-null object</span><br><span class="line">Arkansas          <span class="number">65</span> non-null object</span><br><span class="line">California        <span class="number">65</span> non-null object</span><br><span class="line">Colorado          <span class="number">65</span> non-null object</span><br><span class="line">Connecticut       <span class="number">65</span> non-null object</span><br><span class="line">Delaware          <span class="number">65</span> non-null object</span><br><span class="line">Florida           <span class="number">65</span> non-null object</span><br><span class="line">Georgia           <span class="number">65</span> non-null object</span><br><span class="line">Hawaii            <span class="number">65</span> non-null object</span><br><span class="line">Idaho             <span class="number">65</span> non-null object</span><br><span class="line">Illinois          <span class="number">65</span> non-null object</span><br><span class="line">Indiana           <span class="number">65</span> non-null object</span><br><span class="line">Iowa              <span class="number">65</span> non-null object</span><br><span class="line">Kansas            <span class="number">65</span> non-null object</span><br><span class="line">Kentucky          <span class="number">65</span> non-null object</span><br><span class="line">Louisiana         <span class="number">65</span> non-null object</span><br><span class="line">Maine             <span class="number">65</span> non-null object</span><br><span class="line">Maryland          <span class="number">65</span> non-null object</span><br><span class="line">Massachusetts     <span class="number">65</span> non-null object</span><br><span class="line">Michigan          <span class="number">65</span> non-null object</span><br><span class="line">Minnesota         <span class="number">65</span> non-null object</span><br><span class="line">Mississippi       <span class="number">65</span> non-null object</span><br><span class="line">Missouri          <span class="number">65</span> non-null object</span><br><span class="line">Montana           <span class="number">65</span> non-null object</span><br><span class="line">Nebraska          <span class="number">65</span> non-null object</span><br><span class="line">Nevada            <span class="number">65</span> non-null object</span><br><span class="line">New Hampshire     <span class="number">65</span> non-null object</span><br><span class="line">New Jersey        <span class="number">65</span> non-null object</span><br><span class="line">New Mexico        <span class="number">65</span> non-null object</span><br><span class="line">New York          <span class="number">65</span> non-null object</span><br><span class="line">North Carolina    <span class="number">65</span> non-null object</span><br><span class="line">North Dakota      <span class="number">65</span> non-null object</span><br><span class="line">Ohio              <span class="number">65</span> non-null object</span><br><span class="line">Oklahoma          <span class="number">65</span> non-null object</span><br><span class="line">Oregon            <span class="number">65</span> non-null object</span><br><span class="line">Pennsylvania      <span class="number">65</span> non-null object</span><br><span class="line">Rhode Island      <span class="number">65</span> non-null object</span><br><span class="line">South Carolina    <span class="number">65</span> non-null object</span><br><span class="line">South Dakota      <span class="number">65</span> non-null object</span><br><span class="line">Tennessee         <span class="number">65</span> non-null object</span><br><span class="line">Texas             <span class="number">65</span> non-null object</span><br><span class="line">Utah              <span class="number">65</span> non-null object</span><br><span class="line">Vermont           <span class="number">65</span> non-null object</span><br><span class="line">Virginia          <span class="number">65</span> non-null object</span><br><span class="line">Washington        <span class="number">65</span> non-null object</span><br><span class="line">West Virginia     <span class="number">65</span> non-null object</span><br><span class="line">Wisconsin         <span class="number">65</span> non-null object</span><br><span class="line">Wyoming           <span class="number">65</span> non-null object</span><br><span class="line">dtypes: object(<span class="number">52</span>)</span><br><span class="line">memory usage: <span class="number">34.6</span>+ KB</span><br></pre></td></tr></table></figure>
<p>发现一个奇怪的事情，基本上所有列数据都在65行之后没有了，肯定有什么猫腻，可以用tail()或者直接打开文件查看（因为数据量很小），发现后面几行都是对数据统计的一些说明，没有实际意义，直接删除即可。而且在该数据中只有50个州的数据。</p>
<h3 id="清理数据"><a href="#清理数据" class="headerlink" title="清理数据"></a>清理数据</h3><blockquote>
<p>清理数据就是对上一步中发现的问题进行清理，并且删除无关列，最终得到的是一个方便你进行分析及可视化的干净数据。</p>
<p><strong>清理前记得备份数据</strong></p>
</blockquote>
<ul>
<li><p>删除无关列</p>
<p>建议使用drop函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除列</span></span><br><span class="line">df_census.drop(<span class="string">'Fact Note'</span>,axis = <span class="number">1</span>,inplace = <span class="literal">True</span>)</span><br><span class="line"><span class="comment">#删除行</span></span><br><span class="line">df_census.drop(np.arange(<span class="number">64</span>,<span class="number">85</span>),inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>数据融合</p>
<p>想要找出人口普查的数据与枪支数据之间的关系，肯定要把这两个数据进行融合。</p>
<p>融合前，我们先观察一下人口普查数据中到底有哪些，发现每个州的大部分变量都只在2016年有记录点，所以我们就要分别从人口普查数据和枪支数据中筛选出2016年的数据，再以州作为键（key）进行合并。</p>
<p><strong>筛选数据</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#先筛选出人口普查数据中2016年的数据，并将Fact列作为索引</span></span><br><span class="line">df_census_2016 = df_census[df_census.Fact.str.contains(<span class="string">'2016'</span>)].set_index(<span class="string">'Fact'</span>)</span><br><span class="line"><span class="comment">#转秩</span></span><br><span class="line">df_census_2016 = df_census_2016.transpose()</span><br><span class="line"><span class="comment">#筛选2016年的枪支数据,并按照州分组计算全年均值</span></span><br><span class="line">df_gun_2016 = df_gun[df_gun[<span class="string">'month'</span>].str.contains(<span class="string">'2016'</span>)].groupby(<span class="string">'state'</span>).mean()</span><br></pre></td></tr></table></figure>
<p><strong>处理千位分隔符和百分号</strong></p>
<p>在人口普查数据中数字中均包含有千位分隔符或者是百分号，这会给我们之后进行分析带来不便，处理掉他们，并且转换为浮点型数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#先将有千位分隔符的列转为float类型</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [ <span class="string">'Population estimates, July 1, 2016,  (V2016)'</span>,<span class="string">'Housing units,  July 1, 2016,  (V2016)'</span>, <span class="string">'Building permits, 2016'</span>]:</span><br><span class="line">    df_census_2016[i] = df_census_2016[i].str.split(<span class="string">','</span>)</span><br><span class="line">    df_census_2016[i] = df_census_2016[i].str.join(<span class="string">''</span>)</span><br><span class="line">    df_census_2016[i] = df_census_2016[i].astype(float)</span><br></pre></td></tr></table></figure>
<p>百分号的处理方式同上类似。</p>
<p><strong>数据融合</strong></p>
<p>我们在之前的导学中总结过Pandas做数据融合的方法，就此项目而言，两个数据以索引（Index，也就是各州的州名）为键进行融合，最简单的方法就是用join()函数了。如果你忘了，可以点<a href="http://www.capallen.top/dand-vip/2018/08/21/%E7%AC%AC%E5%85%AD%E5%91%A8-2-%E6%95%B0%E6%8D%AE%E8%9E%8D%E5%90%88/" target="_blank" rel="noopener">这里</a>复习一下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_2016 = df_gun_2016.join(df_census_2016)</span><br></pre></td></tr></table></figure>
<p>好，至此我们的数据就算是整理完毕了，接下来就是探索性分析及可视化阶段，这里没有什么特别需要注意的地方，大家就随性而为。</p>
</li>
</ul>
<h2 id="探索性数据分析"><a href="#探索性数据分析" class="headerlink" title="探索性数据分析"></a>探索性数据分析</h2><p>在这个阶段你可以随意做可视化，尽可能多得去探索你想解决的问题。<strong>在探索阶段，作图可以不用很规范，你自己知道是什么意思就可以</strong>，而且可能会有些探索的问题结果意义不大，所以<strong>在提交项目时，要进行择优保留并对其润色修饰</strong>。</p>
<ul>
<li>探索不同年份，美国或者是不同州的枪支数量变化就使用df_gun数据集；</li>
<li>探索不同州的人口普查数据与枪支持有量之间的关系就使用我们之后整理的df_2016数据集。</li>
</ul>
<h2 id="得出结论"><a href="#得出结论" class="headerlink" title="得出结论"></a>得出结论</h2><p>对你整理好的可视化图像进行总结，结论要有根有据但也不要只是停留在<code>描述</code>，可以进行适当的猜测。</p>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><ul>
<li>导学只是参考和分享，我是还原了自己在做项目时的思路历程，这并不是提交项目时应有的样子。</li>
<li>记得提交前一定要再重新审视一遍，调整代码，注释，修缮可视化及结论。</li>
<li>经过P3的历练，相信你能更自信，也更能有成就感，坚持！！</li>
<li>加油！！！</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/05/2018-9-5-第八周-TMDB数据分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/09/05/2018-9-5-第八周-TMDB数据分析/" class="post-title-link" itemprop="url">每周导学-第八周-TMDb数据分析</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-09-05 12:30:09" itemprop="dateCreated datePublished" datetime="2018-09-05T12:30:09+08:00">2018-09-05</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-03 12:51:55" itemprop="dateModified" datetime="2019-04-03T12:51:55+08:00">2019-04-03</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2018/09/05/2018-9-5-第八周-TMDB数据分析/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/09/05/2018-9-5-第八周-TMDB数据分析/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Awareness is the greatest agent for change.</p>
</blockquote>
<p>Hi，同学们，经过了前两周的学习，我们掌握了数据分析的基本流程、Pandas在数据分析各个流程中的基本应用以及使用matplotlib&amp;Pandas进行可视化的技巧，那么本周我们就真刀实枪地找一套数据集练练手。本周的导学有两期，分别选用了项目三中的两个数据集（<strong>TMDb电影数据和FBI枪支数据</strong>）进行分析，只是分享思路和方法，起一个抛砖引玉的作用，大家选择其他的数据集也可以举一反三，如果有什么棘手的问题随时微信联系我就OK~</p>
<p>本周开始，我们就进入到了<strong>项目三(P3)阶段</strong>，本阶段总共包含<strong>四周</strong>，在这一个月内，我们要对<strong>数据分析入门</strong>进行学习，学习数据分析思维，掌握Python数据分析及可视化方法，并使用所学知识完成<strong>项目三：探索数据集</strong>，尝试着自己完成整个数据分析的流程，得到一些饶有兴趣的结论，你一定会非常有成就感哒！那么以下便是这四周的学习安排：</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody>
<tr>
<td>第1周</td>
<td>数据分析过程-1</td>
<td>数据分析过程&amp;案例研究-1</td>
</tr>
<tr>
<td>第2周</td>
<td>数据分析过程-2</td>
<td>案例研究-1&amp;案例研究-2</td>
</tr>
<tr>
<td><strong>第3周</strong></td>
<td><strong>完成项目</strong></td>
<td><strong>项目：探索数据集</strong></td>
</tr>
<tr>
<td>第4周</td>
<td>项目修改与通过</td>
<td>修改项目、查缺补漏、休息调整</td>
</tr>
</tbody>
</table>
<font size="3" color="red"><strong>！！看这里！！</strong>：在P3课程里面安排了SQL的高阶课程，但是因为在项目三中并不会涉及到SQL知识，所以为了保证大家学习的连贯性，在完成前两周的课程之后，就开始项目。至于<strong>！！SQL的高阶知识，大家可以放在课程通关后进行选修！！</strong>； </font>

<p>本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/百度搜索、<a href="http://www.runoob.com/python3/python3-tutorial.html" target="_blank" rel="noopener">菜鸟教程</a>、<a href="https://www.csdn.net/" target="_blank" rel="noopener">CSDN</a>、<a href="https://stackoverflow.com/" target="_blank" rel="noopener">stack<strong>overflow</strong></a>、<a href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/Python%20for%20Data%20Analysis%2C%202nd%20Edition.pdf" target="_blank" rel="noopener"><strong>Python for Data Analysis, 2nd Edition</strong> </a>、<a href="http://python3-cookbook.readthedocs.io/zh_CN/latest/" target="_blank" rel="noopener">Python Cookbook</a></li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p><strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><ul>
<li>在<a href="https://github.com/udacity/new-dand-basic-china/blob/master/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%A5%E9%97%A8/%E9%A1%B9%E7%9B%AE-%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86/%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86%20-%20%E5%A4%87%E9%80%89%E6%95%B0%E6%8D%AE%E9%9B%86.md" target="_blank" rel="noopener">此处</a>挑选和你确认过眼神的数据集，并对其进行数据分析和探索，得出你自己的结论，然后进行提交。</li>
</ul>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>项目三</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody>
</table>
<h1 id="项目准备"><a href="#项目准备" class="headerlink" title="项目准备"></a>项目准备</h1><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>强烈建议大家完成本地环境的搭建，在本地完成此项目。搭建本地环境的方法请参考<a href="https://classroom.udacity.com/nanodegrees/nd002-cn-basic-vip/parts/e566ad37-6119-4448-a6bc-7ade73ef3992" target="_blank" rel="noopener">Anaconda的安装与配置</a>一节，完成后你将获得本项目中会用到的关键软件：<strong>Spyder</strong>和<strong>Jupyter Notebook</strong>。</p>
<h2 id="文件准备"><a href="#文件准备" class="headerlink" title="文件准备"></a>文件准备</h2><ul>
<li>项目文件：依次进入到<strong>项目：探索数据集</strong> –&gt; <strong>3.实战项目</strong>中，下载项目文件的ipynb格式。</li>
</ul>
<p><a href="https://imgchr.com/i/Pz6nds" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/03/Pz6nds.md.png" alt="Pz6nds.md.png"></a></p>
<ul>
<li><p>数据集选择：在<a href="https://github.com/udacity/new-dand-basic-china/blob/master/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%A5%E9%97%A8/%E9%A1%B9%E7%9B%AE-%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86/%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86%20-%20%E5%A4%87%E9%80%89%E6%95%B0%E6%8D%AE%E9%9B%86.md" target="_blank" rel="noopener">此处</a>选择你感兴趣的数据集并下载至与<strong>项目文件相同的文件夹</strong>。（若下载失败，请微信联系我索取）</p>
</li>
<li><p>本地打开：在项目文件的文件夹下，按住<code>Shift</code>键，右击选择<code>在此处打开命令窗口</code>，输入<code>jupyter notebook</code>，待打开本地页面之后，选择项目文件打开，之后就请开始你的表演。</p>
<p><img src="https://ws2.sinaimg.cn/large/9150e4e5ly1fg4xzdddjhj20b407u74k.jpg" alt></p>
</li>
</ul>
<h2 id="方法准备"><a href="#方法准备" class="headerlink" title="方法准备"></a>方法准备</h2><p>项目文件中已经给大家列好了基本流程，所以请在开始项目之前，一定要<strong>先整体浏览一遍项目文件</strong>，着重看一下：</p>
<ul>
<li>项目流程</li>
<li>每一个流程中你需要做哪些工作</li>
<li>每一个流程中的提示</li>
</ul>
<p>要记得，数据分析过程不是一蹴而就的，是螺旋上升接近目标的过程，所以一定要保持耐心，对照着<a href="https://review.udacity.com/#!/rubrics/306/view" target="_blank" rel="noopener">项目评估准则</a>一步步完成。</p>
<p>另外，一开始你的notebook会显得很乱没有章法，那在<strong>提交之前最好能再修改一个整理好的版本</strong>。</p>
<h1 id="项目流程（TMDb）"><a href="#项目流程（TMDb）" class="headerlink" title="项目流程（TMDb）"></a>项目流程（TMDb）</h1><h2 id="数据集说明"><a href="#数据集说明" class="headerlink" title="数据集说明"></a>数据集说明</h2><p>本项目选择的数据集为Kaggle提供的TMDb电影数据。此数据集中包含 1 万条电影信息，信息来源为“电影数据库”（TMDb，The Movie Database），包括用户评分和票房等。数据已进行了简单清理，涉及到的变量如下表所示：</p>
<table>
<thead>
<tr>
<th style="text-align:center">变量名</th>
<th style="text-align:center">注释</th>
<th style="text-align:center">变量名</th>
<th style="text-align:center">注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">id</td>
<td style="text-align:center">电影序号</td>
<td style="text-align:center">keywords</td>
<td style="text-align:center">电影关键词</td>
</tr>
<tr>
<td style="text-align:center">imdb_id</td>
<td style="text-align:center">imdb电影序号</td>
<td style="text-align:center">overview</td>
<td style="text-align:center">剧情摘要</td>
</tr>
<tr>
<td style="text-align:center">popularity</td>
<td style="text-align:center">受欢迎程度</td>
<td style="text-align:center">runtime</td>
<td style="text-align:center">电影时长（min）</td>
</tr>
<tr>
<td style="text-align:center">budget</td>
<td style="text-align:center">预算（$）</td>
<td style="text-align:center">genres</td>
<td style="text-align:center">电影风格</td>
</tr>
<tr>
<td style="text-align:center">revenue</td>
<td style="text-align:center">收入</td>
<td style="text-align:center">production_companies</td>
<td style="text-align:center">制作公司</td>
</tr>
<tr>
<td style="text-align:center">original_title</td>
<td style="text-align:center">电影名称</td>
<td style="text-align:center">release_date</td>
<td style="text-align:center">发布日期(月/日/年)</td>
</tr>
<tr>
<td style="text-align:center">cast</td>
<td style="text-align:center">演员表</td>
<td style="text-align:center">vote_count</td>
<td style="text-align:center">评价次数</td>
</tr>
<tr>
<td style="text-align:center">homepage</td>
<td style="text-align:center">电影网址</td>
<td style="text-align:center">vote_average</td>
<td style="text-align:center">平均评分</td>
</tr>
<tr>
<td style="text-align:center">director</td>
<td style="text-align:center">导演</td>
<td style="text-align:center">release_year</td>
<td style="text-align:center">发布年份</td>
</tr>
<tr>
<td style="text-align:center">tagline</td>
<td style="text-align:center">宣传词</td>
<td style="text-align:center">budget_adj</td>
<td style="text-align:center">预算（考虑通胀）</td>
</tr>
<tr>
<td style="text-align:center">revenue_adj</td>
<td style="text-align:center">收入（考虑通胀）</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h2 id="提出问题"><a href="#提出问题" class="headerlink" title="提出问题"></a>提出问题</h2><p>对数据简单浏览之后，你要进行角色扮演了，假如你现在就是一名<strong>电影行业的数据分析师</strong>，通过分析此数据集，你能<strong>为公司提供哪些有用的发现或者规律呢？</strong>或者你只是一名会数据分析的<strong>电影爱好者</strong>，通过分析此数据集，<strong>你能否给小伙伴们推荐一些合适的电影呢？</strong>这里提供几个参考：</p>
<ul>
<li><p>电影类型相关：</p>
<ul>
<li>哪些类型的受欢迎程度最高？随着时间推移有什么变化呢？</li>
<li>随着时间的推移，各类型的数量身上有什么变化呢？</li>
<li>哪些类型赚钱最多？投资收益比呢？</li>
<li>哪些类型拍摄的数量最多？</li>
</ul>
</li>
<li><p>导演相关：</p>
<ul>
<li>哪些导演最能吸金？</li>
<li>哪些导演的电影平均评分最稳定或者最高？</li>
</ul>
</li>
<li><p>制作公司相关：</p>
<ul>
<li>哪些公司最能赚钱？最能赚口碑？评分最稳定或者最高？</li>
</ul>
</li>
<li><p>影响电影评分的要素有哪些？</p>
</li>
<li><p>影响电影收益的要素有哪些？</p>
</li>
<li><p>最近几年的电影都有哪些关键词？</p>
<p>……</p>
</li>
</ul>
<p>整理好你感兴趣的问题后，那就开始吧~</p>
<p>在本示例中，选择的主题为<strong>今晚有空，让好电影与你相伴</strong>，所以我们的目标就是筛选出好看的电影咯~</p>
<h2 id="导入拓展包"><a href="#导入拓展包" class="headerlink" title="导入拓展包"></a>导入拓展包</h2><p>一般来说，就导入如下几个拓展包就够了，当然如果后续操作中还需导入其他包的话，再补充即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用这个框对你计划使用的所有数据包进行设置</span></span><br><span class="line"><span class="comment">#   导入语句。</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="comment"># 务必包含一个‘magic word’，以便将你的视图与 notebook 保持一致。</span></span><br><span class="line">%matplotlib inline</span><br><span class="line"><span class="comment">#关于更多信息，请访问该网页：</span></span><br><span class="line"><span class="comment">#   http://ipython.readthedocs.io/en/stable/interactive/magics.html</span></span><br></pre></td></tr></table></figure>
<h2 id="数据整理"><a href="#数据整理" class="headerlink" title="数据整理"></a>数据整理</h2><h3 id="导入数据"><a href="#导入数据" class="headerlink" title="导入数据"></a>导入数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">'tmdb-movies.csv'</span>)</span><br><span class="line">df.head(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h3 id="评估数据"><a href="#评估数据" class="headerlink" title="评估数据"></a>评估数据</h3><ul>
<li>列及数据类型</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.info()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">pandas</span>.<span class="title">core</span>.<span class="title">frame</span>.<span class="title">DataFrame</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">RangeIndex</span>:</span> <span class="number">10866</span> entries, <span class="number">0</span> to <span class="number">10865</span></span><br><span class="line">Data columns (total <span class="number">21</span> columns):</span><br><span class="line">id                      <span class="number">10866</span> non-null int64</span><br><span class="line">imdb_id                 <span class="number">10856</span> non-null object</span><br><span class="line">popularity              <span class="number">10866</span> non-null float64</span><br><span class="line">budget                  <span class="number">10866</span> non-null int64</span><br><span class="line">revenue                 <span class="number">10866</span> non-null int64</span><br><span class="line">original_title          <span class="number">10866</span> non-null object</span><br><span class="line">cast                    <span class="number">10790</span> non-null object</span><br><span class="line">homepage                <span class="number">2936</span> non-null object</span><br><span class="line">director                <span class="number">10822</span> non-null object</span><br><span class="line">tagline                 <span class="number">8042</span> non-null object</span><br><span class="line">keywords                <span class="number">9373</span> non-null object</span><br><span class="line">overview                <span class="number">10862</span> non-null object</span><br><span class="line">runtime                 <span class="number">10866</span> non-null int64</span><br><span class="line">genres                  <span class="number">10843</span> non-null object</span><br><span class="line">production_companies    <span class="number">9836</span> non-null object</span><br><span class="line">release_date            <span class="number">10866</span> non-null object</span><br><span class="line">vote_count              <span class="number">10866</span> non-null int64</span><br><span class="line">vote_average            <span class="number">10866</span> non-null float64</span><br><span class="line">release_year            <span class="number">10866</span> non-null int64</span><br><span class="line">budget_adj              <span class="number">10866</span> non-null float64</span><br><span class="line">revenue_adj             <span class="number">10866</span> non-null float64</span><br><span class="line">dtypes: float64(<span class="number">4</span>), int64(<span class="number">6</span>), object(<span class="number">11</span>)</span><br><span class="line">memory usage: <span class="number">1.7</span>+ MB</span><br></pre></td></tr></table></figure>
<p>纵然了一下，各列的数据类型没什么问题，唯一一个可能有问题的是<code>release_date</code>列，应该是<code>datetime</code>类型，但因为我们后面的分析中只会用到电影的上映年份，也就是<code>release_year</code>列，所以这列不处理也罢。</p>
<ul>
<li>查看各列的缺失值情况</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.isnull().sum()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">id                         <span class="number">0</span></span><br><span class="line">imdb_id                   <span class="number">10</span></span><br><span class="line">popularity                 <span class="number">0</span></span><br><span class="line">budget                     <span class="number">0</span></span><br><span class="line">revenue                    <span class="number">0</span></span><br><span class="line">original_title             <span class="number">0</span></span><br><span class="line">cast                      <span class="number">76</span></span><br><span class="line">homepage                <span class="number">7930</span></span><br><span class="line">director                  <span class="number">44</span></span><br><span class="line">tagline                 <span class="number">2824</span></span><br><span class="line">keywords                <span class="number">1493</span></span><br><span class="line">overview                   <span class="number">4</span></span><br><span class="line">runtime                    <span class="number">0</span></span><br><span class="line">genres                    <span class="number">23</span></span><br><span class="line">production_companies    <span class="number">1030</span></span><br><span class="line">release_date               <span class="number">0</span></span><br><span class="line">vote_count                 <span class="number">0</span></span><br><span class="line">vote_average               <span class="number">0</span></span><br><span class="line">release_year               <span class="number">0</span></span><br><span class="line">budget_adj                 <span class="number">0</span></span><br><span class="line">revenue_adj                <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>可见数据集的情况很不错，几个关键列几乎没有缺失。至于<code>director</code>列的缺失，你可以依照电影标题去搜索它的导演，然后进行填充，或者干脆直接删除掉。</p>
<ul>
<li>查看重复值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum(df.duplicated())</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>有一行重复数据，过会儿直接清理掉。</p>
<ul>
<li>查看基本数据统计情况</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe()</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/09/04/iSxdmD.png" alt="iSxdmD.png"></p>
<p>因为这是在数据评估阶段，所以着重看min和max，检查是否有异常值。本数据集中没什么问题。</p>
<ul>
<li><p>查看各列元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'column_name'</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>可以查看各列的详细情况，避免因为折叠而忽略了某些严重问题。</p>
<p>比如说，我们通过查看各列情况，发现<code>cast</code>、<code>keywords</code>、<code>genres</code>和<code>production_companies</code>这四列中的都包含有以<code>|</code>分隔开的多个平级元素，这在进行之后的按类分析时会非常不便，所以需要清理。（但也不是这四列都要清理，只用清理你的分析中会用到的就行。）</p>
<p> <a href="https://imgchr.com/i/iSzMgP" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/04/iSzMgP.png" alt="iSzMgP.png"></a></p>
<p>还有就是<code>budget_adj</code>和<code>revenue_adj</code>两列是科学记数法，在进行可视化的时候，坐标轴的显示肯定就会很丑，到时候要注意处理。</p>
<h3 id="清理数据"><a href="#清理数据" class="headerlink" title="清理数据"></a>清理数据</h3><blockquote>
<p>清理数据就是对上一步中发现的问题进行清理，并且删除无关列，最终得到的是一个方便你进行分析及可视化的干净数据。</p>
<p><strong>清理前记得备份数据</strong></p>
</blockquote>
<ul>
<li><p>数据备份</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_clean = df.copy()</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除无关列</p>
<p>在本次示例项目中，我们的目的是找出好看的电影，所以评分和受欢迎程度是关键参数，然后再探索下他们与其他参数之间是否存在联系。</p>
<p>那就按照如下方法删除一些无关列（其实是筛选出想要的列，顺便再拍一下序）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = df[[<span class="string">'original_title'</span>,<span class="string">'production_companies'</span>,<span class="string">'director'</span>,<span class="string">'cast'</span>,<span class="string">'genres'</span>,<span class="string">'keywords'</span>,<span class="string">'runtime'</span>,<span class="string">'popularity'</span>,<span class="string">'vote_count'</span>,<span class="string">'vote_average'</span>,<span class="string">'release_year'</span>,<span class="string">'budget_adj'</span>,<span class="string">'revenue_adj'</span>]]</span><br></pre></td></tr></table></figure>
</li>
<li><p>缺失值的处理</p>
<p>因为关键列并没有出现数据缺失，所以并未进行处理。</p>
</li>
<li><p>删除重复值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.drop_duplicates(inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>genres</code>列处理</p>
<p>电影类型是关键筛选条件，所以要细分。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将genres列转为str格式（因为NaN是float格式的）</span></span><br><span class="line">df_clean.genres = df_clean.genres.astype(str)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取所有的电影类型</span></span><br><span class="line">genres_set = set()   <span class="comment">#定义空集合</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> df_clean[<span class="string">'genres'</span>]:</span><br><span class="line">    genres_set.update(x.split(<span class="string">'|'</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#从genres_set中删除nan</span></span><br><span class="line">genres_set.remove(<span class="string">'nan'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将各电影类型作为列添加到数据集中,并用1表示‘是’，0表示‘否’</span></span><br><span class="line"><span class="keyword">for</span> genres <span class="keyword">in</span> genres_set:</span><br><span class="line">    df_clean[genres] = df_clean[<span class="string">'genres'</span>].str.contains(genres).apply(<span class="keyword">lambda</span> x:<span class="number">1</span> <span class="keyword">if</span> x <span class="keyword">else</span> <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除genres列，并检查</span></span><br><span class="line">df_clean.drop(<span class="string">'genres'</span>,axis = <span class="number">1</span>,inplace = <span class="literal">True</span>)</span><br><span class="line">df_clean.head(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>production_companies</code>列处理</p>
<p>属于电影的参考列，所以我们只筛选首公司。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#只筛选第一家主要投资的公司</span></span><br><span class="line">df_clean.production_companies = df_clean.production_companies.str.split(<span class="string">'|'</span>).str[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#为了符合逻辑，更改列名</span></span><br><span class="line">df_clean.rename(columns = &#123;<span class="string">'production_companies'</span>:<span class="string">'production_company'</span>&#125;,inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>cast</code>列处理</p>
<p>演员也是电影的参考列，只筛选出两名主演。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#筛选前两位主演</span></span><br><span class="line">df_clean[<span class="string">'major_actor_1'</span>] = df_clean.cast.str.split(<span class="string">'|'</span>).str[<span class="number">0</span>]</span><br><span class="line">df_clean[<span class="string">'major_actor_2'</span>] = df_clean.cast.str.split(<span class="string">'|'</span>).str[<span class="number">1</span>]</span><br><span class="line"><span class="comment">#删除cast列</span></span><br><span class="line">df_clean.drop(<span class="string">'cast'</span>,axis = <span class="number">1</span>,inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加<code>income_adj</code>列</p>
<p>原数据中只有<code>budget_adj</code>和<code>revenue_adj</code>列，后者减去前者即为电影的收益。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_clean[<span class="string">'income_adj'</span>] = df_clean[<span class="string">'revenue_adj'</span>] - df_clean[<span class="string">'budget_adj'</span>]</span><br></pre></td></tr></table></figure>
<p>至此，清理数据告一段落。</p>
</li>
</ul>
<h2 id="探索性数据分析"><a href="#探索性数据分析" class="headerlink" title="探索性数据分析"></a>探索性数据分析</h2><p>在这个阶段你可以随意做可视化，尽可能多得去探索你想解决的问题。<strong>在探索阶段，作图可以不用很规范，你自己知道是什么意思就可以</strong>，而且可能会有些探索的问题结果意义不大，所以<strong>在提交项目时，要进行择优保留并对其润色修饰</strong>。</p>
<h3 id="探索受欢迎程度及评分"><a href="#探索受欢迎程度及评分" class="headerlink" title="探索受欢迎程度及评分"></a>探索受欢迎程度及评分</h3><p>电影的受欢迎程度和平均评分是我们在进行电影推荐时的主要参考，所以我们先来观察下这两列的主要分布情况以及与其他列的相关性。</p>
<ul>
<li>分布情况</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#受欢迎程度的分布情况</span></span><br><span class="line">df_clean[<span class="string">'popularity'</span>].plot(kind = <span class="string">'hist'</span>,bins = <span class="number">200</span>,title = <span class="string">'The Distribution of Popularity(log)'</span>,logx = <span class="literal">True</span>,figsize = (<span class="number">8</span>,<span class="number">6</span>))<span class="comment">#这里采用了x轴的对数坐标，考虑下为什么呢？</span></span><br><span class="line">plt.ylabel(<span class="string">'Count of Movies'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'Popularity(log)'</span>);</span><br></pre></td></tr></table></figure>
<p><a href="https://imgchr.com/i/ipxy2q" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/05/ipxy2q.png" alt="ipxy2q.png"></a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#平均评分的分布情况</span></span><br><span class="line">df_clean[<span class="string">'vote_average'</span>].plot(kind = <span class="string">'hist'</span>,bins = <span class="number">30</span>,title = <span class="string">'The Distribution of Average Rating'</span>,figsize = (<span class="number">8</span>,<span class="number">6</span>))<span class="comment">#这里就是用的普通的x轴坐标，为什么呢？</span></span><br><span class="line">plt.ylabel(<span class="string">'Count of Movies'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'Average Rating'</span>);</span><br></pre></td></tr></table></figure>
<p><a href="https://imgchr.com/i/ipx7xx" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/05/ipx7xx.png" alt="ipx7xx.png"></a></p>
<p>通过观察这两幅图我们可以发现：绝大部分的电影受欢迎程度都在10以下，平均评分却是一个类正态分布，电影评分集中在5到7之间。</p>
<ul>
<li><p>与上映年份的关系</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#受欢迎程度</span></span><br><span class="line">df_clean.groupby(<span class="string">'release_year'</span>)[<span class="string">'popularity'</span>].mean().plot(kind = <span class="string">'line'</span>)</span><br><span class="line">plt.hlines(df_clean[<span class="string">'popularity'</span>].quantile(<span class="number">.75</span>),xmin = <span class="number">1960</span>,xmax = <span class="number">2015</span>,color = <span class="string">'red'</span>);</span><br></pre></td></tr></table></figure>
<p><a href="https://imgchr.com/i/ipz9zt" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/05/ipz9zt.png" alt="ipz9zt.png"></a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#评分</span></span><br><span class="line">df_clean.groupby(<span class="string">'release_year'</span>)[<span class="string">'vote_average'</span>].mean().plot(kind = <span class="string">'line'</span>)</span><br><span class="line">plt.hlines(df_clean[<span class="string">'vote_average'</span>].quantile(<span class="number">.75</span>),xmin = <span class="number">1960</span>,xmax = <span class="number">2015</span>,color = <span class="string">'red'</span>);</span><br></pre></td></tr></table></figure>
<p><a href="https://imgchr.com/i/ipzpRI" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/05/ipzpRI.png" alt="ipzpRI.png"></a></p>
</li>
</ul>
<p>通过观察这两幅可视化，我们发现：随着上映日期逐渐接近现在，受欢迎程度呈波动上升趋势，但是评分却是波动下降。这应该是因为年代越久远的电影观看人数越少，评分次数也就越少（需附图验证），个别的高评分对平均评分的影响也就越大，这才导致了受欢迎程度低却评分高的现象。</p>
<ul>
<li>与其他数值型变量的关系</li>
</ul>
<p>本数据集中的数值型变量不是很多，但要是一对一对的去看他们之间的相关性会很累，<del>懒人</del>智者推动科技进步嘛，前辈们帮我们都考虑好了，可以参考下面的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#筛选出数值变量</span></span><br><span class="line">df_corr = df_clean[[<span class="string">'runtime'</span>,<span class="string">'popularity'</span>,<span class="string">'vote_count'</span>,<span class="string">'vote_average'</span>,<span class="string">'budget_adj'</span>,<span class="string">'revenue_adj'</span>,<span class="string">'income_adj'</span>]]</span><br></pre></td></tr></table></figure>
<p><strong>各变量之间相关性的热度图</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots(figsize=(<span class="number">10</span>, <span class="number">6</span>)) </span><br><span class="line">corr = df_corr.corr() <span class="comment">#计算相关性</span></span><br><span class="line">hm = sns.heatmap(round(corr,<span class="number">2</span>), annot=<span class="literal">True</span>, ax=ax, cmap=<span class="string">"coolwarm"</span>,fmt=<span class="string">'.2f'</span>, linewidths=<span class="number">.05</span>) </span><br><span class="line">fig.subplots_adjust(top=<span class="number">0.93</span>) </span><br><span class="line">fig.suptitle(<span class="string">'Movie Attributes Correlation Heatmap'</span>, fontsize=<span class="number">14</span>);</span><br></pre></td></tr></table></figure>
<p><a href="https://imgchr.com/i/i97tOJ" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/09/06/i97tOJ.png" alt="i97tOJ.png"></a></p>
<p>从这幅图里面，可以很明显的读出一些信息：</p>
<ul>
<li>受欢迎程度与评分人数有较强的正相关关系，与收益的正相关程度也稍强，这很好理解；</li>
<li>平均评分却鲜有相关的变量，那影响评分的因素都有哪些呢？（导演？主演？制片公司？）</li>
</ul>
<p><strong>pairplot</strong></p>
<p>你不满足于只看冷冰冰的数字，想看到更直观的散点图或者直方图，那就请参考如下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pp = sns.pairplot(df_corr, size=<span class="number">1.8</span>, aspect=<span class="number">1.8</span>, plot_kws=dict(edgecolor=<span class="string">"k"</span>, linewidth=<span class="number">0.5</span>), diag_kind=<span class="string">"kde"</span>, diag_kws=dict(shade=<span class="literal">True</span>)) </span><br><span class="line">fig = pp.fig </span><br><span class="line">fig.subplots_adjust(top=<span class="number">0.93</span>, wspace=<span class="number">0.3</span>) </span><br><span class="line">t = fig.suptitle(<span class="string">'Movie Attributes Pairwise Plots'</span>, fontsize=<span class="number">14</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/09/06/i9HinJ.png" alt="i9HinJ.png"></p>
<p>从上面这幅可视化中，我们不仅能看到各变量两两之间的散点图（相关性），还能看到各变量的分布情况，真可谓是大杀器。</p>
<p>那，热度与评分和其他分类变量有没有什么关系呢？</p>
<p>…（请继续探索）</p>
<p>… KEEP GOING</p>
<h3 id="电影推荐"><a href="#电影推荐" class="headerlink" title="电影推荐"></a>电影推荐</h3><p>在做电影推荐时，受欢迎程度和评分是我们的关键评估指标。</p>
<ul>
<li>按电影类型推荐</li>
</ul>
<p>比如说，你有一个哥们比较喜欢看<code>Adventure</code>类的电影，听说你在做TMDb的电影数据分析，所以来找你推荐，你会推荐哪些呢？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#首先我们要筛选出Adventure类的电影</span></span><br><span class="line">df_Ad = df_clean[df_clean[<span class="string">'Adventure'</span>] == <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#既然是推荐，自然要筛选一些热门的评分高的电影，所以这里我们选择了好于其他90%的电影（结果为15部电影）</span></span><br><span class="line">df_Ad_po = df_Ad[df_Ad.popularity &gt; df_Ad.popularity.quantile(<span class="number">.9</span>)]</span><br><span class="line">df_Ad_po_vo = df_Ad_po[df_Ad_po.vote_average &gt; df_Ad_po.vote_average.quantile(<span class="number">.9</span>)]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#排序</span></span><br><span class="line">df_Ad_po_vo.sort_values(by = <span class="string">'popularity'</span>,inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可视化</span></span><br><span class="line">sns.set(style=<span class="string">"white"</span>)<span class="comment">#小美化一下</span></span><br><span class="line"></span><br><span class="line">x = df_Ad_po_vo.original_title</span><br><span class="line">y = df_Ad_po_vo[<span class="string">'popularity'</span>]</span><br><span class="line"><span class="comment">#排序能让可视化更美观</span></span><br><span class="line">plt.yticks(np.arange(len(x)), x)</span><br><span class="line">plt.barh(np.arange(len(x)),y);</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/09/05/i9kJRe.png" alt="i9kJRe.png"></p>
<p>结论立马就出来了，首推的电影就是Interstellar（星际穿越）。当然这种方法可以定义成一个函数，参数即为<code>电影类型</code>，这样就能省心省力的得到所有电影的最热最佳推荐了。</p>
<p>当然，你还可以尝试：</p>
<ul>
<li><p>按导演推荐</p>
<p> 我一开始想着用groupby直接按照导演分类，然后求评分的均值再作图，可是结果并不如人意。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_clean.groupby(<span class="string">'director'</span>)[<span class="string">'vote_average'</span>].mean().sort_values()[<span class="number">-15</span>:].plot(kind = <span class="string">'barh'</span>,color = <span class="string">'b'</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/09/06/iCNGXd.png" alt="iCNGXd.png"></p>
<p>这些导演好像都不是很熟悉，应该是数据集中只收录了一部或者很少的电影作品，然而又因为这些作品的评分较高，才导致这种情况，所以我们要先对导演做一个筛选，比如说，筛选出收入作品数量在10部及以上的导演。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#先对原数据中的director列作计数统计，然后筛选大于等于10的数据存为一个新的DataFrame（目的是为了方便筛选）</span></span><br><span class="line">df_director = pd.DataFrame(df_clean.director.value_counts() &gt;= <span class="number">10</span>)</span><br><span class="line"><span class="comment">#将10部及以上作品的导演存为一个列表</span></span><br><span class="line">directors = list(df_director[df_director[<span class="string">'director'</span>]].index)</span><br><span class="line"><span class="comment">#然后使用isin函数，筛选原数据中在directors列表中的导演，并求均值作图</span></span><br><span class="line"><span class="comment">#平均评分</span></span><br><span class="line">df_clean[df_clean.director.isin(directors)].groupby(<span class="string">'director'</span>)[<span class="string">'vote_average'</span>].mean().sort_values()[<span class="number">-10</span>:].plot(kind = <span class="string">'barh'</span>,color = <span class="string">'b'</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/09/06/iCUhVI.png" alt="iCUhVI.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#受欢迎程度</span></span><br><span class="line">df_clean[df_clean.director.isin(directors)].groupby(<span class="string">'director'</span>)[<span class="string">'popularity'</span>].mean().sort_values()[<span class="number">-10</span>:].plot(kind = <span class="string">'barh'</span>,color = <span class="string">'b'</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/09/06/iCUWqA.png" alt="iCUWqA.png"></p>
<p>这次得到的结果更大众一些，出现的导演名字也基本都听过。Christopher Nolan和Quentin分别获得了双料榜首和榜眼，这两个人的名字也算是电影的品质保证了吧。</p>
<ul>
<li><p>按主演推荐</p>
</li>
<li><p>按制片公司推荐</p>
<p> … …</p>
</li>
</ul>
<p>当然，你还可以分析电影评分与其他变量的相关性，或者从效益角度出发，去分析票房、预算、收益等等。但万变不离其宗，用数据分析的流程做指导，所学知识为基础，Bing或者Google为利剑（搜索的时间可能要占到一半以上，所以不要慌，搜索完记在小本本上），开始你的项目三征服之路吧！</p>
<h2 id="得出结论"><a href="#得出结论" class="headerlink" title="得出结论"></a>得出结论</h2><p>对你整理好的可视化图像进行总结，结论要有根有据但也不要只是停留在<code>描述</code>，可以进行适当的猜测。</p>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><ul>
<li>导学只是参考和分享，我是还原了自己在做项目时的思路历程，这并不是提交项目时应有的样子。</li>
<li>记得提交前一定要再重新审视一遍，调整代码，注释，修缮可视化及结论。</li>
<li>经过P3的历练，相信你能更自信，也更能有成就感，坚持！！</li>
<li>加油！！！</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/28/2018-8-28-第七周-Matplotlib可视化/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/08/28/2018-8-28-第七周-Matplotlib可视化/" class="post-title-link" itemprop="url">每周导学-第七周-Matplotlib可视化</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-08-28 12:30:09" itemprop="dateCreated datePublished" datetime="2018-08-28T12:30:09+08:00">2018-08-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-03 12:51:55" itemprop="dateModified" datetime="2019-04-03T12:51:55+08:00">2019-04-03</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2018/08/28/2018-8-28-第七周-Matplotlib可视化/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/08/28/2018-8-28-第七周-Matplotlib可视化/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>If you don’t like where you are , change it. You’re not a tree.</p>
</blockquote>
<p>Hi，同学们，上一周我们学习了数据分析的基本流程，以及Pandas在数据分析各个流程中的应用，本周呢就是在上周的基础上，掌握Python数据分析可视化的基础知识，包括<strong>matplotlib</strong>及<strong>pandas可视化</strong>。可视化是数据分析的重要环节，是你进行探索性数据分析、得出结论、传达结果的关键，所以，一定的可视化技巧是非常必须的，除了本章涉及到的两个知识点外，我还会在最后提供一些其他的python可视化库链接和其他可视化软件的链接，希望大家能不满足于导学，而去积极求索，加油！！</p>
<p>本周开始，我们就进入到了<strong>项目三(P3)阶段</strong>，本阶段总共包含<strong>四周</strong>，在这一个月内，我们要对<strong>数据分析入门</strong>进行学习，学习数据分析思维，掌握Python数据分析及可视化方法，并使用所学知识完成<strong>项目三：探索数据集</strong>，尝试着自己完成整个数据分析的流程，得到一些饶有兴趣的结论，你一定会非常有成就感哒！那么以下便是这四周的学习安排：</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody>
<tr>
<td>第1周</td>
<td>数据分析过程-1</td>
<td>数据分析过程&amp;案例研究-1</td>
</tr>
<tr>
<td><strong>第2周</strong></td>
<td><strong>数据分析过程-2</strong></td>
<td><strong>案例研究-1&amp;案例研究-2</strong></td>
</tr>
<tr>
<td>第3周</td>
<td>完成项目</td>
<td>项目：探索数据集</td>
</tr>
<tr>
<td>第4周</td>
<td>项目修改与通过</td>
<td>修改项目、查缺补漏、休息调整</td>
</tr>
</tbody>
</table>
<font size="3" color="red"><strong>！！看这里！！</strong>：在P3课程里面安排了SQL的高阶课程，但是因为在项目三中并不会涉及到SQL知识，所以为了保证大家学习的连贯性，在完成前两周的课程之后，就开始项目。至于<strong>！！SQL的高阶知识，大家可以放在课程通关后进行选修！！</strong>； </font>

<p>本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/百度搜索、<a href="http://www.runoob.com/python3/python3-tutorial.html" target="_blank" rel="noopener">菜鸟教程</a>、<a href="https://www.csdn.net/" target="_blank" rel="noopener">CSDN</a>、<a href="https://stackoverflow.com/" target="_blank" rel="noopener">stack<strong>overflow</strong></a>、<a href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/Python%20for%20Data%20Analysis%2C%202nd%20Edition.pdf" target="_blank" rel="noopener"><strong>Python for Data Analysis, 2nd Edition</strong> </a>、<a href="http://python3-cookbook.readthedocs.io/zh_CN/latest/" target="_blank" rel="noopener">Python Cookbook</a></li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p><strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><ul>
<li>学习总结课程中<strong>数据分析过程</strong>及<strong>案例研究1&amp;2</strong>中所用到的可视化知识，掌握可视化在数据分析中的应用。</li>
</ul>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>案例研究1&amp;2</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody>
</table>
<h1 id="本周知识清单"><a href="#本周知识清单" class="headerlink" title="本周知识清单"></a>本周知识清单</h1><h1 id="matplotlib"><a href="#matplotlib" class="headerlink" title="matplotlib"></a>matplotlib</h1><p>matplotlib是Python泰斗级别的绘图库，因受到Matlab的启发构建而成，所以你会觉得它的命令API，还有那九十年代感强烈的可视化图像跟matlab很相似。它非常适合在jupyter notebook中交互式作图，这个库“功能非常强大”，但也“非常复杂”，所以这里只能介绍matplotlib的一些基础和常用的方法，想了解更多就需要你自主探索啦！</p>
<ul>
<li>导入matplotlib</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>
<ul>
<li>在notebook中使用</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#想在Jupyter Notebook中顺利显示出可视化图像，你需要添加如下代码</span></span><br><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure>
<h2 id="官方链接"><a href="#官方链接" class="headerlink" title="官方链接"></a>官方链接</h2><p>你可以点击<a href="https://matplotlib.org/api/pyplot_summary.html" target="_blank" rel="noopener">matplotlib.pyplot</a>搜索查看一些函数的说明和用法；或者你可以点击<a href="https://matplotlib.org/gallery/index.html#pyplot" target="_blank" rel="noopener">Pyplot Gallery</a>查看一些代码实例，找到灵感。</p>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p>在使用matplotlib生成图像时，整个图像为一个Figure对象。在Figure对象中可以包含一个，或者多个Axes对象。每个Axes对象都是一个拥有自己坐标系统的绘图区域。其逻辑关系如下：</p>
<p><img src="https://s1.ax1x.com/2018/08/24/P7zm2n.jpg" alt="P7zm2n.jpg"></p>
<p>在如下的单图fig中，我们给出了我们的绘图中只有一个坐标系区域（也就是ax），此外还有以下对象：</p>
<ul>
<li>Data: 数据区，包括数据点、描绘形状</li>
<li>Axis: 坐标轴，包括 X 轴、 Y 轴及其标签、刻度尺及其标签</li>
<li>Title: 标题，数据图的描述</li>
<li>Legend: 图例，区分图中包含的多种曲线或不同分类的数据</li>
<li>其他的还有图形文本 (Text)、注解 (Annotate)等其他描述</li>
</ul>
<p><img src="https://s1.ax1x.com/2018/08/24/P7zQbT.jpg" alt="P7zQbT.jpg"></p>
<p>各个对象之间的隶属关系如下图所示：</p>
<p><img src="https://s1.ax1x.com/2018/08/24/P7zMrV.jpg" alt="P7zMrV.jpg"></p>
<p>所以大家在之后进行可视化的时候，根据这些隶属关系来去对参数进行设置，这样逻辑不乱，代码也清晰。</p>
<h2 id="常用参数设置"><a href="#常用参数设置" class="headerlink" title="常用参数设置"></a>常用参数设置</h2><h3 id="开始绘图"><a href="#开始绘图" class="headerlink" title="开始绘图"></a>开始绘图</h3><p>在绘图前，首先需要设置的就是fig(画布)和ax(图)，我们主要通过plt.subplots()函数来定义</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#绘制单图</span></span><br><span class="line">fig, ax = plt.subplots()</span><br></pre></td></tr></table></figure>
<p><a href="https://imgchr.com/i/Pbp9aT" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/25/Pbp9aT.png" alt="Pbp9aT.png"></a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#绘制多图，subplots的第一个参数为行数，第二个参数为列数</span></span><br><span class="line">fig,(ax1,ax2) = plt.subplots(<span class="number">1</span>,<span class="number">2</span>,sharey = <span class="literal">True</span>)<span class="comment">#设置共享y轴</span></span><br></pre></td></tr></table></figure>
<p><a href="https://imgchr.com/i/PbSzq0" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/25/PbSzq0.png" alt="PbSzq0.png"></a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#绘制多图时，注意前面的变量为一个矩阵的形式，如下前面为2x2矩阵，则后面subplots的行列参数也应该都为2</span></span><br><span class="line">fig,((ax1,ax2),(ax3,ax4)) = plt.subplots(<span class="number">2</span>,<span class="number">2</span>,sharex = <span class="literal">True</span>)<span class="comment">#设置共享x轴</span></span><br></pre></td></tr></table></figure>
<p><a href="https://imgchr.com/i/PbppZV" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/25/PbppZV.png" alt="PbppZV.png"></a></p>
<h3 id="另一种添加子图的方法"><a href="#另一种添加子图的方法" class="headerlink" title="另一种添加子图的方法"></a>另一种添加子图的方法</h3><p>绘制子图主要使用的函数为：add_subplot(abc)，调用该函数会生成一个包含axb个子图的画布，而c则表示位置，按照从左至右，从上至下的顺序依次排列。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(1,100)</span><br><span class="line"></span><br><span class="line">fig = plt.figure() #定义画布</span><br><span class="line">ax1 = fig.add_subplot(221) # 定义2*2个子图（1表示左一）</span><br><span class="line">ax1.plot(x,x) # 绘制左一折线图</span><br><span class="line"></span><br><span class="line">ax2 = fig.add_subplot(222)</span><br><span class="line">ax2.plot(x,-x) # 绘制右一折线图（右一）</span><br><span class="line"></span><br><span class="line">ax3 = fig.add_subplot(223)</span><br><span class="line">ax3.plot(x,x*x) # 绘制左二折线图（左二）</span><br><span class="line"></span><br><span class="line">ax4 = fig.add_subplot(224)</span><br><span class="line">ax4.plot(x,np.log(x)); # 绘制右二折线图（右二），添加分号可以只显示图像</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/24/PHCqtU.png" alt="PHCqtU.png"></p>
<h3 id="坐标轴设置"><a href="#坐标轴设置" class="headerlink" title="坐标轴设置"></a>坐标轴设置</h3><ul>
<li><p>调整范围</p>
<p>主要是用来利用调整坐标轴范围进行图像的截取，可以使用ax.axis()函数，也可使用plt.xlim()或者plt.ylim()函数，具体用法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ax.axis([0,10,0,50]) [x左，x右，y下，y上]</span></span><br><span class="line">x = np.arange(<span class="number">-10</span>,<span class="number">10</span>,<span class="number">0.1</span>)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax.plot(x,x**<span class="number">2</span>)</span><br><span class="line">ax.axis([<span class="number">0</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">50</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#plt.xlim([0,10]) ，调整x轴坐标范围</span></span><br><span class="line"><span class="comment">#plt.ylim([0,50]) ，调整y轴坐标范围</span></span><br><span class="line">fig1 = plt.figure()</span><br><span class="line">ax1 = fig1.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax1.plot(x,x**<span class="number">2</span>)</span><br><span class="line">plt.xlim([<span class="number">0</span>,<span class="number">10</span>])</span><br><span class="line">plt.ylim([<span class="number">0</span>,<span class="number">50</span>]);</span><br></pre></td></tr></table></figure>
<p><a href="https://imgchr.com/i/PHO6UJ" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/25/PHO6UJ.png" alt="PHO6UJ.png"></a><br><a href="https://imgchr.com/i/PHOyE4" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/25/PHOyE4.png" alt="PHOyE4.png"></a></p>
</li>
<li><p>坐标轴刻度调整</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#利用ax.locator_params()设置刻度间隔</span></span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">0</span>,<span class="number">11</span>,<span class="number">0.1</span>)</span><br><span class="line">fig1 = plt.figure()</span><br><span class="line">ax1  = fig1.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax1.plot(x,x)</span><br><span class="line"><span class="comment">#ax1.locator_params(nbins=20) #同时调整x轴与y轴</span></span><br><span class="line"><span class="comment">#ax1.locator_params('x',nbins=20) #只调整x轴</span></span><br><span class="line">ax1.locator_params(<span class="string">'y'</span>,nbins=<span class="number">20</span>) <span class="comment">#只调整y轴</span></span><br><span class="line">plt.axis([<span class="number">0</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">10</span>]);</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/25/PHv3DK.png" alt="PHv3DK.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#利用plt.xticks()设置x轴刻度顺序/旋转角度</span></span><br><span class="line">plt.xticks([<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">4</span>], [<span class="string">'Tom'</span>, <span class="string">'Dick'</span>, <span class="string">'Harry'</span>, <span class="string">'Sally'</span>, <span class="string">'Sue'</span>],  rotation=<span class="number">30</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/25/PHvH54.png" alt="PHvH54.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#时间刻度调整</span></span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"></span><br><span class="line">start = datetime.datetime(<span class="number">2018</span>,<span class="number">7</span>,<span class="number">1</span>)</span><br><span class="line">stop  = datetime.datetime(<span class="number">2018</span>,<span class="number">8</span>,<span class="number">1</span>)</span><br><span class="line">delta = datetime.timedelta(days=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">dates = mpl.dates.drange(start,stop,delta)</span><br><span class="line">y = np.random.rand(len(dates))</span><br><span class="line"></span><br><span class="line">fig2 = plt.figure()</span><br><span class="line">ax2  = fig2.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax2.plot_date(dates,y,linestyle=<span class="string">'-'</span>,marker=<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#日期格式调整，关键代码</span></span><br><span class="line">date_format= mpl.dates.DateFormatter(<span class="string">'%Y-%m-%d'</span>)</span><br><span class="line">ax2.xaxis.set_major_formatter(date_format)</span><br><span class="line">fig2.autofmt_xdate();<span class="comment">#防止刻度重叠</span></span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/25/PHxRoD.png" alt="PHxRoD.png"></p>
</li>
<li><p>双轴</p>
<p>有时候想要在同一张图中显示两种不同范围的变量，这时候就要设置双轴</p>
<p>双轴的关键代码为twinx()函数（也就是双胞胎x轴？）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(1,11,0.1)</span><br><span class="line">y1 = x*x</span><br><span class="line">y2 = np.log(x)</span><br><span class="line"></span><br><span class="line">fig1 = plt.figure()</span><br><span class="line">ax1 = fig1.add_subplot(111)</span><br><span class="line">plt.ylabel(&apos;Y1&apos;)</span><br><span class="line">ax2 = ax1.twinx()#关键代码</span><br><span class="line">plt.ylabel(&apos;Y2&apos;,rotation=270)#注意添加ylabel的顺序不能错，旋转显示</span><br><span class="line"></span><br><span class="line">ax1.plot(x,y1)</span><br><span class="line">ax2.plot(x,y2,&apos;--r&apos;);</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/25/PbpYLt.png" alt="PbpYLt.png"></p>
</li>
</ul>
<h3 id="标题与轴标题"><a href="#标题与轴标题" class="headerlink" title="标题与轴标题"></a>标题与轴标题</h3><p>标题与轴标题都是一幅可视化图像中的必须要素。你可以参考如下示例来设置你的标题与轴标题。</p>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">plt.title(<span class="string">'This is title'</span>,color = <span class="string">'r'</span>,fontsize = <span class="number">17</span>)</span><br><span class="line">plt.xlabel(<span class="string">'This is xlabel'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'This is ylabel'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">##其等效于：</span></span><br><span class="line"><span class="comment"># fig,ax = plt.subplots()</span></span><br><span class="line"><span class="comment"># ax.set_title('This is title',color = 'r',fontsize = 17)</span></span><br><span class="line"><span class="comment"># ax.set_xlabel('This is xlabel')</span></span><br><span class="line"><span class="comment"># ax.set_ylabel('This is xlabel');</span></span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/28/PLvbp4.png" alt="PLvbp4.png"></p>
<h3 id="图例"><a href="#图例" class="headerlink" title="图例"></a>图例</h3><p>图例在进行多变量比较的可视化中必不可少。你可以通过在plot()函数中添加参数’label’来对所绘曲线设置图例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(<span class="number">1</span>,<span class="number">11</span>,<span class="number">1</span>)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">line1 = ax.plot(x,x*<span class="number">2</span>,label=<span class="string">'Bad'</span>)</span><br><span class="line">line2 = ax.plot(x,x*<span class="number">3</span>,label=<span class="string">'Normal'</span>)</span><br><span class="line">line3 = ax.plot(x,x*<span class="number">4</span>,label=<span class="string">'Good'</span>)</span><br><span class="line">plt.legend(loc=<span class="string">'best'</span>);</span><br></pre></td></tr></table></figure>
<p><a href="https://imgchr.com/i/PLKnTU" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/27/PLKnTU.png" alt="PLKnTU.png"></a></p>
<p>也可以通过调用plt.legend()函数对图例进行设置。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(<span class="number">1</span>,<span class="number">11</span>,<span class="number">1</span>)</span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">line1, = ax.plot(x,x*<span class="number">2</span>) <span class="comment">#注意line1后面的逗号,不可缺少</span></span><br><span class="line">line2, = ax.plot(x,x*<span class="number">3</span>)</span><br><span class="line">line3, = ax.plot(x,x*<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">plt.legend(handles = [line1, line2, line3],labels = [<span class="string">'Bad'</span>, <span class="string">'Normal'</span>, <span class="string">'Good'</span>],loc = <span class="string">'best'</span>);</span><br></pre></td></tr></table></figure>
<p><a href="https://imgchr.com/i/PLKmwT" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/27/PLKmwT.png" alt="PLKmwT.png"></a></p>
<h3 id="颜色与样式"><a href="#颜色与样式" class="headerlink" title="颜色与样式"></a>颜色与样式</h3><p>调用matplotlib.pyplot.plot函数即可设置所画图像的颜色与样式，设置方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(x,y,&apos;[color][marker][line]&apos;)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>常用颜色</p>
<p>| 字符    | 颜色    | 字符 | 颜色   |<br>| ——- | ——- | —- | —— |<br>| b       | 蓝色    | g    | 绿色   |<br>| r       | 红色    | y    | 黄色   |<br>| c       | 青色    | k    | 黑色   |<br>| m       | 洋红色  | w    | 白色   |<br>| #rrggbb | RGB颜色 | 0.7  | 灰度值 |</p>
</li>
<li><p>常用线条样式</p>
<p>| 字符 | 描述         | 字符            | 描述          |<br>| —- | ———— | ————— | ————- |<br>| ‘-‘  | 实线         | ‘:’             | 虚线(·······) |<br>| ‘–’ | 虚线(——) | ‘None’或’ ‘或’’ | 什么都不画    |<br>| ‘-.’ | 点划线       |                 |               |</p>
</li>
<li><p>线条标记</p>
<p>| 字符          | 描述    | 字符 | 描述             |<br>| ————- | ——- | —- | —————- |<br>| ‘o’           | 圆圈    | ‘.’  | 点               |<br>| ‘D’           | 菱形    | ‘s’  | 正方形           |<br>| ‘h’           | 六边形1 | ‘*’  | 星号             |<br>| ‘H’           | 六边形2 | ‘d’  | 小菱形           |<br>| ‘_’           | 水平线  | ‘v’  | 一角朝下的三角形 |<br>| ‘8’           | 八边形  | ‘&lt;’  | 一角朝左的三角形 |<br>| ‘p’           | 五边形  | ‘&gt;’  | 一角朝右的三角形 |<br>| ‘,’           | 像素    | ‘^’  | 一角朝上的三角形 |<br>| ‘+’           | 加号    | ‘\‘ | 竖线             |<br>| ‘None’,’’,’ ‘ | 无      | ‘x’  | X                |</p>
</li>
</ul>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fig,ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">y=np.arange(<span class="number">1</span>,<span class="number">5</span>)</span><br><span class="line">ax.plot(y,<span class="string">'cx--'</span>)</span><br><span class="line">ax.plot(y+<span class="number">1</span>,<span class="string">'kp:'</span>)</span><br><span class="line">ax.plot(y+<span class="number">2</span>,<span class="string">'mo-.'</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/27/PLZy3q.png" alt="PLZy3q.png"></p>
<h3 id="网格"><a href="#网格" class="headerlink" title="网格"></a>网格</h3><p>也就是可视化图像中的网格，可以方便读者快速估取某点的横纵坐标。我们通过调用plt.grid()函数来对启用网格。一般情况下，使用该函数的默认参数即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#采用默认参数</span></span><br><span class="line">x= np.arange(<span class="number">1</span>,<span class="number">10</span>,<span class="number">0.1</span>)</span><br><span class="line">fig1 = plt.figure()</span><br><span class="line">ax1 = fig1.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax1.grid()</span><br><span class="line">ax1.plot(x,np.log(x))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/27/PLZWbF.png" alt="PLZWbF.png"></p>
<p>但你也可以通过如下方式进行设置。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">y = np.arange(<span class="number">1</span>,<span class="number">5</span>,<span class="number">0.1</span>)</span><br><span class="line">plt.plot(y,y**<span class="number">2</span>)</span><br><span class="line">plt.grid(color=<span class="string">'r'</span>,linestyle=<span class="string">':'</span>,linewidth=<span class="string">'2'</span>)</span><br><span class="line"><span class="comment"># color 设置网格的颜色(颜色与样式中的均可用)</span></span><br><span class="line"><span class="comment"># linestyle 设置线显示的类型(一共四种即'-','--','-.',':')</span></span><br><span class="line"><span class="comment"># linewidth 设置网格线宽</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/27/PLeToQ.png" alt="PLeToQ.png"></p>
<h3 id="添加图中注释"><a href="#添加图中注释" class="headerlink" title="添加图中注释"></a>添加图中注释</h3><p>有时候你需要为可视化图中的某个关键点做出注释，方便读者能一眼看出，这时候你就需要调用plt.annote()函数来实现你的目的了。</p>
<p>该函数中几个关键的参数分别为：</p>
<ul>
<li><p>str：一个字符串，来写出你想要标注的内容；</p>
</li>
<li><p>xy：标注点的坐标</p>
</li>
<li><p>xytext：标注内容起始位置的坐标（也就是从该点开始显示你的注释内容）</p>
</li>
<li><p>arrowprops：设置注释指向标注点的箭头</p>
<ul>
<li>facecolor：箭头颜色</li>
<li>width：箭头宽度</li>
<li>headlength：箭头头部长度（单位为磅）</li>
<li>headwidth：箭头头部宽度  </li>
</ul>
</li>
</ul>
<p>你也可以去搜索该函数，获取更多参数的设置方法。</p>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">x =np.arange(<span class="number">-10</span>,<span class="number">11</span>,<span class="number">1</span>)</span><br><span class="line">y = x*x</span><br><span class="line"></span><br><span class="line">fig1 = plt.figure()</span><br><span class="line">ax1 = fig1.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax1.plot(x,y)</span><br><span class="line">ax1.annotate(<span class="string">'this is minimum'</span>,xy=(<span class="number">0</span>,<span class="number">0</span>),xytext=(<span class="number">-1.5</span>,<span class="number">20</span>),</span><br><span class="line">             arrowprops=dict(facecolor=<span class="string">'r'</span>,headlength=<span class="number">10</span>))；</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/27/PLMhVK.png" alt="PLMhVK.png"></p>
<h3 id="添加平行于坐标轴的线"><a href="#添加平行于坐标轴的线" class="headerlink" title="添加平行于坐标轴的线"></a>添加平行于坐标轴的线</h3><p>你可能需要添加一条平行于x轴或者是y轴的线，在图像中分割不同区域。这时候，你就需要调用vlines(x, ymin, ymax)函数或者是hlines(y, xmin, xmax)函数，除了括号内的参数之外，你还可以设置颜色(color)参数和线型(linestyles)参数。（设置方法参考<strong>颜色与样式</strong>章节）</p>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plt.vlines(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>, colors = <span class="string">"c"</span>, linestyles = <span class="string">"--"</span>);</span><br><span class="line">plt.hlines(<span class="number">0.25</span>, <span class="number">-0.04</span>, <span class="number">0.04</span>, colors = <span class="string">"r"</span>, linestyles = <span class="string">"-."</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/28/PLvCyn.png" alt="PLvCyn.png"></p>
<h2 id="常用图形"><a href="#常用图形" class="headerlink" title="常用图形"></a>常用图形</h2><h3 id="可视化图形参考"><a href="#可视化图形参考" class="headerlink" title="可视化图形参考"></a>可视化图形参考</h3><p>如何能选择最适合的图形来表示你想分析的结果呢？这里提供一个简单的参考~</p>
<p><a href="https://imgchr.com/i/POERc6" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/08/28/POERc6.md.jpg" alt="POERc6.md.jpg"></a></p>
<h3 id="散点图（scatter）"><a href="#散点图（scatter）" class="headerlink" title="散点图（scatter）"></a>散点图（scatter）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">7</span>)<span class="comment">#设置随机种子，可以保证每次的随机数是一致的</span></span><br><span class="line"></span><br><span class="line">N = <span class="number">50</span></span><br><span class="line">x = np.random.rand(N)<span class="comment">#生成50个0到1的随机数</span></span><br><span class="line">y = np.random.rand(N)</span><br><span class="line">colors = np.random.rand(N)</span><br><span class="line">area = (<span class="number">30</span> * np.random.rand(N))**<span class="number">2</span>  <span class="comment">#随便设置的一个计算值，来表示大小</span></span><br><span class="line"></span><br><span class="line">plt.scatter(x, y, s=area, c=colors, alpha=<span class="number">0.5</span>);<span class="comment">#用s设置大小区分，用c设置颜色区分</span></span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/28/POEJts.png" alt="POEJts.png"></p>
<h3 id="条形图（bar）"><a href="#条形图（bar）" class="headerlink" title="条形图（bar）"></a>条形图（bar）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例1</span></span><br><span class="line"><span class="comment">#函数使用包</span></span><br><span class="line"><span class="keyword">from</span> matplotlib.ticker <span class="keyword">import</span> FuncFormatter</span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">4</span>)</span><br><span class="line">money = [<span class="number">1.5e5</span>, <span class="number">2.5e6</span>, <span class="number">5.5e6</span>, <span class="number">2.0e7</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">millions</span><span class="params">(x, pos)</span>:</span></span><br><span class="line">  <span class="string">'''定义一个函数，将科学记数法转为以million为单位，保留一位小数，并添加美元$和单位M；</span></span><br><span class="line"><span class="string">    两个参数分别表示导入的值和位置。'''</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'$%.1fM'</span> % (x * <span class="number">1e-6</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">formatter = FuncFormatter(millions)<span class="comment">#调用函数，将millions函数作为模块化函数</span></span><br><span class="line"></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.yaxis.set_major_formatter(formatter)<span class="comment">#设置y轴按函数模块化</span></span><br><span class="line">plt.bar(x, money)</span><br><span class="line">plt.xticks(x, (<span class="string">'Bill'</span>, <span class="string">'Fred'</span>, <span class="string">'Mary'</span>, <span class="string">'Sue'</span>));</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/28/POV8KK.png" alt="POV8KK.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例2 横向柱形图</span></span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">4</span>)</span><br><span class="line">money = [<span class="number">1.5e5</span>, <span class="number">2.5e6</span>, <span class="number">5.5e6</span>, <span class="number">2.0e7</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">millions</span><span class="params">(x, pos)</span>:</span></span><br><span class="line">  <span class="string">'''定义一个函数，将科学记数法转为以million为单位，保留一位小数，并添加美元$和单位M；</span></span><br><span class="line"><span class="string">    两个参数分别表示导入的值和位置。'''</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'$%.1fM'</span> % (x * <span class="number">1e-6</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">formatter = FuncFormatter(millions)<span class="comment">#调用函数，将millions函数作为模块化函数</span></span><br><span class="line"></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.xaxis.set_major_formatter(formatter)</span><br><span class="line">plt.barh(x, money)<span class="comment">#关键代码：barh</span></span><br><span class="line">plt.yticks(x, (<span class="string">'Bill'</span>, <span class="string">'Fred'</span>, <span class="string">'Mary'</span>, <span class="string">'Sue'</span>));</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/28/POV4x0.png" alt="POV4x0.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例3 拼接柱状图</span></span><br><span class="line">N = <span class="number">5</span></span><br><span class="line">menMeans = (<span class="number">20</span>, <span class="number">35</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">27</span>)</span><br><span class="line">womenMeans = (<span class="number">25</span>, <span class="number">32</span>, <span class="number">34</span>, <span class="number">20</span>, <span class="number">25</span>)</span><br><span class="line">ind = np.arange(N)    <span class="comment"># 等效于[0,1,2,3,4]</span></span><br><span class="line">width = <span class="number">0.35</span>       <span class="comment"># 柱的宽度</span></span><br><span class="line"></span><br><span class="line">p1 = plt.bar(ind, menMeans, width)</span><br><span class="line">p2 = plt.bar(ind, womenMeans, width,bottom=menMeans) <span class="comment">#关键代码：bottom</span></span><br><span class="line"></span><br><span class="line">plt.ylabel(<span class="string">'Scores'</span>)</span><br><span class="line">plt.title(<span class="string">'Scores by group and gender'</span>)</span><br><span class="line">plt.xticks(ind, (<span class="string">'G1'</span>, <span class="string">'G2'</span>, <span class="string">'G3'</span>, <span class="string">'G4'</span>, <span class="string">'G5'</span>))</span><br><span class="line">plt.yticks(np.arange(<span class="number">0</span>, <span class="number">81</span>, <span class="number">10</span>))</span><br><span class="line">plt.legend((p1, p2), (<span class="string">'Men'</span>, <span class="string">'Women'</span>));</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/28/POZPde.png" alt="POZPde.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例4 并列柱状图</span></span><br><span class="line">N = <span class="number">5</span></span><br><span class="line">menMeans = (<span class="number">20</span>, <span class="number">35</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">27</span>)</span><br><span class="line">womenMeans = (<span class="number">25</span>, <span class="number">32</span>, <span class="number">34</span>, <span class="number">20</span>, <span class="number">25</span>)</span><br><span class="line">ind = np.arange(N)    </span><br><span class="line">width = <span class="number">0.35</span>      </span><br><span class="line"></span><br><span class="line">p1 = plt.bar(ind-width/<span class="number">2</span>, menMeans, width) <span class="comment">#关键代码 -width/2，也就是将柱子向左移动了width/2</span></span><br><span class="line">p2 = plt.bar(ind+width/<span class="number">2</span>, womenMeans, width) <span class="comment">#关键代码 +width/2</span></span><br><span class="line"></span><br><span class="line">plt.ylabel(<span class="string">'Scores'</span>)</span><br><span class="line">plt.title(<span class="string">'Scores by group and gender'</span>)</span><br><span class="line">plt.xticks(ind, (<span class="string">'G1'</span>, <span class="string">'G2'</span>, <span class="string">'G3'</span>, <span class="string">'G4'</span>, <span class="string">'G5'</span>))</span><br><span class="line">plt.yticks(np.arange(<span class="number">0</span>, <span class="number">81</span>, <span class="number">10</span>))</span><br><span class="line">plt.legend((p1[<span class="number">0</span>], p2[<span class="number">0</span>]), (<span class="string">'Men'</span>, <span class="string">'Women'</span>));</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/28/POZKeS.png" alt="POZKeS.png"></p>
<h3 id="直方图（hist）"><a href="#直方图（hist）" class="headerlink" title="直方图（hist）"></a>直方图（hist）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure()</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">221</span>)</span><br><span class="line">ax2 = fig.add_subplot(<span class="number">222</span>)</span><br><span class="line">ax3 = fig.add_subplot(<span class="number">212</span>)</span><br><span class="line"></span><br><span class="line">mu = <span class="number">100</span> <span class="comment">#定义均值</span></span><br><span class="line">sigma = <span class="number">20</span> <span class="comment">#定义标准差</span></span><br><span class="line">x = mu +sigma * np.random.randn(<span class="number">2000</span>) <span class="comment">#生成一个标准正态分布函数</span></span><br><span class="line"></span><br><span class="line">ax1.hist(x,bins=<span class="number">10</span>,color=<span class="string">'green'</span>,normed=<span class="literal">True</span>) <span class="comment">#输入数据，bins=总共有几条条状图，color=颜色，normed=True:图形面积之和为1</span></span><br><span class="line"></span><br><span class="line">ax2.hist(x,bins=<span class="number">50</span>,color=<span class="string">'red'</span>,normed=<span class="literal">False</span>) <span class="comment">#normed=False:纵坐标显示实际值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x = np.random.randn(<span class="number">1000</span>)+<span class="number">2</span></span><br><span class="line">y = np.random.randn(<span class="number">1000</span>)+<span class="number">3</span></span><br><span class="line"></span><br><span class="line">ax3.hist2d(x,y,bins=<span class="number">10</span>); <span class="comment">#二维直方图</span></span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/28/POZXTg.png" alt="POZXTg.png"></p>
<h3 id="饼状图（pie）"><a href="#饼状图（pie）" class="headerlink" title="饼状图（pie）"></a>饼状图（pie）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">labels = <span class="string">'Frogs'</span>, <span class="string">'Hogs'</span>, <span class="string">'Dogs'</span>, <span class="string">'Logs'</span></span><br><span class="line">sizes = [<span class="number">15</span>, <span class="number">30</span>, <span class="number">45</span>, <span class="number">10</span>] <span class="comment">#占比</span></span><br><span class="line">explode = (<span class="number">0</span>, <span class="number">0.1</span>, <span class="number">0</span>, <span class="number">0</span>)  <span class="comment">#设置第二位也就是‘Hogs’凸显，间距为0.1</span></span><br><span class="line"></span><br><span class="line">fig1, ax1 = plt.subplots()</span><br><span class="line">ax1.pie(sizes, explode=explode, labels=labels, autopct=<span class="string">'%1.1f%%'</span>,shadow=<span class="literal">True</span>, startangle=<span class="number">90</span>)<span class="comment">#autopct对输出进行格式化，startangle为起始角度，一般设置为90比较好看</span></span><br><span class="line">ax1.axis(<span class="string">'equal'</span>);<span class="comment">#保证为正圆</span></span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/28/POnmsx.png" alt="POnmsx.png"></p>
<h3 id="箱线图（box）"><a href="#箱线图（box）" class="headerlink" title="箱线图（box）"></a>箱线图（box）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure()</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">211</span>)</span><br><span class="line">ax2 = fig.add_subplot(<span class="number">212</span>)</span><br><span class="line"></span><br><span class="line">data = np.random.normal(size=<span class="number">1000</span>, loc=<span class="number">0.0</span>, scale=<span class="number">1.0</span>)</span><br><span class="line"></span><br><span class="line">ax1.boxplot(data,sym=<span class="string">'o'</span>,whis=<span class="number">1.5</span>)</span><br><span class="line"><span class="comment"># plt.boxplot(x, notch=None, sym=None, vert=None, whis=None, positions=None, widths=None, patch_artist=None, meanline=None, showmeans=None, showcaps=None, showbox=None, showfliers=None, boxprops=None, labels=None, flierprops=None, medianprops=None, meanprops=None, capprops=None, whiskerprops=None)</span></span><br><span class="line"><span class="comment"># x：指定要绘制箱线图的数据；</span></span><br><span class="line"><span class="comment"># notch：是否是凹口的形式展现箱线图，默认非凹口；</span></span><br><span class="line"><span class="comment"># sym：指定异常点的形状，默认为+号显示；</span></span><br><span class="line"><span class="comment"># vert：是否需要将箱线图垂直摆放，默认垂直摆放；</span></span><br><span class="line"><span class="comment"># whis：指定上下须与上下四分位的距离，默认为1.5倍的四分位差；</span></span><br><span class="line"><span class="comment"># positions：指定箱线图的位置，默认为[0,1,2…]；</span></span><br><span class="line"><span class="comment"># widths：指定箱线图的宽度，默认为0.5；</span></span><br><span class="line"><span class="comment"># patch_artist：是否填充箱体的颜色；</span></span><br><span class="line"><span class="comment"># meanline：是否用线的形式表示均值，默认用点来表示；</span></span><br><span class="line"><span class="comment"># showmeans：是否显示均值，默认不显示；</span></span><br><span class="line"><span class="comment"># showcaps：是否显示箱线图顶端和末端的两条线，默认显示；</span></span><br><span class="line"><span class="comment"># showbox：是否显示箱线图的箱体，默认显示；</span></span><br><span class="line"><span class="comment"># showfliers：是否显示异常值，默认显示；</span></span><br><span class="line"><span class="comment"># boxprops：设置箱体的属性，如边框色，填充色等；</span></span><br><span class="line"><span class="comment"># labels：为箱线图添加标签，类似于图例的作用；</span></span><br><span class="line"><span class="comment"># filerprops：设置异常值的属性，如异常点的形状、大小、填充色等；</span></span><br><span class="line"><span class="comment"># medianprops：设置中位数的属性，如线的类型、粗细等；</span></span><br><span class="line"><span class="comment"># meanprops：设置均值的属性，如点的大小、颜色等；</span></span><br><span class="line"><span class="comment"># capprops：设置箱线图顶端和末端线条的属性，如颜色、粗细等；</span></span><br><span class="line"><span class="comment"># whiskerprops：设置须的属性，如颜色、粗细、线的类型等；</span></span><br><span class="line">data = np.random.normal(size=(<span class="number">100</span>, <span class="number">4</span>), loc=<span class="number">0.0</span>, scale=<span class="number">1.0</span>)</span><br><span class="line"></span><br><span class="line">labels = [<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>]</span><br><span class="line"></span><br><span class="line">ax2.boxplot(data, labels=labels);</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/28/POnIfJ.png" alt="POnIfJ.png"></p>
<h3 id="散点直方图（scatter-hist）"><a href="#散点直方图（scatter-hist）" class="headerlink" title="散点直方图（scatter hist）"></a>散点直方图（scatter hist）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">x = np.random.randn(<span class="number">200</span>)</span><br><span class="line">y = x + np.random.randn(<span class="number">200</span>)*<span class="number">0.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义坐标轴参数</span></span><br><span class="line">margin_border = <span class="number">0.1</span> </span><br><span class="line">width = <span class="number">0.6</span></span><br><span class="line">margin_between = <span class="number">0.02</span></span><br><span class="line">height = <span class="number">0.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#散点图参数</span></span><br><span class="line">left_s = margin_border <span class="comment">#距左边框距离</span></span><br><span class="line">bottom_s = margin_border <span class="comment">#距底部距离</span></span><br><span class="line">height_s = width <span class="comment">#散点图高度</span></span><br><span class="line">width_s = width <span class="comment">#散点图宽度</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#顶部直方图参数</span></span><br><span class="line">left_x = margin_border <span class="comment">#距左边框距离</span></span><br><span class="line">bottom_x = margin_border+width+margin_between <span class="comment">#距底部距离 = 散点图距底部距离+散点图高度+散点图与直方图的间距</span></span><br><span class="line">height_x = height <span class="comment">#直方图高度</span></span><br><span class="line">width_x = width <span class="comment">#直方图宽度</span></span><br><span class="line"></span><br><span class="line">left_y = margin_border+width+margin_between</span><br><span class="line">bottom_y = margin_border</span><br><span class="line">height_y = width</span><br><span class="line">width_y = height</span><br><span class="line"></span><br><span class="line">plt.figure(<span class="number">1</span>,figsize=(<span class="number">8</span>,<span class="number">8</span>))</span><br><span class="line">rect_s = [left_s,bottom_s,width_s,height_s]</span><br><span class="line">rect_x = [left_x,bottom_x,width_x,height_x]</span><br><span class="line">rect_y = [left_y,bottom_y,width_y,height_y]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开始按照定义的尺寸绘图</span></span><br><span class="line">axScatter = plt.axes(rect_s)</span><br><span class="line">axHisX = plt.axes(rect_x)</span><br><span class="line">axHisY = plt.axes(rect_y)</span><br><span class="line">axHisX.set_xticks([])<span class="comment">#取消顶部直方图的x轴刻度显示</span></span><br><span class="line">axHisY.set_yticks([])<span class="comment">#取消右侧直方图的y轴刻度显示</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#绘制散点图</span></span><br><span class="line">axScatter.scatter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设定边界</span></span><br><span class="line">bin_width = <span class="number">0.25</span></span><br><span class="line">xymax = np.max([np.max(np.fabs(x)),np.max(np.fabs(y))])<span class="comment">#取出x与y中最大的绝对值</span></span><br><span class="line">lim =int(xymax/bin_width+<span class="number">1</span>) * bin_width </span><br><span class="line">axScatter.set_xlim(-lim,lim)</span><br><span class="line">axScatter.set_ylim(-lim,lim)</span><br><span class="line"></span><br><span class="line">bins = np.arange(-lim,lim+bin_width,bin_width)</span><br><span class="line"></span><br><span class="line">axHisX.hist(x,bins=bins)</span><br><span class="line">axHisY.hist(y,bins=bins,orientation=<span class="string">'horizontal'</span>)<span class="comment">#水平作图</span></span><br><span class="line"></span><br><span class="line">axHisX.set_xlim(axScatter.get_xlim())</span><br><span class="line">axHisY.set_ylim(axScatter.get_ylim());</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/28/POmosP.png" alt="POmosP.png"></p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="保存图像到本地"><a href="#保存图像到本地" class="headerlink" title="保存图像到本地"></a>保存图像到本地</h3><p>参考如下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#保存至当下路径</span></span><br><span class="line">fig.savefig(<span class="string">'test.jpg'</span>);</span><br><span class="line"><span class="comment">#保存至其他路径</span></span><br><span class="line">fig.savefig(<span class="string">'E:/DAND/DAND_VIP/test.jpg'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="显示中文"><a href="#显示中文" class="headerlink" title="显示中文"></a>显示中文</h3><p>使用matplotlib做可视化不能显示中文，根本原因是因为官方配置中没有中文字体，所以，我们把中文字体添加进去就ok啦。具体方法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line">plt.rcParams[<span class="string">'font.sans-serif'</span>]=[<span class="string">'simhei'</span>]<span class="comment">#simhei为‘黑体’</span></span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(<span class="number">1</span>,<span class="number">11</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">line1 = ax.plot(x,-x*<span class="number">2</span>,label=<span class="string">'优'</span>)</span><br><span class="line">line2 = ax.plot(x,-x*<span class="number">3</span>,label=<span class="string">'良'</span>)</span><br><span class="line">line3 = ax.plot(x,-x*<span class="number">4</span>,label=<span class="string">'差'</span>)</span><br><span class="line"></span><br><span class="line">plt.legend(loc=<span class="string">'best'</span>)</span><br><span class="line">plt.title(<span class="string">'标题'</span>,color = <span class="string">'r'</span>,fontsize = <span class="number">17</span>)</span><br><span class="line">plt.xlabel(<span class="string">'x轴'</span>,fontsize = <span class="number">13</span>)</span><br><span class="line">plt.ylabel(<span class="string">'-y轴'</span>,fontsize = <span class="number">13</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/08/28/POSpSe.png" alt="POSpSe.png"></p>
<h3 id="坐标轴显示负号"><a href="#坐标轴显示负号" class="headerlink" title="坐标轴显示负号"></a>坐标轴显示负号</h3><p>有可能你做得可视化图像中，坐标轴的符号显示一个框框，这时候你添加如下设置即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.rcParams[<span class="string">'axes.unicode_minus'</span>]=<span class="literal">False</span></span><br></pre></td></tr></table></figure>
<h1 id="Pandas-Plot"><a href="#Pandas-Plot" class="headerlink" title="Pandas Plot"></a>Pandas Plot</h1><p>pandas plot函数是基于matplotlib的一个在pandas中快速绘图的方法，用法简单，而且兼容所有matplotlib属性设置的函数，所以，你可以用pandas plot函数来绘图，然后调用matplotlib中的函数对可视化图形进行设置，最终达到你心中的预期。</p>
<h2 id="官方链接-1"><a href="#官方链接-1" class="headerlink" title="官方链接"></a>官方链接</h2><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.plot.html#pandas-dataframe-plot" target="_blank" rel="noopener">pandas.DataFrame.plot</a></p>
<h2 id="常用参数设置-1"><a href="#常用参数设置-1" class="headerlink" title="常用参数设置"></a>常用参数设置</h2><ul>
<li>data：你可以直接调取DataFrame作为参数输入</li>
<li>x：x轴数据</li>
<li>y：y轴数据</li>
<li>kind：绘图类型<ul>
<li>line ：折线图</li>
<li>bar ：条形图</li>
<li>barh：水平条形图</li>
<li>hist：直方图</li>
<li>box：箱线图</li>
<li>kde：就是在条形图的基础上添加了概率密度曲线</li>
<li>area ：相当于填充面积的折线图</li>
<li>pie：饼状图</li>
<li>scatter：散点图</li>
<li>hexbin：热度图</li>
</ul>
</li>
</ul>
<p>其余参数与matplotlib的参数设置类似，这里不再赘述。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>matplotlib是python可视化的鼻祖，绘图全面，多功能是他的优点，几乎没有他不能完成的可视化任务；</p>
<p>但是，他的缺点也很明显，比如：可视化图形配色丑；参数太多，设置琐碎；没有交互式。。。</p>
<p>所以针对这些问题，后人们又开发了许多python的可视化包，比如说：以美观、简洁著称的<a href="https://seaborn.pydata.org/" target="_blank" rel="noopener">seaborn</a>、做交互式的<a href="https://plot.ly/python/" target="_blank" rel="noopener">plotly</a>、<a href="http://pyecharts.org/#/" target="_blank" rel="noopener">pyecharts</a>等等，后续我看时间允许的话，再出一些教程，大家也可以按需去官网学习，主要是看给出的示例，看关键代码，自己多总结。</p>
<h1 id="项目相关"><a href="#项目相关" class="headerlink" title="项目相关"></a>项目相关</h1><p>P3的项目需要你完完整整得过一遍数据分析的过程，所以呢，单独的某一个数据集肯定满足不了大家，贴心的Udacity给大家准备了几个数据集备选，戳<a href="https://github.com/udacity/new-dand-basic-china/blob/master/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%A5%E9%97%A8/%E9%A1%B9%E7%9B%AE-%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86/%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86%20-%20%E5%A4%87%E9%80%89%E6%95%B0%E6%8D%AE%E9%9B%86.md" target="_blank" rel="noopener">数据集预览</a>，挑一个自己感兴趣的先~</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://blog.csdn.net/pipisorry/article/details/37742423" target="_blank" rel="noopener">matplotlib绘图基础</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/21/2018-8-21-第六周-2-数据融合/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/08/21/2018-8-21-第六周-2-数据融合/" class="post-title-link" itemprop="url">每周导学-第六周导学-Pandas数据融合</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-08-21 12:30:09" itemprop="dateCreated datePublished" datetime="2018-08-21T12:30:09+08:00">2018-08-21</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-03 12:51:55" itemprop="dateModified" datetime="2019-04-03T12:51:55+08:00">2019-04-03</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2018/08/21/2018-8-21-第六周-2-数据融合/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/08/21/2018-8-21-第六周-2-数据融合/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>It’s not about where your starting point is, but your end goal and the journey that will get you there.</p>
</blockquote>
<p>在P2阶段的末尾，课程中涉及到了一个新的pandas函数——merge，有些同学对merge的用法存在疑惑，尤其是查了一下<strong>Pandas如何做数据合并</strong>之后，发现除了merge之外，还有concat、还有join，还有append，更是一脸懵了，那这期导学呢，我们就来一起梳理一下pandas数据合并的知识点，同学们不要慌，除了代码之外，还嵌入了DataFrame的图片方便大家理解。当然，看完之后还是要自己多练习才行！加油！</p>
<h1 id="merge"><a href="#merge" class="headerlink" title="merge"></a>merge</h1><h2 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h2><h3 id="文档链接"><a href="#文档链接" class="headerlink" title="文档链接"></a>文档链接</h3><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.merge.html" target="_blank" rel="noopener">pandas.DataFrame.merge</a></p>
<h3 id="常用参数解读"><a href="#常用参数解读" class="headerlink" title="常用参数解读"></a>常用参数解读</h3><ul>
<li><p>right：合并的另一个DataFrame</p>
</li>
<li><p>how：数据融合的方式，包括：left、right、outer和inner，默认是inner</p>
<blockquote>
<p>merge的连接方式与SQL对比</p>
</blockquote>
<blockquote>
<p>| 合并方式 | SQL JOIN           | 描述                    |<br>| ——– | —————— | ———————– |<br>| <code>left</code>   | <code>LEFT OUTER JOIN</code>  | 只用左表的key去匹配链接 |<br>| <code>right</code>  | <code>RIGHT OUTER JOIN</code> | 只用右表的key去匹配链接 |<br>| <code>outer</code>  | <code>FULL OUTER JOIN</code>  | 两表中key的并集         |<br>| <code>inner</code>  | <code>INNER JOIN</code>       | 两表中key的交集         |</p>
</blockquote>
</li>
<li><p>on：进行合并的共有列的名字，用到这个参数的时候一定要保证左表和右表的共有列都有相同的列名</p>
</li>
<li>left_on：左表对齐的列，可以是列名，也可以是和dataframe同样长度的arrays。</li>
<li>right_on：右表对齐的列，可以是列名，也可以是和dataframe同样长度的arrays。</li>
<li>left_index/ right_index: 布尔值，如果是True的话，以index作为key</li>
<li>sort：布尔值，会根据dataframe合并的keys按字典顺序(abcd…这种)排序，默认为True，设置为False可以提高运算速率。</li>
</ul>
<h2 id="合并方法"><a href="#合并方法" class="headerlink" title="合并方法"></a>合并方法</h2><ul>
<li><p>一对一 : 联接两个 DataFrame 的key唯一</p>
</li>
<li><p>多对一 : 将一个DataFrame的唯一key连接到另一个 DataFrame 中的一个或多个key</p>
<ul>
<li>多对多 : keys 对 keys</li>
</ul>
</li>
</ul>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><ul>
<li><p>一对一</p>
<blockquote>
<p>默认连接方式为inner，即取交集</p>
</blockquote>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">In [1]: left = pd.DataFrame(&#123;&apos;key&apos;: [&apos;K0&apos;, &apos;K1&apos;, &apos;K2&apos;, &apos;K3&apos;],</span><br><span class="line">   ....:                      &apos;A&apos;: [&apos;A0&apos;, &apos;A1&apos;, &apos;A2&apos;, &apos;A3&apos;],</span><br><span class="line">   ....:                      &apos;B&apos;: [&apos;B0&apos;, &apos;B1&apos;, &apos;B2&apos;, &apos;B3&apos;]&#125;)</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [2]: right = pd.DataFrame(&#123;&apos;key&apos;: [&apos;K0&apos;, &apos;K1&apos;, &apos;K2&apos;, &apos;K3&apos;],</span><br><span class="line">   ....:                       &apos;C&apos;: [&apos;C0&apos;, &apos;C1&apos;, &apos;C2&apos;, &apos;C3&apos;],</span><br><span class="line">   ....:                       &apos;D&apos;: [&apos;D0&apos;, &apos;D1&apos;, &apos;D2&apos;, &apos;D3&apos;]&#125;)</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [3]: result = pd.merge(left, right, on=&apos;key&apos;)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_on_key.png" alt="_images/merging_merge_on_key.png"> </p>
<ul>
<li>多对多（默认内链接）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In [4]: left = pd.DataFrame(&#123;&apos;key1&apos;: [&apos;K0&apos;, &apos;K0&apos;, &apos;K1&apos;, &apos;K2&apos;],</span><br><span class="line">   ....:                      &apos;key2&apos;: [&apos;K0&apos;, &apos;K1&apos;, &apos;K0&apos;, &apos;K1&apos;],</span><br><span class="line">   ....:                      &apos;A&apos;: [&apos;A0&apos;, &apos;A1&apos;, &apos;A2&apos;, &apos;A3&apos;],</span><br><span class="line">   ....:                      &apos;B&apos;: [&apos;B0&apos;, &apos;B1&apos;, &apos;B2&apos;, &apos;B3&apos;]&#125;)</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [5]: right = pd.DataFrame(&#123;&apos;key1&apos;: [&apos;K0&apos;, &apos;K1&apos;, &apos;K1&apos;, &apos;K2&apos;],</span><br><span class="line">   ....:                       &apos;key2&apos;: [&apos;K0&apos;, &apos;K0&apos;, &apos;K0&apos;, &apos;K0&apos;],</span><br><span class="line">   ....:                       &apos;C&apos;: [&apos;C0&apos;, &apos;C1&apos;, &apos;C2&apos;, &apos;C3&apos;],</span><br><span class="line">   ....:                       &apos;D&apos;: [&apos;D0&apos;, &apos;D1&apos;, &apos;D2&apos;, &apos;D3&apos;]&#125;)</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [6]: result = pd.merge(left, right, on=[&apos;key1&apos;, &apos;key2&apos;])</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_on_key_multiple.png" alt="_images/merging_merge_on_key_multiple.png"> </p>
<ul>
<li>左链接</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [7]: result = pd.merge(left, right, how=&apos;left&apos;, on=[&apos;key1&apos;, &apos;key2&apos;])</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_on_key_left.png" alt="_images/merging_merge_on_key_left.png"> </p>
<ul>
<li>右链接</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [8]: result = pd.merge(left, right, how=&apos;right&apos;, on=[&apos;key1&apos;, &apos;key2&apos;])</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_on_key_right.png" alt="_images/merging_merge_on_key_right.png"> </p>
<ul>
<li>外链接</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [9]: result = pd.merge(left, right, how=&apos;outer&apos;, on=[&apos;key1&apos;, &apos;key2&apos;])</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_on_key_outer.png" alt="_images/merging_merge_on_key_outer.png"> </p>
<ul>
<li><p>利用index链接</p>
<p>这里就要用到<code>left_index</code>和<code>right_index</code>参数了，实例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [10]: result = pd.merge(left, right, left_index=True, right_index=True, how=&apos;outer&apos;)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_index_outer.png" alt="_images/merging_merge_index_outer.png"> </p>
</li>
</ul>
<h3 id="重复列的处理"><a href="#重复列的处理" class="headerlink" title="重复列的处理"></a>重复列的处理</h3><p>当你进行合并时，key有重复的话，会额外输出<code>行数X重名列数</code>的数据，不仅结果错误，还会导致电脑运行速度巨慢，所以，合并前一定要检查是否有重复列名，当然你可以直接比对两表的列名，或者选择如下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [10]: left = pd.DataFrame(&#123;&apos;A&apos; : [1,2], &apos;B&apos; : [1, 2]&#125;)</span><br><span class="line"></span><br><span class="line">In [11]: right = pd.DataFrame(&#123;&apos;A&apos; : [4,5,6], &apos;B&apos;: [2, 2, 2]&#125;)</span><br><span class="line"></span><br><span class="line">In [12]: result = pd.merge(left, right, on=&apos;B&apos;, how=&apos;outer&apos;, validate=&quot;one_to_one&quot;)</span><br><span class="line">...</span><br><span class="line">MergeError: Merge keys are not unique in right dataset; not a one-to-one merge</span><br></pre></td></tr></table></figure>
<p>当有重名列的时候，就会报错，那么如果想继续合并的话，只需把<code>validate</code>参数改为<code>&quot;one_to_many&quot;</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [13]: pd.merge(left, right, on=&apos;B&apos;, how=&apos;outer&apos;, validate=&quot;one_to_many&quot;)</span><br><span class="line">Out[13]: </span><br><span class="line">   A_x  B  A_y</span><br><span class="line">0    1  1  NaN</span><br><span class="line">1    2  2  4.0</span><br><span class="line">2    2  2  5.0</span><br><span class="line">3    2  2  6.0</span><br></pre></td></tr></table></figure>
<p>如果你想在合并后，把两表中重名的列加上后缀的话，可以使用<code>suffixes</code>参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [27]: left = pd.DataFrame(&#123;&apos;k&apos;: [&apos;K0&apos;, &apos;K1&apos;, &apos;K2&apos;], &apos;v&apos;: [1, 2, 3]&#125;)</span><br><span class="line"></span><br><span class="line">In [28]: right = pd.DataFrame(&#123;&apos;k&apos;: [&apos;K0&apos;, &apos;K0&apos;, &apos;K3&apos;], &apos;v&apos;: [4, 5, 6]&#125;)</span><br><span class="line"></span><br><span class="line">In [29]: result = pd.merge(left, right, on=&apos;k&apos;, suffixes=[&apos;_l&apos;, &apos;_r&apos;])</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_overlapped_suffix.png" alt="_images/merging_merge_overlapped_suffix.png"> </p>
<h3 id="indicator参数"><a href="#indicator参数" class="headerlink" title="indicator参数"></a><code>indicator</code>参数</h3><p>在merge里，还有一个有意思的参数叫<code>indicator</code>，可以输入布尔值（默认为False），当你设置为True的时候，会在你合并的表中，增加一列<code>_merge</code>，元素则表示了合并后的数据来自左表还是右表或者二者皆有。</p>
<p>看示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">In [14]: df1 = pd.DataFrame(&#123;&apos;col1&apos;: [0, 1], &apos;col_left&apos;:[&apos;a&apos;, &apos;b&apos;]&#125;)</span><br><span class="line"></span><br><span class="line">In [15]: df2 = pd.DataFrame(&#123;&apos;col1&apos;: [1, 2, 2],&apos;col_right&apos;:[2, 2, 2]&#125;)</span><br><span class="line"></span><br><span class="line">In [16]: pd.merge(df1, df2, on=&apos;col1&apos;, how=&apos;outer&apos;, indicator=True)</span><br><span class="line">Out[16]: </span><br><span class="line">   col1 col_left  col_right      _merge</span><br><span class="line">0     0        a        NaN   left_only</span><br><span class="line">1     1        b        2.0        both</span><br><span class="line">2     2      NaN        2.0  right_only</span><br><span class="line">3     2      NaN        2.0  right_only</span><br></pre></td></tr></table></figure>
<p>或者也可以输入一个字符串作为列名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [17]: pd.merge(df1, df2, on=&apos;col1&apos;, how=&apos;outer&apos;, indicator=&apos;indicator_column&apos;)</span><br><span class="line">Out[17]: </span><br><span class="line">   col1 col_left  col_right indicator_column</span><br><span class="line">0     0        a        NaN        left_only</span><br><span class="line">1     1        b        2.0             both</span><br><span class="line">2     2      NaN        2.0       right_only</span><br><span class="line">3     2      NaN        2.0       right_only</span><br></pre></td></tr></table></figure>
<h1 id="join"><a href="#join" class="headerlink" title="join"></a>join</h1><h2 id="官方文档-1"><a href="#官方文档-1" class="headerlink" title="官方文档"></a>官方文档</h2><h3 id="文档链接-1"><a href="#文档链接-1" class="headerlink" title="文档链接"></a>文档链接</h3><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.join.html" target="_blank" rel="noopener">pandas.DataFrame.join</a></p>
<h3 id="常用参数解读-1"><a href="#常用参数解读-1" class="headerlink" title="常用参数解读"></a>常用参数解读</h3><ul>
<li><strong>other</strong> : DataFrame , 或者是有列名的Series</li>
<li><strong>on</strong> : 也就是merge的key，可以输入key或者keys，默认为<strong>index</strong></li>
<li><strong>how</strong> : left、right、outer、inner，默认为<strong>left</strong></li>
</ul>
<h2 id="合并方法-1"><a href="#合并方法-1" class="headerlink" title="合并方法"></a>合并方法</h2><p>join是一种快速合并方法，所需参数较少，默认以index作为链接键。</p>
<h3 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h3><ul>
<li>最常用</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">In [18]: left = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A0&apos;, &apos;A1&apos;, &apos;A2&apos;],</span><br><span class="line">   ....:                      &apos;B&apos;: [&apos;B0&apos;, &apos;B1&apos;, &apos;B2&apos;]&#125;,</span><br><span class="line">   ....:                      index=[&apos;K0&apos;, &apos;K1&apos;, &apos;K2&apos;])</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [19]: right = pd.DataFrame(&#123;&apos;C&apos;: [&apos;C0&apos;, &apos;C2&apos;, &apos;C3&apos;],</span><br><span class="line">   ....:                       &apos;D&apos;: [&apos;D0&apos;, &apos;D2&apos;, &apos;D3&apos;]&#125;,</span><br><span class="line">   ....:                       index=[&apos;K0&apos;, &apos;K2&apos;, &apos;K3&apos;])</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [20]: result = left.join(right)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join.png" alt="_images/merging_join.png"> </p>
<ul>
<li>外连接</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [21]: result = left.join(right, how=&apos;outer&apos;)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join_outer.png" alt="_images/merging_join_outer.png"> </p>
<ul>
<li>内连接</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [22]: result = left.join(right, how=&apos;inner&apos;)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join_inner.png" alt="_images/merging_join_inner.png"> </p>
<ul>
<li>键为列与index</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">In [23]: left = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A0&apos;, &apos;A1&apos;, &apos;A2&apos;, &apos;A3&apos;],</span><br><span class="line">   ....:                      &apos;B&apos;: [&apos;B0&apos;, &apos;B1&apos;, &apos;B2&apos;, &apos;B3&apos;],</span><br><span class="line">   ....:                      &apos;key&apos;: [&apos;K0&apos;, &apos;K1&apos;, &apos;K0&apos;, &apos;K1&apos;]&#125;)</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [24]: right = pd.DataFrame(&#123;&apos;C&apos;: [&apos;C0&apos;, &apos;C1&apos;],</span><br><span class="line">   ....:                       &apos;D&apos;: [&apos;D0&apos;, &apos;D1&apos;]&#125;,</span><br><span class="line">   ....:                       index=[&apos;K0&apos;, &apos;K1&apos;])</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [25]: result = left.join(right, on=&apos;key&apos;)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join_key_columns.png" alt="_images/merging_join_key_columns.png"> </p>
<ul>
<li>键为多列与多index</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">In [26]: left = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A0&apos;, &apos;A1&apos;, &apos;A2&apos;, &apos;A3&apos;],</span><br><span class="line">   ....:                      &apos;B&apos;: [&apos;B0&apos;, &apos;B1&apos;, &apos;B2&apos;, &apos;B3&apos;],</span><br><span class="line">   ....:                      &apos;key1&apos;: [&apos;K0&apos;, &apos;K0&apos;, &apos;K1&apos;, &apos;K2&apos;],</span><br><span class="line">   ....:                      &apos;key2&apos;: [&apos;K0&apos;, &apos;K1&apos;, &apos;K0&apos;, &apos;K1&apos;]&#125;)</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [27]: index = pd.MultiIndex.from_tuples([(&apos;K0&apos;, &apos;K0&apos;), (&apos;K1&apos;, &apos;K0&apos;),</span><br><span class="line">   ....:                                   (&apos;K2&apos;, &apos;K0&apos;), (&apos;K2&apos;, &apos;K1&apos;)])</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [28]: right = pd.DataFrame(&#123;&apos;C&apos;: [&apos;C0&apos;, &apos;C1&apos;, &apos;C2&apos;, &apos;C3&apos;],</span><br><span class="line">   ....:                    &apos;D&apos;: [&apos;D0&apos;, &apos;D1&apos;, &apos;D2&apos;, &apos;D3&apos;]&#125;,</span><br><span class="line">   ....:                   index=index)</span><br><span class="line">   ....: </span><br><span class="line">In [29]: result = left.join(right, on=[&apos;key1&apos;, &apos;key2&apos;])</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join_multikeys.png" alt="_images/merging_join_multikeys.png"> </p>
<ul>
<li>键为单index与多重index</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">In [30]: left = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A0&apos;, &apos;A1&apos;, &apos;A2&apos;],</span><br><span class="line">   ....:                      &apos;B&apos;: [&apos;B0&apos;, &apos;B1&apos;, &apos;B2&apos;]&#125;,</span><br><span class="line">   ....:                      index=pd.Index([&apos;K0&apos;, &apos;K1&apos;, &apos;K2&apos;], name=&apos;key&apos;))</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [31]: index = pd.MultiIndex.from_tuples([(&apos;K0&apos;, &apos;Y0&apos;), (&apos;K1&apos;, &apos;Y1&apos;),</span><br><span class="line">   ....:                                   (&apos;K2&apos;, &apos;Y2&apos;), (&apos;K2&apos;, &apos;Y3&apos;)],</span><br><span class="line">   ....:                                    names=[&apos;key&apos;, &apos;Y&apos;])</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [32]: right = pd.DataFrame(&#123;&apos;C&apos;: [&apos;C0&apos;, &apos;C1&apos;, &apos;C2&apos;, &apos;C3&apos;],</span><br><span class="line">   ....:                       &apos;D&apos;: [&apos;D0&apos;, &apos;D1&apos;, &apos;D2&apos;, &apos;D3&apos;]&#125;,</span><br><span class="line">   ....:                       index=index)</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [33]: result = left.join(right, how=&apos;inner&apos;)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join_multiindex_inner.png" alt="_images/merging_join_multiindex_inner.png"> </p>
<blockquote>
<p>你也可以用merge来实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; In [34]: result = pd.merge(left.reset_index(), right.reset_index(),</span><br><span class="line">&gt;    ....:       on=[&apos;key&apos;], how=&apos;inner&apos;).set_index([&apos;key&apos;,&apos;Y&apos;])</span><br><span class="line">&gt;    ....: </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<ul>
<li>键为两个多重index</li>
</ul>
<p>这里用join就不能实现了，但是你可以用merge，方法跟上面merge的用法类似</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; In [35]: index = pd.MultiIndex.from_tuples([(&apos;K0&apos;, &apos;X0&apos;), (&apos;K0&apos;, &apos;X1&apos;),</span><br><span class="line">&gt;    ....:                                    (&apos;K1&apos;, &apos;X2&apos;)],</span><br><span class="line">&gt;    ....:                                     names=[&apos;key&apos;, &apos;X&apos;])</span><br><span class="line">&gt;    ....: </span><br><span class="line">&gt; </span><br><span class="line">&gt; In [36]: left = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A0&apos;, &apos;A1&apos;, &apos;A2&apos;],</span><br><span class="line">&gt;    .....:                      &apos;B&apos;: [&apos;B0&apos;, &apos;B1&apos;, &apos;B2&apos;]&#125;,</span><br><span class="line">&gt;    .....:                       index=index)</span><br><span class="line">&gt;    .....: </span><br><span class="line">&gt; </span><br><span class="line">&gt; In [37]: result = pd.merge(left.reset_index(), right.reset_index(),</span><br><span class="line">&gt;    .....:                   on=[&apos;key&apos;], how=&apos;inner&apos;).set_index([&apos;key&apos;,&apos;X&apos;,&apos;Y&apos;])</span><br><span class="line">&gt;    .....: </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_two_multiindex.png" alt="_images/merging_merge_two_multiindex.png"> </p>
</blockquote>
<h3 id="重复列的处理-1"><a href="#重复列的处理-1" class="headerlink" title="重复列的处理"></a>重复列的处理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [38]: left = pd.DataFrame(&#123; &apos;v&apos;: [1, 2, 3]&#125;,index = [&apos;K0&apos;, &apos;K1&apos;, &apos;K2&apos;])</span><br><span class="line"></span><br><span class="line">In [39]: right = pd.DataFrame(&#123; &apos;v&apos;: [4, 5, 6]&#125;,index = [&apos;K0&apos;, &apos;K0&apos;, &apos;K3&apos;])</span><br><span class="line"></span><br><span class="line">In [40]: result = left.join(right, lsuffix=&apos;_l&apos;, rsuffix=&apos;_r&apos;)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_merge_overlapped_multi_suffix.png" alt="_images/merging_merge_overlapped_multi_suffix.png"> </p>
<h3 id="多表的连接"><a href="#多表的连接" class="headerlink" title="多表的连接"></a>多表的连接</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In [41]: right2 = pd.DataFrame(&#123;&apos;v&apos;: [7, 8, 9]&#125;, index=[&apos;K1&apos;, &apos;K1&apos;, &apos;K2&apos;])</span><br><span class="line"></span><br><span class="line">In [42]: result = left.join([right, right2])</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_join_multi_df.png" alt="_images/merging_join_multi_df.png"> </p>
<h1 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h1><h2 id="官方文档-2"><a href="#官方文档-2" class="headerlink" title="官方文档"></a>官方文档</h2><h3 id="文档链接-2"><a href="#文档链接-2" class="headerlink" title="文档链接"></a>文档链接</h3><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.concat.html#pandas.concat" target="_blank" rel="noopener">pandas.concat</a></p>
<h3 id="常用参数解读-2"><a href="#常用参数解读-2" class="headerlink" title="常用参数解读"></a>常用参数解读</h3><ul>
<li>objs:：series或者dataframe  </li>
<li>axis： 需要合并连接的轴，0表示行，1表示列   </li>
<li>join：inner或者outer，默认为outer </li>
</ul>
<h2 id="合并方法-2"><a href="#合并方法-2" class="headerlink" title="合并方法"></a>合并方法</h2><h3 id="实例-2"><a href="#实例-2" class="headerlink" title="实例"></a>实例</h3><ul>
<li>纵向连接相同列名的表</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">In [1]: df1 = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A0&apos;, &apos;A1&apos;, &apos;A2&apos;, &apos;A3&apos;],</span><br><span class="line">   ...:                     &apos;B&apos;: [&apos;B0&apos;, &apos;B1&apos;, &apos;B2&apos;, &apos;B3&apos;],</span><br><span class="line">   ...:                     &apos;C&apos;: [&apos;C0&apos;, &apos;C1&apos;, &apos;C2&apos;, &apos;C3&apos;],</span><br><span class="line">   ...:                     &apos;D&apos;: [&apos;D0&apos;, &apos;D1&apos;, &apos;D2&apos;, &apos;D3&apos;]&#125;,</span><br><span class="line">   ...:                     index=[0, 1, 2, 3])</span><br><span class="line">   ...: </span><br><span class="line"></span><br><span class="line">In [2]: df2 = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A4&apos;, &apos;A5&apos;, &apos;A6&apos;, &apos;A7&apos;],</span><br><span class="line">   ...:                     &apos;B&apos;: [&apos;B4&apos;, &apos;B5&apos;, &apos;B6&apos;, &apos;B7&apos;],</span><br><span class="line">   ...:                     &apos;C&apos;: [&apos;C4&apos;, &apos;C5&apos;, &apos;C6&apos;, &apos;C7&apos;],</span><br><span class="line">   ...:                     &apos;D&apos;: [&apos;D4&apos;, &apos;D5&apos;, &apos;D6&apos;, &apos;D7&apos;]&#125;,</span><br><span class="line">   ...:                      index=[4, 5, 6, 7])</span><br><span class="line">   ...: </span><br><span class="line"></span><br><span class="line">In [3]: df3 = pd.DataFrame(&#123;&apos;A&apos;: [&apos;A8&apos;, &apos;A9&apos;, &apos;A10&apos;, &apos;A11&apos;],</span><br><span class="line">   ...:                     &apos;B&apos;: [&apos;B8&apos;, &apos;B9&apos;, &apos;B10&apos;, &apos;B11&apos;],</span><br><span class="line">   ...:                     &apos;C&apos;: [&apos;C8&apos;, &apos;C9&apos;, &apos;C10&apos;, &apos;C11&apos;],</span><br><span class="line">   ...:                     &apos;D&apos;: [&apos;D8&apos;, &apos;D9&apos;, &apos;D10&apos;, &apos;D11&apos;]&#125;,</span><br><span class="line">   ...:                     index=[8, 9, 10, 11])</span><br><span class="line">   ...: </span><br><span class="line"></span><br><span class="line">In [4]: frames = [df1, df2, df3]</span><br><span class="line"></span><br><span class="line">In [5]: result = pd.concat(frames)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_basic.png" alt="_images/merging_concat_basic.png"> </p>
<p>你也可以设置<code>key</code>参数，来区分数据来自哪张表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [6]: result = pd.concat(frames, keys=[&apos;x&apos;, &apos;y&apos;, &apos;z&apos;])</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_keys.png" alt="_images/merging_concat_keys.png"> </p>
<ul>
<li>行拼接（默认外连接）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [8]: df4 = pd.DataFrame(&#123;&apos;B&apos;: [&apos;B2&apos;, &apos;B3&apos;, &apos;B6&apos;, &apos;B7&apos;],</span><br><span class="line">   ...:                     &apos;D&apos;: [&apos;D2&apos;, &apos;D3&apos;, &apos;D6&apos;, &apos;D7&apos;],</span><br><span class="line">   ...:                     &apos;F&apos;: [&apos;F2&apos;, &apos;F3&apos;, &apos;F6&apos;, &apos;F7&apos;]&#125;,</span><br><span class="line">   ...:                    index=[2, 3, 6, 7])</span><br><span class="line">   ...: </span><br><span class="line"></span><br><span class="line">In [9]: result = pd.concat([df1, df4], axis=1, sort=False)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_axis1.png" alt="_images/merging_concat_axis1.png"> </p>
<ul>
<li>行拼接（设置内连接）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [10]: result = pd.concat([df1, df4], axis=1, join=&apos;inner&apos;)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_axis1_inner.png" alt="_images/merging_concat_axis1_inner.png"> </p>
<ul>
<li>行拼接（只筛选出某一表的index）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [11]: result = pd.concat([df1, df4], axis=1, join_axes=[df1.index])</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_axis1_join_axes.png" alt="_images/merging_concat_axis1_join_axes.png"> </p>
<ul>
<li><p>无视index的合并</p>
<p>当数据表的index没有实际意义时，可以使用<code>ignore_index</code>参数，来重置合并后的数据集index</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [15]: result = pd.concat([df1, df4], ignore_index=True)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_ignore_index.png" alt="_images/merging_concat_ignore_index.png"> </p>
<ul>
<li>合并DataFrame与Series</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In [17]: s1 = pd.Series([&apos;X0&apos;, &apos;X1&apos;, &apos;X2&apos;, &apos;X3&apos;], name=&apos;X&apos;)</span><br><span class="line"></span><br><span class="line">In [18]: result = pd.concat([df1, s1], axis=1)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_mixed_ndim.png" alt="_images/merging_concat_mixed_ndim.png"> </p>
<p>当然你也可以使用<code>ignore_index</code>参数，将列名重置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [21]: result = pd.concat([df1, s1], axis=1, ignore_index=True)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_concat_series_ignore_index.png" alt="_images/merging_concat_series_ignore_index.png"> </p>
<ul>
<li>合并若干Series</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In [22]: s3 = pd.Series([0, 1, 2, 3], name=&apos;foo&apos;)</span><br><span class="line"></span><br><span class="line">In [23]: s4 = pd.Series([0, 1, 2, 3])</span><br><span class="line"></span><br><span class="line">In [24]: s5 = pd.Series([0, 1, 4, 5])</span><br><span class="line"></span><br><span class="line">In [25]: pd.concat([s3, s4, s5], axis=1)</span><br><span class="line">Out[25]: </span><br><span class="line">   foo  0  1</span><br><span class="line">0    0  0  0</span><br><span class="line">1    1  1  1</span><br><span class="line">2    2  2  4</span><br><span class="line">3    3  3  5</span><br></pre></td></tr></table></figure>
<p>你可以添加<code>keys</code>参数，来给合并后的数据集添加列名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [26]: pd.concat([s3, s4, s5], axis=1, keys=[&apos;red&apos;,&apos;blue&apos;,&apos;yellow&apos;])</span><br><span class="line">Out[26]: </span><br><span class="line">   red  blue  yellow</span><br><span class="line">0    0     0       0</span><br><span class="line">1    1     1       1</span><br><span class="line">2    2     2       4</span><br><span class="line">3    3     3       5</span><br></pre></td></tr></table></figure>
<h1 id="append"><a href="#append" class="headerlink" title="append"></a>append</h1><p>append其实就是concat的一个便捷函数，实现列的拼接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [12]: result = df1.append(df2)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_append1.png" alt="_images/merging_append1.png"> </p>
<ul>
<li>当两表列名不一致时</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [13]: result = df1.append(df4)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_append2.png" alt="_images/merging_append2.png"> </p>
<blockquote>
<p>你可以添加参数<code>ignore_index = True</code>，来重置合并数据集的index</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; In [16]: result = df1.append(df4, ignore_index=True)</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_append_ignore_index.png" alt="_images/merging_append_ignore_index.png"> </p>
</blockquote>
<ul>
<li>合并多个表</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [14]: result = df1.append([df2, df3])</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_append3.png" alt="_images/merging_append3.png"> </p>
<ul>
<li>DataFrame添加Series</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In [34]: s2 = pd.Series([&apos;X0&apos;, &apos;X1&apos;, &apos;X2&apos;, &apos;X3&apos;], index=[&apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos;])</span><br><span class="line"></span><br><span class="line">In [35]: result = df1.append(s2, ignore_index=True)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_append_series_as_row.png" alt="_images/merging_append_series_as_row.png"> </p>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><h2 id="合并两表中的值"><a href="#合并两表中的值" class="headerlink" title="合并两表中的值"></a>合并两表中的值</h2><p>你以后也许会在工作中遇到这种情况，你的团队中针对同一情况统计了两份数据，但是这两份数据都有一些缺失值，那么如何让他们相互“弥补”这些缺失值呢？</p>
<p>试试<a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.combine_first.html#pandas.DataFrame.combine_first" target="_blank" rel="noopener">pandas.DataFrame.combine_first</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">In [43]: df1 = pd.DataFrame([[np.nan, 3., 5.], [-4.6, np.nan, np.nan],</span><br><span class="line">   .....:                    [np.nan, 7., np.nan]])</span><br><span class="line">   .....: </span><br><span class="line"></span><br><span class="line">In [44]: df2 = pd.DataFrame([[-42.6, np.nan, -8.2], [-5., 1.6, 4]],</span><br><span class="line">   .....:                    index=[1, 2])</span><br><span class="line">   .....: </span><br><span class="line">In [45]: result = df1.combine_first(df2)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_combine_first.png" alt="_images/merging_combine_first.png"> </p>
<p>但是，此方法只是利用右表中的值替换了左表中的NaN。</p>
<p>另外，你还可以试试<a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.update.html#pandas.DataFrame.update" target="_blank" rel="noopener">pandas.DataFrame.update</a>，这次替换的不仅仅是NaN值，还有其他所有能在右表中找到的相同位置的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [46]: df1.update(df2)</span><br></pre></td></tr></table></figure>
<p><img src="https://pandas.pydata.org/pandas-docs/stable/_images/merging_update.png" alt="_images/merging_update.png"> </p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ul>
<li>merge主要用来根据key对数据集进行合并；</li>
<li>join相当于简化版的merge，key默认为index，所以你如果想按照index对数据集合并时，join就是你的首选；</li>
<li>concat其实是concatenate的简称，翻译过来是“连接”，所以，如果你想对数据集进行横向连接（axis = 1）或者纵向链接时，记得想起来用concat；</li>
<li>append相当于是简化版的concat，用得频次比concat要多得多。</li>
</ul>
<p>希望能通过这篇导学，给大家扫除Pandas数据融合的疑惑，当然还是那句话，<strong>Learning by doing</strong>，光看不练可不行哦，打开你的Jupyter Notebook，试试看！</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/19/2018-8-19-第六周-1-数据分析过程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/08/19/2018-8-19-第六周-1-数据分析过程/" class="post-title-link" itemprop="url">每周导学-第六周-数据分析过程</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-08-19 05:30:09" itemprop="dateCreated datePublished" datetime="2018-08-19T05:30:09+08:00">2018-08-19</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-03 12:51:55" itemprop="dateModified" datetime="2019-04-03T12:51:55+08:00">2019-04-03</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2018/08/19/2018-8-19-第六周-1-数据分析过程/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/08/19/2018-8-19-第六周-1-数据分析过程/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Build a dream and the dream will build you.</p>
</blockquote>
<p>Hi，同学们，上一阶段我们学习了Python的基础知识，简单了解了Python数据分析的关键库——Pandas，并且通过项目二的实战，相信大家也一定信心满满的准备学习更多的Pandas知识了吧！那么从今天开始未来的四周内，我们将会对Pandas进行更细致的学习，大家加油吧!</p>
<p>本周开始，我们就进入到了<strong>项目三(P3)阶段</strong>，本阶段总共包含<strong>四周</strong>，在这一个月内，我们要对<strong>数据分析入门</strong>进行学习，学习数据分析思维，掌握Python数据分析及可视化方法，并使用所学知识完成<strong>项目三：探索数据集</strong>，尝试着自己完成整个数据分析的流程，得到一些饶有兴趣的结论，你一定会非常有成就感哒！那么以下便是这四周的学习安排：</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>第1周</strong></td>
<td><strong>数据分析过程-1</strong></td>
<td><strong>数据分析过程&amp;案例研究-1</strong></td>
</tr>
<tr>
<td>第2周</td>
<td>数据分析过程-2</td>
<td>案例研究-1&amp;案例研究-2</td>
</tr>
<tr>
<td>第3周</td>
<td>完成项目</td>
<td>项目：探索数据集</td>
</tr>
<tr>
<td>第4周</td>
<td>项目修改与通过</td>
<td>修改项目、查缺补漏、休息调整</td>
</tr>
</tbody>
</table>
<font size="3" color="red">！！看这里！！：在P3课程里面安排了SQL的高阶课程，但是因为在项目三中并不会涉及到SQL知识，所以为了保证大家学习的连贯性，在完成前两周的课程之后，就开始项目。至于！！SQL的高阶知识，大家可以放在课程通关后进行选修！！； </font>

<p>本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/百度搜索、<a href="http://www.runoob.com/python3/python3-tutorial.html" target="_blank" rel="noopener">菜鸟教程</a>、<a href="https://www.csdn.net/" target="_blank" rel="noopener">CSDN</a>、<a href="https://stackoverflow.com/" target="_blank" rel="noopener">stack<strong>overflow</strong></a>、<a href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/Python%20for%20Data%20Analysis%2C%202nd%20Edition.pdf" target="_blank" rel="noopener"><strong>Python for Data Analysis, 2nd Edition</strong> </a>、<a href="http://python3-cookbook.readthedocs.io/zh_CN/latest/" target="_blank" rel="noopener">Python Cookbook</a></li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p><strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><ul>
<li>学习课程中<strong>数据分析过程</strong>中的全部和<strong>案例研究1</strong>的部分内容，了解数据分析过程，熟练掌握Pandas在数据分析中的应用。</li>
</ul>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>数据分析过程&amp;案例研究-1</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody>
</table>
<h1 id="本周知识清单"><a href="#本周知识清单" class="headerlink" title="本周知识清单"></a>本周知识清单</h1><h2 id="前期准备-amp-拓展"><a href="#前期准备-amp-拓展" class="headerlink" title="前期准备&amp;拓展"></a>前期准备&amp;拓展</h2><ul>
<li>在<strong>课程概述</strong>给出的链接很重要，希望大家能抽空都看一看，尤其是最后的书Python for Data Analysis，目前已经出了第二版，可以戳<a href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/Python%20for%20Data%20Analysis%2C%202nd%20Edition.pdf" target="_blank" rel="noopener">下载链接</a>进行下载。</li>
<li>关于<strong>设置编程环境</strong>，本章已经不是建议了，而是<strong>要求</strong>，如果你还没有完成本地环境的配置，请戳：<a href="https://classroom.udacity.com/nanodegrees/nd002-cn-basic-vip/parts/e566ad37-6119-4448-a6bc-7ade73ef3992" target="_blank" rel="noopener">配置Anaconda和Jupyter Notebook</a></li>
</ul>
<h2 id="数据分析流程"><a href="#数据分析流程" class="headerlink" title="数据分析流程"></a>数据分析流程</h2><p><strong>数据分析不是从上至下一蹴而就的过程，而是需要你不断迭代、重复、完善，最终得到结论的过程。</strong></p>
<h3 id="提出问题"><a href="#提出问题" class="headerlink" title="提出问题"></a>提出问题</h3><ul>
<li><p>数据集中的各个变量之间的相关性如何？是否存在某些联系？</p>
</li>
<li><p>变量的统计结果会揭示什么？</p>
</li>
<li><p>根据现有掌握的数据，能否对未来走势进行预测？</p>
</li>
<li><p>根据你想了解的问题，去收集数据，再对问题进行修缮，如此<strong>迭代</strong>，获取更全面的数据，提出更一阵见血的问题。</p>
<p>…</p>
</li>
</ul>
<h3 id="整理数据"><a href="#整理数据" class="headerlink" title="整理数据"></a>整理数据</h3><ul>
<li><p>收集</p>
<p>数据库提取？直接下载？网络爬虫？</p>
</li>
<li><p>评估</p>
<p>这个过程是对数据产生直观印象的过程，你要尝试了解数据集的大小，基本的统计结果，是否存在数据重复？缺失？数据类型是否正确？是否每个变量成一列&amp;每个观察值成一行？数据是否有统计错误？(严重偏离正常值，比如说气温达到70℃等等)…</p>
</li>
<li><p>清理</p>
<p>对评估出的问题进行逐项排查、清理，直至获取到干净的数据（推荐超级有用且经典的<a href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html" target="_blank" rel="noopener">Tidy Data</a>，虽然代码用的是R语言，但代码不就只是工具而已嘛，关键的是<strong>思维方法</strong>）</p>
</li>
</ul>
<h3 id="探索性数据分析"><a href="#探索性数据分析" class="headerlink" title="探索性数据分析"></a>探索性数据分析</h3><p>即课程中提到的EDA(Exploratory data analysis )，这是一种分析数据集——尤其是陌生数据集——的方法，具体实施的话可以采用定量、定性的数据分析或者是可视化分析。</p>
<p>这是一个强调<strong>迭代</strong>的过程，在这个阶段你要不断的对数据进行探索（提问、整理、分析、可视化等等），根据你得到的结果再去丰富你的数据或者完善你的问题，最终得出结论。</p>
<p>这是一个考验耐心和细心的繁琐过程，所以一定要<strong>心平气和</strong>，保持<strong>工作的连贯性</strong>。（<del>不做完一套不能睡觉？</del>）</p>
<h3 id="得出结论"><a href="#得出结论" class="headerlink" title="得出结论"></a>得出结论</h3><ul>
<li>通过可视化直接得出结论（描述、总结）</li>
<li>统计学（预测，P4阶段会学习）</li>
<li>机器学习算法（主要是用来做预测，课下可以学一学）</li>
</ul>
<h3 id="传达结果"><a href="#传达结果" class="headerlink" title="传达结果"></a>传达结果</h3><p>撰写报告，和别人分享你的研究结果，所以一定要逻辑清晰、结论都要有根有据，让被分享者信服你的结论。</p>
<h2 id="Pandas在数据分析中的应用"><a href="#Pandas在数据分析中的应用" class="headerlink" title="Pandas在数据分析中的应用"></a>Pandas在数据分析中的应用</h2><h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><ul>
<li><p>导入Pandas包</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
</li>
<li><p>打开文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#打开csv文件</span></span><br><span class="line">pd.read_csv(<span class="string">'filename'</span>)</span><br><span class="line"><span class="comment">#打开excel文件</span></span><br><span class="line">pd.read_excel(<span class="string">'filename'</span>)</span><br><span class="line"><span class="comment">#处理中文字符的tsv文件</span></span><br><span class="line">pd.read_csv(<span class="string">'filename'</span>,sep = <span class="string">'\t'</span>,encoding = <span class="string">'utf-8'</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="整理数据-1"><a href="#整理数据-1" class="headerlink" title="整理数据"></a>整理数据</h3><ul>
<li><p>查看数据集数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看前五行</span></span><br><span class="line">df.head()</span><br><span class="line"><span class="comment">#查看尾五行</span></span><br><span class="line">df.tail()</span><br><span class="line"><span class="comment">#查看随机一行</span></span><br><span class="line">df.sample()</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看数据集信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看数据集行数和列数</span></span><br><span class="line">df.shape</span><br><span class="line"><span class="comment">#查看数据集信息（列名、数据类型、每列的数据量——可以看出数据缺失情况）</span></span><br><span class="line">df.info()</span><br><span class="line"><span class="comment">#查看数据集基本统计信息</span></span><br><span class="line">df.describe()</span><br><span class="line"><span class="comment">#查看数据集列名</span></span><br><span class="line">df.columns</span><br><span class="line"><span class="comment">#查看数据集数据缺失情况 </span></span><br><span class="line">df.isnull().sum()</span><br><span class="line"><span class="comment">#查看缺失列数据</span></span><br><span class="line">df[df[<span class="string">'col_name'</span>].isnull()]</span><br><span class="line"><span class="comment">#查看数据集数据重复情况</span></span><br><span class="line">sum(df.duplicated())</span><br><span class="line"><span class="comment">#查看重复数据</span></span><br><span class="line">df[df.duplicated()]</span><br><span class="line"><span class="comment">#查看某列分类统计情况</span></span><br><span class="line">df[<span class="string">'col_name'</span>].value_counts()</span><br><span class="line"><span class="comment">#查看某列唯一值</span></span><br><span class="line">df[<span class="string">'col_name'</span>].unique()</span><br><span class="line"><span class="comment">#查看某列唯一值数量</span></span><br><span class="line">df[<span class="string">'col_name'</span>].nunique()</span><br><span class="line"><span class="comment">#以某列对数据集进行排序</span></span><br><span class="line">df.sort_values(by = <span class="string">'col_name'</span>,ascending = <span class="literal">False</span>)<span class="comment">#False为由大至小</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>数据筛选</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#提取某行</span></span><br><span class="line">df.iloc[row_index]</span><br><span class="line">df.loc[<span class="string">'row_name'</span>]</span><br><span class="line"><span class="comment">#提取某几行</span></span><br><span class="line">df.iloc[row_index_1:row_index_2]</span><br><span class="line"><span class="comment">#提取某列</span></span><br><span class="line">df[<span class="string">'col_name'</span>]</span><br><span class="line"><span class="comment">#提取某几列</span></span><br><span class="line">df[[<span class="string">'col_name_1'</span>,<span class="string">'col_name_2'</span>]]</span><br><span class="line"><span class="comment">#提取某行某列的值</span></span><br><span class="line">df.iloc[row_index,col_index]</span><br><span class="line">df.loc[<span class="string">'row_name'</span>,<span class="string">'col_name'</span>]</span><br><span class="line"><span class="comment">#筛选某列中满足某条件的数据</span></span><br><span class="line">df[df[<span class="string">'col_name'</span>] == value]<span class="comment">#等于某值的数据，同理满足所有比较运算符</span></span><br><span class="line">df.query(<span class="string">'col_name == value'</span>)<span class="comment">#代码效果同上</span></span><br><span class="line">df[(df[<span class="string">'col_name_1'</span>] &gt;= value_1) &amp; (df[<span class="string">'col_name_2'</span>] != value_2)]<span class="comment">#与&amp;，或|</span></span><br><span class="line">df.query(<span class="string">'(col_name_1 &gt;= value_lower) &amp; (col_name_2 &lt;= value_upper)'</span>)</span><br><span class="line">df.groupby(<span class="string">'col_name'</span>)<span class="comment">#按col_name列进行分组</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>清理数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除某行</span></span><br><span class="line">df.drop([<span class="string">'row_name'</span>],inplace = <span class="literal">True</span>)<span class="comment">#若添加inplace = True，修改后的数据会覆盖原始数据</span></span><br><span class="line"><span class="comment">#删除某列</span></span><br><span class="line">df.drop([<span class="string">'col_name'</span>],axis = <span class="number">1</span>)</span><br><span class="line"><span class="comment">#缺失值的处理</span></span><br><span class="line">df.fillna(mean_value)<span class="comment">#替换缺失值</span></span><br><span class="line">df.dropna()<span class="comment">#删除包含缺失值的行</span></span><br><span class="line">df.dropna(axis = <span class="number">1</span>, how = <span class="string">'all'</span>)<span class="comment">#只删除所有数据缺失的列</span></span><br><span class="line"><span class="comment">#删除重复值</span></span><br><span class="line">drop_duplicates(inplace = <span class="literal">True</span>)</span><br><span class="line"><span class="comment">#更改某行/列/位置数据</span></span><br><span class="line">用iloc或者loc直接替换修改即可</span><br><span class="line"><span class="comment">#更改数据类型</span></span><br><span class="line">df[<span class="string">'datetime_col'</span>] = pd.to_datetime(df[<span class="string">'datetime_col'</span>])</span><br><span class="line">df[<span class="string">'col_name'</span>].astype(str)<span class="comment">#还可以是int/float...</span></span><br><span class="line"><span class="comment">#更改列名</span></span><br><span class="line">df.rename(columns=&#123;<span class="string">'A'</span>:<span class="string">'a'</span>, <span class="string">'C'</span>:<span class="string">'c'</span>&#125;, inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如何处理缺失值呢？这就要根据确实数据的情况而定了，是直接删除？还是暴力平均值替换？还是分类之后再用平均值替换？还是用一些什么其他的方法，全靠你去把握了。可以看一看<strong>Python Data Science</strong>这本书中的<a href="https://jakevdp.github.io/PythonDataScienceHandbook/03.04-missing-values.html" target="_blank" rel="noopener"><strong>Handling Missing Data</strong></a>章节，你肯定会有所收获的。</p>
</blockquote>
</li>
<li><p>合并数据(merge、concat、join、append)</p>
<p>因为这里比较繁琐，而且讲起来会用到很多图表，所以进行单独讲解，链接→<a href="http://www.capallen.top/dand-vip/2018/08/21/%E7%AC%AC%E5%85%AD%E5%91%A8-2-%E6%95%B0%E6%8D%AE%E8%9E%8D%E5%90%88/" target="_blank" rel="noopener">每周导学-第六周导学-Pandas数据融合</a></p>
</li>
</ul>
<h3 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h3><p>我会将Pandas的可视化部分与<strong>matplotlib.pyplot</strong>的可视化和<strong>seaborn/ggplot</strong>等可视化包放在下周的导学中。</p>
<h3 id="导出数据"><a href="#导出数据" class="headerlink" title="导出数据"></a>导出数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导出csv文件</span></span><br><span class="line">df.to_csv(<span class="string">'filename.csv'</span>,index = <span class="literal">False</span>)</span><br><span class="line"><span class="comment">#导出中文字符的excel文件</span></span><br><span class="line">df.to_excel(<span class="string">'filename.xlsx'</span>,index = <span class="literal">False</span>,encoding = <span class="string">'utf-8-sig'</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Tip:<a href="https://blog.csdn.net/u012965373/article/details/52680787" target="_blank" rel="noopener">utf-8与utf-8-sig 两种编码格式区别</a></p>
</blockquote>
<h1 id="项目相关"><a href="#项目相关" class="headerlink" title="项目相关"></a>项目相关</h1><p>P3的项目需要你完完整整得过一遍数据分析的过程，所以呢，单独的某一个数据集肯定满足不了大家，贴心的Udacity给大家准备了几个数据集备选，戳<a href="https://github.com/udacity/new-dand-basic-china/blob/master/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%A5%E9%97%A8/%E9%A1%B9%E7%9B%AE-%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86/%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E9%9B%86%20-%20%E5%A4%87%E9%80%89%E6%95%B0%E6%8D%AE%E9%9B%86.md" target="_blank" rel="noopener">数据集预览</a>，挑一个自己感兴趣的先~</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/13/2018-8-13-第五周导学/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/08/13/2018-8-13-第五周导学/" class="post-title-link" itemprop="url">每周导学-第五周-阶段总结&项目二优化</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-08-13 20:30:09" itemprop="dateCreated datePublished" datetime="2018-08-13T20:30:09+08:00">2018-08-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-03 12:51:55" itemprop="dateModified" datetime="2019-04-03T12:51:55+08:00">2019-04-03</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2018/08/13/2018-8-13-第五周导学/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/08/13/2018-8-13-第五周导学/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Don’t let yesterday take up too much of today.</p>
</blockquote>
<p>Hi，同学们，本周是P2阶段的最后一周了，我们用了两周时间学习了数据类型、控制流以及脚本编写等Python基础内容，还学习了Python做数据分析两个关键的第三方包——NumPy和Pandas，接下来用了一周的时间挑战项目二，相信大家经过了高强度的学习+实战化项目，对Python及Pandas一定有了更深刻更扎实的了解，那么，本周呢我们的针对P2的<strong>知识点</strong>进行<strong>总结回顾</strong>，对<strong>项目二</strong>进行修缮<strong>拓展</strong>，为下一阶段打好基础！ </p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody>
<tr>
<td>第1周</td>
<td>Python基础内容</td>
<td>数据类型和运算符、控制流、函数、脚本编写</td>
</tr>
<tr>
<td>第2周</td>
<td>Python数据处理内容</td>
<td>Numpy &amp; Pandas - 第一、二部分</td>
</tr>
<tr>
<td>第3周</td>
<td>完成项目</td>
<td>项目：探索美国共享单车数据</td>
</tr>
<tr>
<td><strong>第4周</strong></td>
<td><strong>项目修改与通过</strong></td>
<td><strong>修改项目、查缺补漏、休息调整</strong></td>
</tr>
</tbody>
</table>
<p>对于非小白同学来说 ，本阶段内容不是很难，希望你们能在三周内完成并通过项目；  </p>
<p>对于小白来说，本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/百度搜索、<a href="http://www.runoob.com/python3/python3-tutorial.html" target="_blank" rel="noopener">菜鸟教程</a>、<a href="https://www.csdn.net/" target="_blank" rel="noopener">CSDN</a>、<a href="https://stackoverflow.com/" target="_blank" rel="noopener">stack<strong>overflow</strong></a>、<a href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/Python%20for%20Data%20Analysis%2C%202nd%20Edition.pdf" target="_blank" rel="noopener"><strong>Python for Data Analysis, 2nd Edition</strong> </a>、<a href="http://python3-cookbook.readthedocs.io/zh_CN/latest/" target="_blank" rel="noopener">Python Cookbook</a></li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p><strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><ul>
<li>顺利通过项目二，自行总结P2阶段的知识点。</li>
</ul>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>项目二</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody>
</table>
<h1 id="阶段总结"><a href="#阶段总结" class="headerlink" title="阶段总结"></a>阶段总结</h1><p>在本阶段，我们学习了：</p>
<ul>
<li>Python的数据类型和运算符</li>
<li>Python的循环、判断语句</li>
<li>如何自定义Python函数</li>
<li>NumPy&amp;Pandas的基本操作</li>
</ul>
<p>除此之外，你还掌握了一些软件的操作：</p>
<ul>
<li>Python IDE的使用（Spyder/Atom）</li>
<li>Jupyter Notebook的使用</li>
<li>Python拓展包的安装部署</li>
</ul>
<p>不知不觉间，你还锻炼了一些软技能：</p>
<ul>
<li><strong>编程思维</strong>（把复杂的问题分解；把新问题变成老问题；凝练解决问题的核心；算法最优解）</li>
<li><strong>自主学习能力</strong>（效率更高，方法更优，持续时间更长）</li>
<li>独立解决问题的能力</li>
<li>更积极、更自信</li>
</ul>
<p>经过这一个月的学习，大家收获颇丰。除了硬技能之外，更重要的是软技能的锻炼，不论你从事何种工作，甚至是在生活中，编程思维和自主学习能力都会让你尝到甜头，所以请继续加油吧！</p>
<h2 id="知识要点"><a href="#知识要点" class="headerlink" title="知识要点"></a>知识要点</h2><h3 id="第二周必学知识点："><a href="#第二周必学知识点：" class="headerlink" title="第二周必学知识点："></a>第二周必学知识点：</h3><ul>
<li><p><a href="http://www.capallen.top/dand-vip/2018/07/23/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AF%BC%E5%AD%A6/#2-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E8%BF%90%E7%AE%97%E7%AC%A6" target="_blank" rel="noopener">Python数据类型和运算符</a></p>
<blockquote>
<p>可以先自行回想一下，python的数据类型有哪些？运算符有哪些？在这一个月的练习和项目中，他们的用途都有哪些？自己在这一章节有没有薄弱点？</p>
</blockquote>
</li>
<li><p><a href="www.capallen.top/dand-vip/2018/07/23/第二周导学/#3-控制流">控制流</a></p>
<blockquote>
<p>重点要<strong>熟练</strong>掌握：一个条件语句和两个循环语句的用法，两个循环语句的区别，break与continue的用法，再就是enumerate函数的用法。</p>
</blockquote>
</li>
<li><p><a href="http://www.capallen.top/dand-vip/2018/07/23/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AF%BC%E5%AD%A6/#4-%E5%87%BD%E6%95%B0" target="_blank" rel="noopener">函数</a></p>
<blockquote>
<p>函数的定义及变量的作用域是要熟练掌握的，lambda的话，了解就好。</p>
</blockquote>
</li>
</ul>
<h3 id="第三周必学知识点："><a href="#第三周必学知识点：" class="headerlink" title="第三周必学知识点："></a>第三周必学知识点：</h3><ul>
<li><p>Pandas数据结构</p>
<blockquote>
<p>对于Pandas中两大最重要的数据类型：Series(一维)和DataFrame(二维)，熟悉他们的结构和特点，这是你用python Pandas做数据分析的基础。</p>
</blockquote>
<ul>
<li><a href="http://www.capallen.top/dand-vip/2018/08/01/%E7%AC%AC%E4%B8%89%E5%91%A8%E5%AF%BC%E5%AD%A6/#13%E7%BB%83%E4%B9%A0pandas-series" target="_blank" rel="noopener">Pandas Series</a></li>
<li><a href="http://www.capallen.top/dand-vip/2018/08/01/%E7%AC%AC%E4%B8%89%E5%91%A8%E5%AF%BC%E5%AD%A6/#5numpy%E5%92%8Cpandas%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B" target="_blank" rel="noopener">Pandas DataFrame</a></li>
</ul>
</li>
<li><p>Pandas数据操作</p>
<blockquote>
<p>本阶段主要是对Pandas中数据的基本操作进行了讲解，在P3阶段会有更多的操作技巧及练习等着大家！</p>
</blockquote>
<ul>
<li><a href="http://www.capallen.top/dand-vip/2018/08/01/%E7%AC%AC%E4%B8%89%E5%91%A8%E5%AF%BC%E5%AD%A6/#14%E7%BB%83%E4%B9%A0series%E7%B4%A2%E5%BC%95" target="_blank" rel="noopener">索引</a></li>
<li><a href="http://www.capallen.top/dand-vip/2018/08/01/%E7%AC%AC%E4%B8%89%E5%91%A8%E5%AF%BC%E5%AD%A6/#6%E7%BB%83%E4%B9%A0%E8%AE%BF%E9%97%AEdataframe%E5%85%83%E7%B4%A0" target="_blank" rel="noopener">访问数据</a></li>
</ul>
</li>
<li><p>Pandas自定义函数的调用</p>
<blockquote>
<p>常用的是apply，但两者的区别要搞清楚</p>
</blockquote>
<ul>
<li><a href="http://www.capallen.top/dand-vip/2018/08/01/%E7%AC%AC%E4%B8%89%E5%91%A8%E5%AF%BC%E5%AD%A6/#17%E7%BB%83%E4%B9%A0pandas-series-apply" target="_blank" rel="noopener">Series apply</a></li>
<li><a href="http://www.capallen.top/dand-vip/2018/08/01/%E7%AC%AC%E4%B8%89%E5%91%A8%E5%AF%BC%E5%AD%A6/#11%E7%BB%83%E4%B9%A0dataframe-applymap" target="_blank" rel="noopener">DataFrame applymap</a></li>
</ul>
</li>
<li><p>Pandas常用数据筛选函数</p>
<blockquote>
<p>这个的话，本章涉及不多，可以等到P3学完一起总结，按照数据分析的流程，把各个阶段常用的函数做个用法列举，效果更好。</p>
</blockquote>
<ul>
<li>分类筛选<a href="http://www.capallen.top/dand-vip/2018/08/01/%E7%AC%AC%E4%B8%89%E5%91%A8%E5%AF%BC%E5%AD%A6/#16%E7%BB%83%E4%B9%A0pandas-groupby" target="_blank" rel="noopener">groupby</a></li>
</ul>
</li>
</ul>
<h2 id="项目优化"><a href="#项目优化" class="headerlink" title="项目优化"></a>项目优化</h2><p>虽然收到了项目二的通关邮件，但是你对自己的代码或者项目的完成度满意吗？大家在Uda学习，也是为生活所迫，想求上进，那既然是求上进，就别上到90%就放松下来，做就做到100%，<strong>一定要对自己负责</strong>，所以大家通关后，我会拉大家到【代码互评】的微信群，大家分享代码、分享思路，交流心得，相互挑刺，想想就觉得很棒！所以说，大家讨论完之后，这个板块还会再进行更新~</p>
<p>废话不多说，那么，我先来抛砖引玉，给大家简单展示下我认为的一些可以尝试去改进的地方：</p>
<h3 id="get-filters-函数"><a href="#get-filters-函数" class="headerlink" title="get_filters()函数"></a>get_filters()函数</h3><ul>
<li><p>用户输入错误时提示再次输入；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ... <span class="keyword">in</span> ...:</span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'提示：'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>兼容大小写，只要用户输入了正确数据，即可进行响应，比如说用户想要筛选城市chicago的数据，但是不小心输成了Chicago，也能进行正确响应。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">city = city_input.lower()</span><br></pre></td></tr></table></figure>
</li>
<li><p>利用循环和函数简化重复性代码</p>
<p>比如说，最开始我写的代码是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_filters</span><span class="params">()</span>:</span></span><br><span class="line">   print(<span class="string">'Hello! Let\'s explore some US bikeshare data!'</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#定义列表</span></span><br><span class="line">    city_list = [<span class="string">'chicago'</span>,<span class="string">'new york city'</span>,<span class="string">'washington'</span>]</span><br><span class="line">    month_list = [<span class="string">'all'</span>,<span class="string">'january'</span>,<span class="string">'february'</span>,<span class="string">'march'</span>,<span class="string">'april'</span>,<span class="string">'may'</span>,<span class="string">'june'</span>]</span><br><span class="line">    day_list = [<span class="string">'all'</span>,<span class="string">'monday'</span>,<span class="string">'tuesday'</span>,<span class="string">'wednesday'</span>,<span class="string">'thursday'</span>,<span class="string">'friday'</span>,<span class="string">'saturday'</span>,<span class="string">'sunday'</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        city = input(<span class="string">'Q1/3:which city do you want to analyst?(chicago,new york city or washington)\n'</span>)</span><br><span class="line">        <span class="keyword">if</span> city <span class="keyword">in</span> city_list:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'please ensure your input is one of the examples!'</span>)</span><br><span class="line">       </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        month = input(<span class="string">'Q2/3:which month do you want to analyst?(all,january, february, ... , june)\n'</span>)</span><br><span class="line">        <span class="keyword">if</span> month <span class="keyword">in</span> month_list:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'please ensure your input is one of the examples!'</span>)</span><br><span class="line">       </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        day = input(<span class="string">'Q3/3:which day do you want to analyst?(all, monday, tuesday, ... sunday)\n'</span>)</span><br><span class="line">        <span class="keyword">if</span> day <span class="keyword">in</span> day_list:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'please ensure your input is one of the examples!'</span>)   </span><br><span class="line"></span><br><span class="line">    print(<span class="string">'-'</span>*<span class="number">40</span>)</span><br><span class="line">    <span class="keyword">return</span> (city, month, day)</span><br></pre></td></tr></table></figure>
<p>如上，对于city、month和day三个变量来说，代码是重复的，只是变量不同输出的话术不同而已，那么就可以将这三个变量和话术对应成某个函数的参数，然后通过调用这个函数，就可以简化重复的代码。</p>
<p>这个函数大概可以是这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">phrase_input</span><span class="params">(input_prompt,err_prompt,option_list)</span>:</span></span><br><span class="line">    </span><br><span class="line">    user_input = input(input_prompt)</span><br><span class="line">    <span class="keyword">while</span> user_input <span class="keyword">not</span> <span class="keyword">in</span> option_list:</span><br><span class="line">        user_input = input(err_prompt)</span><br><span class="line">    <span class="keyword">return</span> (user_input)</span><br></pre></td></tr></table></figure>
<p>改善后的代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">phrase_input</span><span class="params">(input_prompt,err_prompt,option_list,get_value)</span>:</span></span><br><span class="line">    </span><br><span class="line">    user_input = input(input_prompt)</span><br><span class="line">    <span class="keyword">while</span> get_value(user_input) <span class="keyword">not</span> <span class="keyword">in</span> option_list:</span><br><span class="line">        user_input = input(err_prompt)</span><br><span class="line">    <span class="keyword">return</span> (user_input.title())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_filters</span><span class="params">()</span>:</span></span><br><span class="line">   print(<span class="string">'Hello! Let\'s explore some US bikeshare data!'</span>)</span><br><span class="line">       </span><br><span class="line">    <span class="comment">#定义列表</span></span><br><span class="line">   city_list = [<span class="string">'chicago'</span>,<span class="string">'new york city'</span>,<span class="string">'washington'</span>]</span><br><span class="line">   month_list = [<span class="string">'all'</span>,<span class="string">'january'</span>,<span class="string">'february'</span>,<span class="string">'march'</span>,<span class="string">'april'</span>,<span class="string">'may'</span>,<span class="string">'june'</span>]</span><br><span class="line">   day_list = [<span class="string">'all'</span>,<span class="string">'monday'</span>,<span class="string">'tuesday'</span>,<span class="string">'wednesday'</span>,<span class="string">'thursday'</span>,<span class="string">'friday'</span>,<span class="string">'saturday'</span>,<span class="string">'sunday'</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#定义话术</span></span><br><span class="line">   city_prompt = <span class="string">'Q1/3:which city do you want to analyst?(Chicago,New York city or Washington)\n'</span></span><br><span class="line">   month_prompt = <span class="string">'Q2/3:which month do you want to analyst?(All,January, February, ... , June)\n'</span></span><br><span class="line">   day_prompt = <span class="string">'Q3/3:which day do you want to analyst?(All, Monday, Tuesday, ... Sunday)\n'</span></span><br><span class="line">   err_prompt = <span class="string">'Please ensure your input is one of the examples above. Please input it again:\n'</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">#定义get_value函数，取输入的小写值</span></span><br><span class="line">   get_value = <span class="keyword">lambda</span> x: x.lower()</span><br><span class="line">   </span><br><span class="line">    <span class="comment">#调用函数</span></span><br><span class="line">   city = phrase_input(city_prompt,err_prompt,city_list,get_value)</span><br><span class="line">   month = phrase_input(month_prompt,err_prompt,month_list,get_value)</span><br><span class="line">   day = phrase_input(day_prompt,err_prompt,day_list,get_value)</span><br><span class="line">   </span><br><span class="line">   print(<span class="string">'-'</span>*<span class="number">40</span>)</span><br><span class="line">   print(<span class="string">'Your input is : \n'</span>)</span><br><span class="line">   print(city, month, day)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="trip-duration-stats-函数"><a href="#trip-duration-stats-函数" class="headerlink" title="trip_duration_stats()函数"></a>trip_duration_stats()函数</h3><p>这个函数最大的问题就是，输出不够人性化，因为计算得来的时间计算值是<code>xxx秒</code>，而我们平时生活中，对于大于60s的时间更偏向于说<code>xxx分</code>，或者<code>xxx小时</code>、<code>xxx天</code>。所以这里，为了优化输出，需要我们定义一个<code>时间转换函数</code>，把计算结果，更人性化地呈现。</p>
<p>最终代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">changeTime</span><span class="params">(allTime)</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#定义一天、一小时、一分钟的秒数</span></span><br><span class="line">    day = <span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span></span><br><span class="line">    hour = <span class="number">60</span>*<span class="number">60</span></span><br><span class="line">    min = <span class="number">60</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#小于60s时，利用math.ceil函数向上取整</span></span><br><span class="line">    <span class="keyword">if</span> allTime &lt;<span class="number">60</span>:        </span><br><span class="line">        <span class="keyword">return</span> (<span class="string">"%d sec(s)"</span>%math.ceil(allTime))</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#利用divmod函数，获取模和余数的元组，将模作为 天，将余数继续进行函数</span></span><br><span class="line">    <span class="keyword">elif</span>  allTime &gt; day:</span><br><span class="line">        days = divmod(allTime,day) </span><br><span class="line">        <span class="keyword">return</span> (<span class="string">"%d day(s), %s"</span>%(int(days[<span class="number">0</span>]),changeTime(days[<span class="number">1</span>])))</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#跟上面同理</span></span><br><span class="line">    <span class="keyword">elif</span> allTime &gt; hour:</span><br><span class="line">        hours = divmod(allTime,hour)</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">'%d hour(s), %s'</span>%(int(hours[<span class="number">0</span>]),changeTime(hours[<span class="number">1</span>])))</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        mins = divmod(allTime,min)</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">"%d min(s), %d sec(s)"</span>%(int(mins[<span class="number">0</span>]),math.ceil(mins[<span class="number">1</span>])))</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trip_duration_stats</span><span class="params">(df)</span>:</span></span><br><span class="line">    </span><br><span class="line">    print(<span class="string">'\nCalculating Trip Duration...\n'</span>)</span><br><span class="line">    start_time = time.time()</span><br><span class="line"></span><br><span class="line">    total_duration = df[<span class="string">'Trip Duration'</span>].sum()</span><br><span class="line"></span><br><span class="line">    mean_duration = df[<span class="string">'Trip Duration'</span>].mean()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#利用format进行格式化输出，调用changeTime函数</span></span><br><span class="line">    print(<span class="string">'The total travel time is around &#123;&#125; .'</span>.format(changeTime(total_duration)))</span><br><span class="line">    print(<span class="string">'The mean of travel time is around &#123;&#125; .'</span>.format(changeTime(mean_duration)))</span><br><span class="line">    </span><br><span class="line">    print(<span class="string">"\nThis took %s seconds."</span> % (time.time() - start_time))</span><br><span class="line">    print(<span class="string">'-'</span>*<span class="number">40</span>)</span><br></pre></td></tr></table></figure>
<p>出现的一些不熟悉的代码/函数详解可以戳：</p>
<p><a href="http://www.runoob.com/python3/python3-func-number-ceil.html" target="_blank" rel="noopener">ceil</a></p>
<p><a href="https://www.cnblogs.com/zyq-blog/p/5946905.html" target="_blank" rel="noopener">利用%和format进行输出格式化</a></p>
<p><a href="http://www.runoob.com/python/python-func-divmod.html" target="_blank" rel="noopener">devmod</a></p>
<h3 id="user-stats-函数"><a href="#user-stats-函数" class="headerlink" title="user_stats()函数"></a>user_stats()函数</h3><p>这个函数面临的问题是由于数据集导致的，因为在Washington的数据缺失了性别和出生年份列，所以本函数在调用Washington数据的时候会报错，那这里就需要try和except登场进行异常处理了。</p>
<p>这里的相关知识可以参考<a href="http://www.capallen.top/dand-vip/2018/07/23/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AF%BC%E5%AD%A6/#%E9%94%99%E8%AF%AF%E4%B8%8E%E5%BC%82%E5%B8%B8" target="_blank" rel="noopener">第二周导学</a>。</p>
<h3 id="其他待优化的问题"><a href="#其他待优化的问题" class="headerlink" title="其他待优化的问题"></a>其他待优化的问题</h3><p>比如说，你还想对数据中的哪些问题感兴趣，可以自定函数进行展示；</p>
<p>或者，你的代码并不符合PEP8的标准，可以参考<a href="http://www.capallen.top/dand-vip/2018/07/23/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AF%BC%E5%AD%A6/#1-python%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95" target="_blank" rel="noopener">第二周导学</a>，进行查证。</p>
<p>…</p>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>经过如上的过程，大家也能了解到代码都不是一蹴而就的，而是随着你项目的深入不断进行修改调试的过程，这和你的学习一样，是一个不断试错，螺旋上升的过程。所以说，<strong>不要怕不会，更不要怕做错</strong>，不要丢了信心和耐心，把不会的掌握，把问题解决，这才是你应该做的，大家加油！！！</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/06/2018-8-6-第四周导学/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/08/06/2018-8-6-第四周导学/" class="post-title-link" itemprop="url">每周导学-第四周-项目二</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-08-06 20:30:09" itemprop="dateCreated datePublished" datetime="2018-08-06T20:30:09+08:00">2018-08-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-03 12:51:55" itemprop="dateModified" datetime="2019-04-03T12:51:55+08:00">2019-04-03</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2018/08/06/2018-8-6-第四周导学/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/08/06/2018-8-6-第四周导学/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Don’t let yesterday take up too much of today.</p>
</blockquote>
<p>Hi，同学们，本周已经是P2阶段的第三周了，前两周我们学习了数据类型、控制流以及脚本编写等Python基础内容，还学习了Python做数据分析两个关键的第三方包——NumPy和Pandas，那么，接下来就到了检验学习、提高实战能力的时候了！</p>
<p>这周我们要挑战<strong>项目二：探索美国共享单车数据</strong>，争取能在本周完成项目并提交，加油！</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody>
<tr>
<td>第1周</td>
<td>Python基础内容</td>
<td>数据类型和运算符、控制流、函数、脚本编写</td>
</tr>
<tr>
<td>第2周</td>
<td>Python数据处理内容</td>
<td>Numpy &amp; Pandas - 第一、二部分</td>
</tr>
<tr>
<td><strong>第3周</strong></td>
<td><strong>完成项目</strong></td>
<td><strong>项目：探索美国共享单车数据</strong></td>
</tr>
<tr>
<td>第4周</td>
<td>项目修改与通过</td>
<td>修改项目、查缺补漏、休息调整</td>
</tr>
</tbody>
</table>
<p>对于非小白同学来说 ，本阶段内容不是很难，希望你们能在三周内完成并通过项目；  </p>
<p>对于小白来说，本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/百度搜索、<a href="http://www.runoob.com/python3/python3-tutorial.html" target="_blank" rel="noopener">菜鸟教程</a>、<a href="https://www.csdn.net/" target="_blank" rel="noopener">CSDN</a>、<a href="https://stackoverflow.com/" target="_blank" rel="noopener">stack<strong>overflow</strong></a>、<a href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/Python%20for%20Data%20Analysis%2C%202nd%20Edition.pdf" target="_blank" rel="noopener"><strong>Python for Data Analysis, 2nd Edition</strong> </a>、<a href="http://python3-cookbook.readthedocs.io/zh_CN/latest/" target="_blank" rel="noopener">Python Cookbook</a></li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p><strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><ul>
<li>完成并提交项目二。</li>
</ul>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>数据类型 - 脚本编写</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody>
</table>
<h1 id="项目准备"><a href="#项目准备" class="headerlink" title="项目准备"></a>项目准备</h1><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>强烈建议大家完成本地环境的搭建，在本地完成此项目。搭建本地环境的方法请参考<a href="https://classroom.udacity.com/nanodegrees/nd002-cn-basic-vip/parts/e566ad37-6119-4448-a6bc-7ade73ef3992" target="_blank" rel="noopener">Anaconda的安装与配置</a>一节，完成后你将获得本项目中会用到的关键软件：<strong>Spyder</strong>和<strong>Jupyter Notebook</strong>。</p>
<h2 id="文件准备"><a href="#文件准备" class="headerlink" title="文件准备"></a>文件准备</h2><p>在此项目中，你将比较以下三座城市的共享单车使用情况：芝加哥、纽约市和华盛顿特区。这些数据由 <a href="https://www.motivateco.com/" target="_blank" rel="noopener">Motivate</a> 提供。</p>
<p>数据和项目文件下载，请参考如下步骤：</p>
<p><img src="https://s1.ax1x.com/2018/08/06/PrrMp8.png" alt="PrrMp8.png"></p>
<p><strong>若下载失败，请微信联系我索取。</strong></p>
<blockquote>
<p><strong>注意</strong>：因为项目文件中使用的是python2，所以在本地环境进行编写时，请按照你的版本对个别代码进行修改，以契合你的版本。完成就可以直接提交，不必再转回python2的语法。</p>
</blockquote>
<h2 id="方法准备"><a href="#方法准备" class="headerlink" title="方法准备"></a>方法准备</h2><p>在本项目中，你需要完成多个函数的编写，可以按照如下方法提高工作效率：</p>
<ol>
<li><strong>确定</strong>第一个函数的<strong>功能需求</strong>，并构思代码；</li>
<li>利用<strong>Jupyter Notebook</strong>对你构思的<strong>代码进行测试</strong>；</li>
<li>若代码测试功能符合要求，则复制代码至<strong>Spyder</strong>，完成第一个函数的编写；</li>
<li>保存为.py格式的文件，在<strong>本地</strong>进行功能<strong>测试</strong>，看是否复合项目要求；</li>
<li>若满足要求，则按照步骤1-4对第二个函数进行编写，如此往复，完成整个项目。</li>
</ol>
<p>大家刚打开项目文件时，先不要被代码量吓到，沉下心来，一步步做，逐一击破，一定没问题哒！</p>
<h1 id="项目流程"><a href="#项目流程" class="headerlink" title="项目流程"></a>项目流程</h1><h2 id="项目概述"><a href="#项目概述" class="headerlink" title="项目概述"></a>项目概述</h2><p>在此项目中，你将利用 Python  探索与以下三大美国城市的自行车共享系统相关的数据：芝加哥、纽约和华盛顿特区。你将编写代码<strong>导入数据</strong>，并通过<strong>计算描述性统计数据回答有趣的问题</strong>。你还将<strong>写一个脚本</strong>，该脚本会接受原始输入并<strong>在终端中创建交互式体验</strong>，以展现这些统计信息。 </p>
<blockquote>
<p>读完项目概述，大概也能了解到项目的要求有哪些了，也就是需要你去完成的任务：</p>
<ul>
<li>需要你编写一个脚本</li>
<li>在脚本中，能够读取数据文件</li>
<li>能够根据用户输入，完成相关统计计算，并进行回答展示结果</li>
</ul>
</blockquote>
<h2 id="数据集说明"><a href="#数据集说明" class="headerlink" title="数据集说明"></a>数据集说明</h2><p>我们提供了三座城市 2017 年上半年的数据。三个数据文件都包含相同的核心列：</p>
<ul>
<li>起始时间 Start Time（例如 2017-01-01 00:07:57）</li>
<li>结束时间 End Time（例如 2017-01-01 00:20:53）</li>
<li>骑行时长 Trip Duration（例如 776 秒）</li>
<li>起始车站 Start Station（例如百老汇街和巴里大道）</li>
<li>结束车站 End Station（例如塞奇威克街和北大道）</li>
<li>用户类型 User Type（订阅者 Subscriber/Registered 或客户Customer/Casual）</li>
</ul>
<p>芝加哥和纽约市文件还包含以下两列：</p>
<ul>
<li>性别 Gender</li>
<li>出生年份 Birth Year</li>
</ul>
<blockquote>
<p>上述数据集说明中，我们能知道三个数据集中包含有哪些列，列名是什么，这在之后进行函数编写的时候，是一个非常重要的参考。</p>
</blockquote>
<h2 id="项目要求"><a href="#项目要求" class="headerlink" title="项目要求"></a>项目要求</h2><ul>
<li>请一定要规范注释：<ul>
<li>关键代码注释，进行解释；</li>
<li>函数功能解释文档</li>
</ul>
</li>
<li>请保存你初次完成项目的文件作为project_0，之后先备份再修改，这样直到项目审阅成功，你能很明显的对比出自己最开始出现的问题及思考问题的短板。</li>
</ul>
<h2 id="get-filters-函数"><a href="#get-filters-函数" class="headerlink" title="get_filters()函数"></a>get_filters()函数</h2><h3 id="代码详解："><a href="#代码详解：" class="headerlink" title="代码详解："></a>代码详解：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_filters</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    函数需要询问用户三个问题来获取筛选数据的三个条件：城市、月份和周几。</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">	函数返回的是一个元组，三个元素的数据类型都为str。    </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    print(<span class="string">'Hello! Let\'s explore some US bikeshare data!'</span>)</span><br><span class="line">    <span class="comment"># TO DO: get user input for city (chicago, new york city, washington). HINT: Use a while loop to handle invalid inputs</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># TO DO: get user input for month (all, january, february, ... , june)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># TO DO: get user input for day of week (all, monday, tuesday, ... sunday)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    print(<span class="string">'-'</span>*<span class="number">40</span>)</span><br><span class="line">    <span class="keyword">return</span> city, month, day</span><br></pre></td></tr></table></figure>
<h3 id="关键代码提示："><a href="#关键代码提示：" class="headerlink" title="关键代码提示："></a>关键代码提示：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取键盘输入</span></span><br><span class="line">input()</span><br><span class="line"><span class="comment">#循环</span></span><br><span class="line"><span class="keyword">while</span> ... :</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<h3 id="输出示例："><a href="#输出示例：" class="headerlink" title="输出示例："></a>输出示例：</h3><p><img src="https://s1.ax1x.com/2018/08/06/PrrX38.png" alt="PrrX38.png"></p>
<h2 id="load-data-函数"><a href="#load-data-函数" class="headerlink" title="load_data()函数"></a>load_data()函数</h2><h3 id="代码详解：-1"><a href="#代码详解：-1" class="headerlink" title="代码详解："></a>代码详解：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_data</span><span class="params">(city, month, day)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">   该函数是对get_filters函数的一个承接，get_filters函数获取筛选条件，本函数就针对筛选条件进行数据读取。</span></span><br><span class="line"><span class="string">   所以本函数需要三个关键数据作为参数输入，即：城市、月份和周几。</span></span><br><span class="line"><span class="string">   函数的输出为筛选后的数据。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        (str) city - name of the city to analyze</span></span><br><span class="line"><span class="string">        (str) month - name of the month to filter by, or "all" to apply no month filter</span></span><br><span class="line"><span class="string">        (str) day - name of the day of week to filter by, or "all" to apply no day filter</span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        df - Pandas DataFrame containing city data filtered by month and day</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> df</span><br></pre></td></tr></table></figure>
<h3 id="关键代码提示：-1"><a href="#关键代码提示：-1" class="headerlink" title="关键代码提示："></a>关键代码提示：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#pandas读取文档</span></span><br><span class="line">pd.read_csv</span><br><span class="line"><span class="comment">#datetime格式转换</span></span><br><span class="line">pd.to_datetime</span><br><span class="line"><span class="comment">#获取datetime的月份？周几？</span></span><br><span class="line">datetime.dt.month</span><br><span class="line">datetime.dt.weekday</span><br><span class="line"><span class="comment">#判断语句</span></span><br><span class="line"><span class="keyword">if</span> ... :</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<h2 id="time-stats-函数"><a href="#time-stats-函数" class="headerlink" title="time_stats()函数"></a>time_stats()函数</h2><h3 id="代码详解：-2"><a href="#代码详解：-2" class="headerlink" title="代码详解："></a>代码详解：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">time_stats</span><span class="params">(df)</span>:</span></span><br><span class="line">    <span class="string">"""时间计算函数</span></span><br><span class="line"><span class="string">    针对筛选出的数据(df)，对出现频次最高的月份、周几和小时进行统计，并输出结果</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    print(<span class="string">'\nCalculating The Most Frequent Times of Travel...\n'</span>)</span><br><span class="line">    start_time = time.time()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># TO DO: display the most common month</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># TO DO: display the most common day of week</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># TO DO: display the most common start hour</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    print(<span class="string">"\nThis took %s seconds."</span> % (time.time() - start_time))</span><br><span class="line">    print(<span class="string">'-'</span>*<span class="number">40</span>)</span><br></pre></td></tr></table></figure>
<h3 id="关键代码提示：-2"><a href="#关键代码提示：-2" class="headerlink" title="关键代码提示："></a>关键代码提示：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取众数</span></span><br><span class="line">pd.Series.mode()</span><br><span class="line"><span class="comment">#输出格式化</span></span><br><span class="line">.format()</span><br></pre></td></tr></table></figure>
<h3 id="输出示例：-1"><a href="#输出示例：-1" class="headerlink" title="输出示例："></a>输出示例：</h3><p><img src="https://s1.ax1x.com/2018/08/06/PrsA3T.png" alt="PrsA3T.png"></p>
<h2 id="station-stats-函数"><a href="#station-stats-函数" class="headerlink" title="station_stats()函数"></a>station_stats()函数</h2><h3 id="代码详解"><a href="#代码详解" class="headerlink" title="代码详解"></a>代码详解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">station_stats</span><span class="params">(df)</span>:</span></span><br><span class="line">    <span class="string">"""站点计算函数</span></span><br><span class="line"><span class="string">    针对筛选出的数据(df)，对出现频次最高的起始站、终点站和起点-终点线进行统计，并输出结果"""</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">'\nCalculating The Most Popular Stations and Trip...\n'</span>)</span><br><span class="line">    start_time = time.time()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># TO DO: display most commonly used start station</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># TO DO: display most commonly used end station</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># TO DO: display most frequent combination of start station and end station trip</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    print(<span class="string">"\nThis took %s seconds."</span> % (time.time() - start_time))</span><br><span class="line">    print(<span class="string">'-'</span>*<span class="number">40</span>)</span><br></pre></td></tr></table></figure>
<h3 id="关键代码提示：-3"><a href="#关键代码提示：-3" class="headerlink" title="关键代码提示："></a>关键代码提示：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#字符串的链接</span></span><br><span class="line">list_0 = list_1 + list_2</span><br></pre></td></tr></table></figure>
<h3 id="输出示例：-2"><a href="#输出示例：-2" class="headerlink" title="输出示例："></a>输出示例：</h3><p>与time_stats()函数类似</p>
<h2 id="trip-duration-stats-函数"><a href="#trip-duration-stats-函数" class="headerlink" title="trip_duration_stats()函数"></a>trip_duration_stats()函数</h2><h3 id="代码详解-1"><a href="#代码详解-1" class="headerlink" title="代码详解"></a>代码详解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trip_duration_stats</span><span class="params">(df)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    通勤时间计算函数</span></span><br><span class="line"><span class="string">    针对筛选出的数据(df)，对通勤总时间和平均时间进行计算，并输出结果</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">'\nCalculating Trip Duration...\n'</span>)</span><br><span class="line">    start_time = time.time()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># TO DO: display total travel time</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># TO DO: display mean travel time</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    print(<span class="string">"\nThis took %s seconds."</span> % (time.time() - start_time))</span><br><span class="line">    print(<span class="string">'-'</span>*<span class="number">40</span>)</span><br></pre></td></tr></table></figure>
<h3 id="关键代码提示"><a href="#关键代码提示" class="headerlink" title="关键代码提示"></a>关键代码提示</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#求和</span></span><br><span class="line">.sum()</span><br><span class="line"><span class="comment">#求均值</span></span><br><span class="line">.mean()</span><br></pre></td></tr></table></figure>
<h3 id="输出示例：-3"><a href="#输出示例：-3" class="headerlink" title="输出示例："></a>输出示例：</h3><p><img src="https://s1.ax1x.com/2018/08/06/PrsmDJ.png" alt="PrsmDJ.png">、</p>
<h2 id="user-stats-函数"><a href="#user-stats-函数" class="headerlink" title="user_stats()函数"></a>user_stats()函数</h2><h3 id="代码详解-2"><a href="#代码详解-2" class="headerlink" title="代码详解"></a>代码详解</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">user_stats</span><span class="params">(df)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    用户计算函数</span></span><br><span class="line"><span class="string">    针对筛选出的数据(df)，对不同类型的用户数量、不同性别的用户数量以及最老、最新和最多的出生年份进行统计、计算，并输出结果</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">'\nCalculating User Stats...\n'</span>)</span><br><span class="line">    start_time = time.time()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># TO DO: Display counts of user types</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># TO DO: Display counts of gender</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># TO DO: Display earliest, most recent, and most common year of birth</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    print(<span class="string">"\nThis took %s seconds."</span> % (time.time() - start_time))</span><br><span class="line">    print(<span class="string">'-'</span>*<span class="number">40</span>)</span><br></pre></td></tr></table></figure>
<h3 id="关键代码提示-1"><a href="#关键代码提示-1" class="headerlink" title="关键代码提示"></a>关键代码提示</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#pandas 分类同积函数</span></span><br><span class="line">pd.Series.value_counts()</span><br><span class="line"><span class="comment">#最小最大值</span></span><br><span class="line">.min()   .max()</span><br></pre></td></tr></table></figure>
<h3 id="输出示例：-4"><a href="#输出示例：-4" class="headerlink" title="输出示例："></a>输出示例：</h3><p><img src="https://s1.ax1x.com/2018/08/06/Prs38K.png" alt="Prs38K.png"></p>
<h2 id="main-函数"><a href="#main-函数" class="headerlink" title="main()函数"></a>main()函数</h2><p>main()函数是项目中最重要的函数，是程序的入口。</p>
<p>如果你接手一个项目，想快速了解项目中的代码都实现了哪些功能的话，那就要去查看main()函数，这也就是为什么叫<code>main</code>的原因了。</p>
<p>但是在本项目中，该函数并不需要大家去编写或者修改，完成以上所有函数后，就可以尝试在本地进行测试，然后提交啦~</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">def main():</span><br><span class="line">    while True:</span><br><span class="line">        city, month, day = get_filters()</span><br><span class="line">        df = load_data(city, month, day)</span><br><span class="line"></span><br><span class="line">        time_stats(df)</span><br><span class="line">        station_stats(df)</span><br><span class="line">        trip_duration_stats(df)</span><br><span class="line">        user_stats(df)</span><br><span class="line"></span><br><span class="line">        restart = input(&apos;\nWould you like to restart? Enter yes or no.\n&apos;)</span><br><span class="line">        if restart.lower() != &apos;yes&apos;:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<h2 id="项目提交"><a href="#项目提交" class="headerlink" title="项目提交"></a>项目提交</h2><p>项目提交前，请查看：<a href="https://review.udacity.com/#!/rubrics/1713/view" target="_blank" rel="noopener">项目审阅标准</a>，提高你的一次通过率！</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>至此，我们已经完成了本项目，回想一下，在这个项目中：</p>
<ul>
<li>你都用到了哪些python基础函数？</li>
<li>你都用到了哪些pandas中的函数？</li>
<li>在你定义的不同函数中，都解决了哪些问题？</li>
<li>项目通过之后，再想想你编写的函数是完美的吗？或者说，你有哪些想要进一步完善的？<ul>
<li>怎样提高用户的体验？比如：get_filters()函数中，用户输入了NewYork，也可以实现正确识别等等</li>
<li>怎样保持程序不会报错？比如：华盛顿用户的性别和出生年月。</li>
</ul>
</li>
<li>除了项目中的研究内容，你还想继续探究数据中的哪些因素？</li>
</ul>
<h2 id="加油！！！等你们的好消息！！！"><a href="#加油！！！等你们的好消息！！！" class="headerlink" title="加油！！！等你们的好消息！！！"></a>加油！！！等你们的好消息！！！</h2>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/23/2018-7-23-第二周导学/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/07/23/2018-7-23-第二周导学/" class="post-title-link" itemprop="url">每周导学-第二周-python基础</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-07-23 13:30:09" itemprop="dateCreated datePublished" datetime="2018-07-23T13:30:09+08:00">2018-07-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-03 12:51:55" itemprop="dateModified" datetime="2019-04-03T12:51:55+08:00">2019-04-03</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2018/07/23/2018-7-23-第二周导学/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/07/23/2018-7-23-第二周导学/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Things may come to those who wait, but only the things left by those who hustle.</p>
</blockquote>
<p>Hi，同学们，经过第一周的学习，我们已经完成了项目一，是不是成就感爆棚！自信心爆棚呀！那请继续保持着这样的自信心和学习动力，继续我们的课程吧！</p>
<p>本周开始，我们就进入到了<strong>项目二(P2)阶段</strong>，本阶段总共包含<strong>四周</strong>，在这一个月内，我们要对<strong>Python入门</strong>进行学习，并使用这门新技术完成<strong>项目二：探索美国共享单车数据</strong>，以下便是这四周的学习安排：</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>学习重点</th>
<th>对应课程</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>第1周</strong></td>
<td><strong>Python基础内容</strong></td>
<td><strong>数据类型和运算符、控制流、函数、脚本编写</strong></td>
</tr>
<tr>
<td>第2周</td>
<td>Python数据处理内容</td>
<td>Numpy &amp; Pandas - 第一、二部分</td>
</tr>
<tr>
<td>第3周</td>
<td>完成项目</td>
<td>项目：探索美国共享单车数据</td>
</tr>
<tr>
<td>第4周</td>
<td>项目修改与通过</td>
<td>修改项目、查缺补漏、休息调整</td>
</tr>
</tbody>
</table>
<p>对于非小白同学来说，本阶段内容不是很难，希望你们能在三周内完成并通过项目；  </p>
<p>对于小白来说，本阶段可能是个挑战，请一定要<strong>保持自信</strong>，请一定要坚持<strong>学习和总结</strong>，如果遇到任何<strong>课程问题</strong>请参照如下顺序进行解决：</p>
<ul>
<li>先自行查找问题答案（注意提取关键词），参考：谷歌/百度搜索、<a href="http://www.runoob.com/python3/python3-tutorial.html" target="_blank" rel="noopener">菜鸟教程</a>、<a href="https://www.csdn.net/" target="_blank" rel="noopener">CSDN</a>、<a href="https://stackoverflow.com/" target="_blank" rel="noopener">stack<strong>overflow</strong></a>、<a href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/Python%20for%20Data%20Analysis%2C%202nd%20Edition.pdf" target="_blank" rel="noopener"><strong>Python for Data Analysis, 2nd Edition</strong> </a>、<a href="http://python3-cookbook.readthedocs.io/zh_CN/latest/" target="_blank" rel="noopener">Python Cookbook</a></li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
<p>饭要一口一口吃，路要一步一步走，大家不要被任务吓到，跟着导学一步一步来，肯定没问题哒！那我们开始吧！</p>
<blockquote>
<p> <strong>注：</strong>本着<strong>按需知情</strong>原则，所涉及的知识点都是在数据分析过程中必须的、常用的，而不是最全面的，想要更丰富，那就需要你们课下再进一步的学习和探索！</p>
</blockquote>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><ul>
<li>（必选）课程中的<strong>编程入门 - Turtle</strong>为体验课~对没有编程经验的小白同学十分友好，必看！</li>
<li>（必选）学习课程中<strong>数据类型和运算符</strong>至<strong>脚本编写</strong>部分，掌握Python语言的基础。</li>
<li>（可选）配置本地编译环境。</li>
</ul>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th>时间</th>
<th>学习资源</th>
<th>学习内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>周二</td>
<td>微信群 - 每周导学</td>
<td>预览每周导学</td>
</tr>
<tr>
<td>周三、周四</td>
<td>Udacity - Classroom</td>
<td>数据类型 - 脚本编写</td>
</tr>
<tr>
<td>周五</td>
<td>微信/Classin - 1V1</td>
<td>课程难点</td>
</tr>
<tr>
<td>周六</td>
<td>Classin - 优达日</td>
<td>本周学习总结、答疑</td>
</tr>
<tr>
<td>周日</td>
<td>笔记本</td>
<td>总结沉淀</td>
</tr>
<tr>
<td>周一</td>
<td>自主学习</td>
<td>查漏补缺</td>
</tr>
</tbody>
</table>
<h1 id="本周知识清单"><a href="#本周知识清单" class="headerlink" title="本周知识清单"></a>本周知识清单</h1><h2 id="编程入门-Turtle"><a href="#编程入门-Turtle" class="headerlink" title="编程入门 - Turtle"></a>编程入门 - Turtle</h2><p>本节中，选择了python中一个画图的工具——Turtle为例，带大家在轻松有趣的画图中，了解python的变量、循环等知识，对没有编程基础的小白同学十分友好~相信你们通过这节课，肯定会爱上python的，哈哈~</p>
<h2 id="0-（可选）环境搭建"><a href="#0-（可选）环境搭建" class="headerlink" title="0 （可选）环境搭建"></a>0 （可选）环境搭建</h2><blockquote>
<p>标题后面小括号中的数字即为对应课程的第几课节，如：算术运算符(2,3)即表示对应课程中为第2、3课节。</p>
</blockquote>
<p>虽然是可选，但强烈推荐大家在本地搭建Python编程环境，你所需的只是有限的几步操作，却能在之后的学习和项目中给你带来无限的便捷！</p>
<ul>
<li><strong>强烈推荐！</strong>按照课程中，第7章节<a href="https://classroom.udacity.com/nanodegrees/nd002-cn-basic-vip/parts/e566ad37-6119-4448-a6bc-7ade73ef3992" target="_blank" rel="noopener"><strong>Anaconda和Jupyter Notebook</strong></a>的详细步骤，完成本地环境的搭建。完成后你将获得：Python的本地IDE<strong>Spyder</strong>以及数据分析师最爱的交互式笔记本<strong>Jupyter Notebook</strong>。</li>
<li><a href="https://blog.csdn.net/LucyGill/article/details/78068985" target="_blank" rel="noopener">Spyder的简明教程</a>，光看不顶用，一定要多实操。</li>
<li>另外，还简单推荐一款Python的编辑器Atom，可以在<a href="https://atom.io/" target="_blank" rel="noopener">官网</a>进行下载，然后可以参考博客<a href="https://blog.csdn.net/qq_36390239/article/details/79862743" target="_blank" rel="noopener">Atom的python插件和常用插件</a>安装一些针对python的拓展包。<strong>没有python相关拓展包的Atom做起python来就像是 用记事本再写代码？</strong>所以一定要装拓展包哦！</li>
<li>Atom的教程，<a href="https://classroom.udacity.com/nanodegrees/nd002-cn-basic-vip/parts/0ad43cea-8e74-4486-911c-d1fae2f03c97/modules/2ceb59e6-2fa6-4177-a8b8-b6130f45ac3f/lessons/09be9405-95aa-4a89-b800-9b60ccde5476/concepts/f411e93c-03f8-4d45-b60f-d4c2832b63d6#" target="_blank" rel="noopener">课程5</a>里面也有涉及到；除此之外，还可参考<a href="https://www.cnblogs.com/2xkt/p/7566848.html" target="_blank" rel="noopener">Atom基本操作</a>，完成拓展包的下载与安装。</li>
</ul>
<p>安装好之后尝试你的第一个python代码吧！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'Hello world!'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="1-Python基础语法"><a href="#1-Python基础语法" class="headerlink" title="1 Python基础语法"></a>1 Python基础语法</h2><p>想要学好一门语言，语法作为语言中<code>法律</code>一样的存在，是非常重要的，所以请大家一定要恪守这个法律，在初学阶段打好基础，不要养成不良的编码习惯。</p>
<ul>
<li><p>行与缩进</p>
<p>python最具特色的就是使用<strong>缩进</strong>来表示代码块， 同一个代码块的语句必须包含相同的缩进空格数，缩进的空格数是可变的，但是有个不成文的规定就是使用<strong>4个空格</strong>的缩进。</p>
<p>比如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"True"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"False"</span>)</span><br></pre></td></tr></table></figure>
<p>但如果像如下这样就会因为缩进问题报错：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"Answer"</span>)</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"True"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"Answer"</span>)</span><br><span class="line">  <span class="keyword">print</span> (<span class="string">"False"</span>)    <span class="comment"># 缩进不一致，会导致运行错误</span></span><br></pre></td></tr></table></figure>
<p>报错会提示如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IndentationError: unindent does <span class="keyword">not</span> match any outer indentation level</span><br></pre></td></tr></table></figure>
<p>所以，如果你的程序运行后，出现这种错误提示，那你就要检查下，你的代码缩进是不是有问题了。</p>
</li>
<li><p>注释</p>
<p>Python中单行注释以 <strong>#</strong> 开头，多行注释可以用多个 # 号，或者  ‘’’和 “””(主要作声明函数用)，示例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注释1</span></span><br><span class="line"><span class="comment"># 注释2</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    this is a print function.</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">print</span> (<span class="string">'Hello,Python!'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>更多更详细的python编写规范请参考<a href="https://www.python.org/dev/peps/pep-0008/" target="_blank" rel="noopener">PEP8规定</a>。（或者查看<a href="https://blog.csdn.net/ratsniper/article/details/78954852" target="_blank" rel="noopener">中文版</a>）</p>
</li>
</ul>
<h2 id="2-数据类型和运算符"><a href="#2-数据类型和运算符" class="headerlink" title="2 数据类型和运算符"></a>2 数据类型和运算符</h2><h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><ul>
<li><p>数字(Number)：支持整型(int)、浮点型(float)、布尔型(bool) <strong>(7,8)</strong></p>
<blockquote>
<p>在混合计算中，python会把整型转化成浮点型</p>
</blockquote>
</li>
<li><p>字符串(String)：用单引号 ‘ 或双引号 “ 括起来 <strong>(11,12)</strong></p>
<blockquote>
<p>用+连接，用*重复；字符串截取的格式为：变量[头下标:尾下标]</p>
</blockquote>
</li>
<li><p>列表(List)：写在方括号 [] 之间，用逗号分隔开的元素列表。 元素可以是数字、字符串或者列表<strong>(17-20)</strong></p>
<blockquote>
<p>用+连接；截取的格式同字符串</p>
</blockquote>
</li>
<li><p>元组(Tuple)：与列表类似，但是不可更改，写在小括号 () 里，元素之间用逗号隔开。<strong>(21,22)</strong></p>
<blockquote>
<p>用+连接；截取的格式同字符串</p>
</blockquote>
</li>
<li><p>集合(Set)：无序不重复元素的序列。 <strong>(23,24)</strong></p>
<blockquote>
<p>筛选出列表a中的不重复元素，可以直接使用set(a)</p>
</blockquote>
</li>
<li><p>字典(Dictionary) ：写在大括号{ }里，是一个无序的<strong>键(key) : 值(value)</strong>对儿集合<strong>(25-27)</strong></p>
<blockquote>
<p>key必须为不可变类型，且唯一</p>
</blockquote>
</li>
</ul>
<blockquote>
<p><strong>不可变数据（3 个）：</strong>Number（数字）、String（字符串）、Tuple（元组）；</p>
<p><strong>可变数据（3 个）：</strong>List（列表）、Dictionary（字典）、Set（集合）。 </p>
</blockquote>
<h4 id="相互转换"><a href="#相互转换" class="headerlink" title="相互转换"></a>相互转换</h4><table>
<thead>
<tr>
<th style="text-align:center">函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">int(x)</td>
<td>将x转换为一个整数</td>
</tr>
<tr>
<td style="text-align:center">float(x)</td>
<td>将x转换到一个浮点数</td>
</tr>
<tr>
<td style="text-align:center">str(x)</td>
<td>将对象 x 转换为字符串</td>
</tr>
<tr>
<td style="text-align:center">list(s)</td>
<td>将序列 s 转换为一个列表</td>
</tr>
<tr>
<td style="text-align:center">set(s)</td>
<td>转换为集合（元素唯一）</td>
</tr>
</tbody>
</table>
<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><h4 id="算术运算符-2-3"><a href="#算术运算符-2-3" class="headerlink" title="算术运算符(2,3)"></a>算术运算符(2,3)</h4><p>假设 a = 12, b = 26</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td>加，数字就是做加法/字符串就是拼接</td>
<td>a + b 输出结果 28</td>
</tr>
<tr>
<td>-</td>
<td>减，做减法</td>
<td>a - b 输出结果 -28</td>
</tr>
<tr>
<td>*</td>
<td>乘 ，数字的话就是相乘/字符串的话就是重复若干次</td>
<td>a * b 输出结果  312</td>
</tr>
<tr>
<td>/</td>
<td>除，做除法</td>
<td>b / a 输出结果  2.1666666666666665 （自动转化为浮点型）</td>
</tr>
<tr>
<td>%</td>
<td>取模 ， 即做除法后的余数</td>
<td>b % a 输出结果 2</td>
</tr>
<tr>
<td>**</td>
<td>幂</td>
<td>a**b 为12的26次方</td>
</tr>
<tr>
<td>//</td>
<td>取整，即做除法后的商</td>
<td>9//2 输出结果 4 , 9.0//2.0 输出结果 4.0</td>
</tr>
</tbody>
</table>
<h4 id="赋值运算符-4-5-6"><a href="#赋值运算符-4-5-6" class="headerlink" title="赋值运算符(4,5,6)"></a>赋值运算符(4,5,6)</h4><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>=</td>
<td>简单的赋值运算符</td>
<td>c = a + b 将 a + b 的运算结果赋值为 c</td>
</tr>
<tr>
<td>+=</td>
<td>加法赋值运算符</td>
<td>c += a 即 c = c + a（常用 i += 1，表示递增）</td>
</tr>
<tr>
<td>-=</td>
<td>减法赋值运算符</td>
<td>c -= a 即 c = c - a</td>
</tr>
</tbody>
</table>
<h4 id="比较运算符-9-10"><a href="#比较运算符-9-10" class="headerlink" title="比较运算符(9,10)"></a>比较运算符(9,10)</h4><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>==</td>
<td>等于；比较对象是否相等</td>
</tr>
<tr>
<td>!=</td>
<td>不等于； 比较两个对象是否不相等</td>
</tr>
<tr>
<td>&gt;</td>
<td>大于 ； 返回x是否大于y</td>
</tr>
<tr>
<td>&lt;</td>
<td>小于 ；返回x是否小于y。所有比较运算符返回1表示真，返回0表示假。这分别与特殊的变量True和False等价。注意，这些变量名的大写。</td>
</tr>
<tr>
<td>&gt;=</td>
<td>大于等于；返回x是否大于等于y。</td>
</tr>
<tr>
<td>&lt;=</td>
<td>小于等于；返回x是否小于等于y。</td>
</tr>
</tbody>
</table>
<h4 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h4><table>
<thead>
<tr>
<th>运算符</th>
<th>逻辑表达式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>and</td>
<td>x and y</td>
<td>即逻辑 “与”</td>
</tr>
<tr>
<td>or</td>
<td>x or y</td>
<td>即逻辑 “或”</td>
</tr>
<tr>
<td>not</td>
<td>not x</td>
<td>即逻辑 “非”</td>
</tr>
</tbody>
</table>
<h4 id="成员运算符"><a href="#成员运算符" class="headerlink" title="成员运算符"></a>成员运算符</h4><p>   即查看指定的序列中是否存在某值，这个序列可以是字符串、列表或者元组。</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>in</td>
<td>找到值返回 True，否则返回 False。</td>
</tr>
<tr>
<td>not in</td>
<td>与in相反</td>
</tr>
</tbody>
</table>
<h4 id="恒等运算符"><a href="#恒等运算符" class="headerlink" title="恒等运算符"></a>恒等运算符</h4><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>is</td>
<td>检查两边是否恒等</td>
</tr>
<tr>
<td>is not</td>
<td>检查两边是否不恒等</td>
</tr>
</tbody>
</table>
<h4 id="布尔运算符"><a href="#布尔运算符" class="headerlink" title="布尔运算符"></a>布尔运算符</h4><p>python中的True和False有多种条件判断，更详细的请戳<a href="https://blog.csdn.net/fu_zk/article/details/41728773" target="_blank" rel="noopener">Python中的True, False条件判断</a>，请务必查看或者添加书签。</p>
<h2 id="3-控制流"><a href="#3-控制流" class="headerlink" title="3 控制流"></a>3 控制流</h2><h3 id="条件语句if"><a href="#条件语句if" class="headerlink" title="条件语句if"></a>条件语句if</h3><ul>
<li><p>代码模板：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> &lt;条件判断<span class="number">1</span>&gt;:</span><br><span class="line">    &lt;执行<span class="number">1</span>&gt;</span><br><span class="line"><span class="keyword">elif</span> &lt;条件判断<span class="number">2</span>&gt;:</span><br><span class="line">    &lt;执行<span class="number">2</span>&gt;</span><br><span class="line"><span class="keyword">elif</span> &lt;条件判断<span class="number">3</span>&gt;:</span><br><span class="line">    &lt;执行<span class="number">3</span>&gt;</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    &lt;执行<span class="number">4</span>&gt;</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：一定要注意缩进与对齐，尤其是有if语句嵌套的情况下。</p>
</li>
</ul>
<h3 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h3><ul>
<li><p>for循环</p>
<ul>
<li><p>for循环可以遍历任何序列的项目，如一个列表或者一个字符串，通俗点说，就是把这个序列中的第一个元素到最后一个元素依次访问并执行冒号后面的语句 </p>
</li>
<li><p>其一般格式为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> &lt;元素&gt; <span class="keyword">in</span> &lt;序列&gt;:</span><br><span class="line">    &lt;执行语句&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>while循环</p>
<ul>
<li><p>for循环和while循环，两者的相同点在于都能循环做一件重复的事情；不同点在于，for循环是在序列穷尽时停止，while循环是在条件不成立时停止。 当这个条件永远不为False时，就会出现死循环。</p>
</li>
<li><p>其一般格式为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> &lt;判断条件&gt;：</span><br><span class="line">    &lt;执行语句&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>break和continue</p>
<ul>
<li><p>break 语句可以跳出 for 和 while 的循环体。 </p>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> letter <span class="keyword">in</span> <span class="string">'Udacity'</span>:     <span class="comment"># for实例</span></span><br><span class="line">   <span class="keyword">if</span> letter == <span class="string">'t'</span>:</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">   <span class="keyword">print</span> (<span class="string">'当前字母为 :'</span>, letter)</span><br><span class="line">  </span><br><span class="line">i = <span class="number">10</span>                    <span class="comment"># while实例</span></span><br><span class="line"><span class="keyword">while</span> i &gt; <span class="number">0</span>:              </span><br><span class="line">   <span class="keyword">print</span> (<span class="string">'当期变量值为 :'</span>, i)</span><br><span class="line">   i -= <span class="number">1</span></span><br><span class="line">   <span class="keyword">if</span> i == <span class="number">5</span>:</span><br><span class="line">      <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>执行语句后的输出结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">当前字母为 : U</span><br><span class="line">当前字母为 : d</span><br><span class="line">当前字母为 : a</span><br><span class="line">当前字母为 : c</span><br><span class="line">当前字母为 : i</span><br><span class="line">当期变量值为 : 10</span><br><span class="line">当期变量值为 : 9</span><br><span class="line">当期变量值为 : 8</span><br><span class="line">当期变量值为 : 7</span><br><span class="line">当期变量值为 : 6</span><br></pre></td></tr></table></figure>
</li>
<li><p>continue是跳过当前循环块中的剩余语句， 也就是跳过continue后面的语句</p>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> letter <span class="keyword">in</span> <span class="string">'Udacity'</span>:     <span class="comment"># for实例</span></span><br><span class="line">   <span class="keyword">if</span> letter == <span class="string">'t'</span>:</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">   <span class="keyword">print</span> (<span class="string">'当前字母为 :'</span>, letter)</span><br><span class="line">  </span><br><span class="line">i = <span class="number">5</span>                    <span class="comment"># while实例</span></span><br><span class="line"><span class="keyword">while</span> i &gt; <span class="number">0</span>:              </span><br><span class="line">   i -= <span class="number">1</span></span><br><span class="line">   <span class="keyword">if</span> i == <span class="number">3</span>:</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">print</span> (<span class="string">'当期变量值为 :'</span>, i)</span><br></pre></td></tr></table></figure>
<p>执行代码后的输出结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">当前字母为 : U</span><br><span class="line">当前字母为 : d</span><br><span class="line">当前字母为 : a</span><br><span class="line">当前字母为 : c</span><br><span class="line">当前字母为 : i</span><br><span class="line">当前字母为 : y</span><br><span class="line">当期变量值为 : 4</span><br><span class="line">当期变量值为 : 2</span><br><span class="line">当期变量值为 : 1</span><br><span class="line">当期变量值为 : 0</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>综上呢，for更适合可迭代情况下使用，while更适合不知道要循环多少次的时候使用。</p>
<ul>
<li><p>zip函数</p>
<ul>
<li><p>zip函数的输入位可迭代的对象，输出为对应元素的元组</p>
</li>
<li><p>其一般格式为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip([a],[b])</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用zip函数可以节约不少内存</p>
</li>
<li><p>可以使用list()来转换输出zip函数的结果</p>
</li>
<li><p>若zip的两个输入序列长度不一致，则以短的那个为参考</p>
</li>
<li><p>*zip可以理解为zip的反函数，可以将元组解压为列表</p>
</li>
<li><p><a href="https://blog.csdn.net/shomy_liu/article/details/46968651" target="_blank" rel="noopener">查看更多</a></p>
</li>
</ul>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line">b = [<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">c = [<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>]</span><br><span class="line">zip_1 = zip(a,b)</span><br><span class="line">zip_2 = zip(a,c)</span><br><span class="line">a1,c1 = zip(*zip_1)</span><br></pre></td></tr></table></figure>
<p>执行代码，输出结果为：</p>
<p><img src="https://s1.ax1x.com/2018/11/13/iO2lJH.png" alt="iO2lJH.png"></p>
</li>
<li><p>enumerate函数</p>
<ul>
<li><p>该函数是将一个可遍历的数据对象(如列表、元组或字符串)组合为一个带索引和元素的元组</p>
</li>
<li><p>其一般格式为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">enumerate(&lt;序列&gt;, start=<span class="number">0</span>)</span><br><span class="line"><span class="comment">#start表示下标的起始位置</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>常与for…in…联用</p>
</li>
</ul>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">print(<span class="string">'起始下标为默认：'</span>)</span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> enumerate(a):</span><br><span class="line">    print(i,j)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'起始下标为1:'</span>)</span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> enumerate(a,start = <span class="number">1</span>):</span><br><span class="line">    print(i,j)</span><br></pre></td></tr></table></figure>
<p>执行代码，输出结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">起始下标为默认：</span><br><span class="line">0 1</span><br><span class="line">1 2</span><br><span class="line">起始下标为1:</span><br><span class="line">1 1</span><br><span class="line">2 2</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="列表推导式"><a href="#列表推导式" class="headerlink" title="列表推导式"></a>列表推导式</h3><ul>
<li><p>可以简单理解为：定义一个空表，然后用表中的循环语句填充该表。</p>
</li>
<li><p>其一般格式为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[表达式 for 变量 in 序列或迭代对象]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="4-函数"><a href="#4-函数" class="headerlink" title="4 函数"></a>4 函数</h2><h3 id="定义函数"><a href="#定义函数" class="headerlink" title="定义函数"></a>定义函数</h3><ul>
<li><p>其一般格式为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> 函数名<span class="params">(参数)</span>:</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">函数说明</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">	函数语句</span><br></pre></td></tr></table></figure>
<ul>
<li>函数说明是建议非必需</li>
<li>函数语句最后以return(表达式)结尾，则返回值；若不带表达式，则返回None</li>
</ul>
</li>
</ul>
<h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3><p>默认参数和关键字参数不在赘述，在此只讲述一种<strong>不定长参数</strong>。</p>
<ul>
<li>若在参数前面加一个星号<code>*</code>，则将所有未命名的参数以元组的形式导入；</li>
<li>若在参数前面加两个星号<code>**</code>，则参数会以字典的形式导入。</li>
</ul>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#定义函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tupleprint</span><span class="params">(a, *tupleb )</span>:</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">打印任何传入的参数</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">   <span class="keyword">print</span> (<span class="string">"输出: "</span>)</span><br><span class="line">   <span class="keyword">print</span> (a)</span><br><span class="line">   <span class="keyword">print</span> (tupleb)</span><br><span class="line">   </span><br><span class="line"><span class="comment">#调用函数</span></span><br><span class="line">tupleprint(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>执行代码，输出结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输出: </span><br><span class="line">1</span><br><span class="line">(2, 3)</span><br></pre></td></tr></table></figure>
<h3 id="变量作用域"><a href="#变量作用域" class="headerlink" title="变量作用域"></a>变量作用域</h3><p>变量的作用域就是能访问该变量的程序部分。</p>
<ul>
<li><p>在python中，只有模块（module），类（class）以及函数（def、lambda）才会引入新的作用域 ，而其他如if/for/while等是不会引入新的作用域的。</p>
</li>
<li><p>全局变量即可以在整个程序范围内都可以访问；局部变量只能在其被定义的函数内调用。</p>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">global_a = <span class="number">0</span> <span class="comment"># 这是一个全局变量</span></span><br><span class="line"><span class="comment"># 定义函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span><span class="params">( a, b )</span>:</span></span><br><span class="line">    global_a = a + b <span class="comment"># global_a在这里是局部变量.</span></span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"局部变量为: "</span>, global_a)</span><br><span class="line">    <span class="keyword">return</span> global_a</span><br><span class="line"> </span><br><span class="line"><span class="comment">#调用函数</span></span><br><span class="line">sum(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"全局变量为: "</span>, global_a)</span><br></pre></td></tr></table></figure>
<p>执行代码，输出结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">局部变量为:  3</span><br><span class="line">全局变量为:  0</span><br></pre></td></tr></table></figure>
</li>
<li><p>na当局部代码想要修改全局变量时，就会用到global和nonlocal关键字了 。</p>
<p>示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">num = <span class="number">1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun1</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> num  <span class="comment"># 需要使用 global 关键字声明</span></span><br><span class="line">    print(num) </span><br><span class="line">    num = <span class="number">123</span></span><br><span class="line">    print(num)</span><br><span class="line">fun1()</span><br><span class="line">print(num)</span><br></pre></td></tr></table></figure>
<p>执行代码，输出结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">123</span><br><span class="line">123</span><br></pre></td></tr></table></figure>
<p>nonlocal的用法类似，用在嵌套函数中，当只想修改嵌套作用域的变量而非全局变量时使用。</p>
</li>
</ul>
<h3 id="可更改对象与不可更改对象"><a href="#可更改对象与不可更改对象" class="headerlink" title="可更改对象与不可更改对象"></a>可更改对象与不可更改对象</h3><p>在数据类型中也提到过，python中的可变类型（列表、字典和集合）与不可变类型（数字，字符串和元组），那在函数中作为变量进行传递时会是怎样呢？</p>
<p>示例1：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#定义函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun1</span><span class="params">(a)</span>:</span></span><br><span class="line">	a = <span class="number">2</span></span><br><span class="line">	print(a)</span><br><span class="line">	</span><br><span class="line">b = <span class="number">1</span></span><br><span class="line">fun1(b)</span><br><span class="line">print(b)</span><br></pre></td></tr></table></figure>
<p>示例2：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun2</span><span class="params">(list_a)</span>:</span></span><br><span class="line">	list_a.append(<span class="number">2</span>)</span><br><span class="line">	print(list_a)</span><br><span class="line">	</span><br><span class="line">list_b = [<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line">fun2(list_b)</span><br><span class="line">print(list_b)</span><br></pre></td></tr></table></figure>
<p>尝试下，上面这两个示例的输出结果，有什么区别？</p>
<h3 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h3><ul>
<li><p>使用lambda创建</p>
</li>
<li><p>所谓匿名，就是不需要def语句</p>
</li>
<li><p>拥有自己的命名空间，而且只能访问自己命名空间中的变量</p>
</li>
<li><p>语法格式为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">lambda</span> &lt;变量&gt;:&lt;语句&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="迭代器与生成器"><a href="#迭代器与生成器" class="headerlink" title="迭代器与生成器"></a>迭代器与生成器</h3><p>了解即可，更多可以戳：<a href="http://python3-cookbook.readthedocs.io/zh_CN/latest/chapters/p04_iterators_and_generators.html" target="_blank" rel="noopener">参考</a></p>
<h2 id="5-脚本编写"><a href="#5-脚本编写" class="headerlink" title="5 脚本编写"></a>5 脚本编写</h2><h3 id="输入和输出"><a href="#输入和输出" class="headerlink" title="输入和输出"></a>输入和输出</h3><ul>
<li><p>输入：input函数</p>
<blockquote>
<p>示例：name = input(“请输入您的姓名：”)</p>
</blockquote>
</li>
<li><p>输出：print函数和表达式语句</p>
<ul>
<li>输出格式化：在第8课节中，出现了一个format函数，这个函数就是格式化的利器</li>
<li>其基本用法： <code>print(&#39;大家好，我是{}，今年{}岁。&#39;.format(&#39;Allen&#39;,25))</code></li>
<li>更多用法：<a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c08/p02_customizing_string_formatting.html?highlight=format" target="_blank" rel="noopener">字符串格式化</a>、<a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c03/p03_format_numbers_for_output.html?highlight=format" target="_blank" rel="noopener">数字格式化</a>、<a href="https://www.cnblogs.com/fat39/p/7159881.html" target="_blank" rel="noopener">%及format用法</a></li>
</ul>
</li>
</ul>
<h3 id="错误与异常"><a href="#错误与异常" class="headerlink" title="错误与异常"></a>错误与异常</h3><p>掌握try语句的用法就好。</p>
<ul>
<li><code>try</code>：这是 <code>try</code> 语句中的唯一必需子句。该块中的代码是 Python 在 <code>try</code> 语句中首先运行的代码。</li>
<li><code>except</code>：如果 Python 在运行 <code>try</code> 块时遇到异常，它将跳到处理该异常的 <code>except</code> 块。</li>
<li><code>else</code>：如果 Python 在运行 <code>try</code> 块时没有遇到异常，它将在运行 <code>try</code> 块后运行该块中的代码。</li>
<li><code>finally</code>：在 Python 离开此 <code>try</code> 语句之前，在任何情形下它都将运行此 <code>finally</code> 块中的代码，即使要结束程序，例如：如果 Python 在运行 <code>except</code> 或 <code>else</code> 块中的代码时遇到错误，在停止程序之前，依然会执行此<code>finally</code> 块。</li>
</ul>
<h3 id="读写文件"><a href="#读写文件" class="headerlink" title="读写文件"></a>读写文件</h3><ul>
<li><p>open()即打开文件，用法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open(文件名, 读写模式)</span><br></pre></td></tr></table></figure>
</li>
<li><p>常用的读写模式：</p>
<p>| 模式 | 描述                                                         |<br>| —- | ———————————————————— |<br>| r    | 只读。默认模式                                               |<br>| rb   | 二进制只读。                                                 |<br>| r+   | 读写。                                                       |<br>| rb+  | 二进制读写。                                                 |<br>| w    | 写入。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除，不想删除可参考模式<code>a</code>。如果该文件不存在，创建新文件。 |<br>| wb   | 二进制写入。其余同上                                         |<br>| w+   | 读写。其余同上                                               |<br>| wb+  | 二进制读写。其余同上                                         |<br>| a    | 追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。 |<br>| ab   | 二进制追加。其余同上                                         |<br>| a+   | 读写。其余同上                                               |<br>| ab+  | 二进制追加。其余同上                                         |</p>
</li>
</ul>
<h3 id="导入本地模块-函数"><a href="#导入本地模块-函数" class="headerlink" title="导入本地模块/函数"></a>导入本地模块/函数</h3><p>如果觉得课程中的解释有些晦涩，可以戳：<a href="https://blog.csdn.net/yjk13703623757/article/details/77918633/" target="_blank" rel="noopener">如何简单地理解Python中的if <strong>name</strong> == ‘<strong>main</strong>‘</a></p>
<h2 id="项目相关"><a href="#项目相关" class="headerlink" title="项目相关"></a>项目相关</h2><p>本周是P2的第一周，大家除了完成以上学习任务之外呢，还要为P2项目提前准备以下几个方面：</p>
<ul>
<li>完成本地环境的搭建</li>
<li>下载P2的项目文件，若教室下载失败的话，请戳我微信，分享百度云给你</li>
<li>完成项目的课节1-3，对即将挑战的项目有一个大概的了解，然后在学习中有的放矢</li>
</ul>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>如果项目一还没通过，请一定要抓紧时间！一定要在本周三之前顺利通关！大家一定要对自己有信心，然后，对自己狠一点！加油！</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/16/2018-7-16-第一周-项目一/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/07/16/2018-7-16-第一周-项目一/" class="post-title-link" itemprop="url">每周导学-第一周-项目一</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-07-16 22:30:09" itemprop="dateCreated datePublished" datetime="2018-07-16T22:30:09+08:00">2018-07-16</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-03 12:51:55" itemprop="dateModified" datetime="2019-04-03T12:51:55+08:00">2019-04-03</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DAND-VIP/" itemprop="url" rel="index"><span itemprop="name">DAND-VIP</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2018/07/16/2018-7-16-第一周-项目一/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/07/16/2018-7-16-第一周-项目一/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>If you change nothing, nothing will change.</p>
</blockquote>
<p>Hi，各位同学们，大家好，欢迎踏上数据分析的<del>不归路</del>列车~在发车之前，有几点需要给大家强调一下：</p>
<p><strong>课程和项目</strong>：</p>
<ul>
<li>课程以项目为导向，学习曲线十分平缓，我也是从一个小白一步步走过来的，所以请大家一定要对自己有<strong>信心</strong></li>
<li>从Teambition中，大家也能看到，我们把整体的一个大任务（入门毕业）拆分成了四个子任务（项目），在每个子任务中又拆分成了<strong>知识学习、项目提交和修改、总结沉淀</strong>三个部分，在这三个部分之中，大家还可以自行再进行切分，如此将一个大难题拆分成若干个小问题，逐个击破，十分轻松</li>
<li>对于项目，大家一定要重视！切不可抄袭，一定要<strong>对自己负责任</strong></li>
</ul>
<p><strong>如何提问</strong>：</p>
<p>在课程学习中难免会遇到问题，请按照以下流程进行问题提问：</p>
<ul>
<li><p><strong>课程知识问题</strong>：</p>
<ul>
<li>先自行查找问题答案，参考：谷歌/百度搜索、<a href="http://www.runoob.com/sql/sql-tutorial.html" target="_blank" rel="noopener">菜鸟教程</a>、<a href="https://www.csdn.net/" target="_blank" rel="noopener">CSDN</a>、<a href="https://stackoverflow.com/" target="_blank" rel="noopener">stack<strong>overflow</strong></a>、<a href="https://github.com/CapAllen/DAND_VIP_Class/blob/master/%E6%8B%93%E5%B1%95%E5%8F%82%E8%80%83/SQL.Cookbook(%E4%B8%AD%E6%96%87%E7%89%88" target="_blank" rel="noopener">SQLCookbook</a>.pdf)</li>
<li>若问题未解决，请将<strong>问题</strong>及其<strong>所在课程章节</strong>发送至微信群，并@助教即可</li>
</ul>
</li>
<li><p><strong>非课程知识问题</strong>：</p>
<p>比如账号登录、课程加载等问题，请详细描述问题，反馈给班主任即可</p>
</li>
</ul>
<p>该说的也说了个差不多，那么，请大家<del>系好安全带</del>做好<strong>觉悟</strong>：</p>
<ul>
<li>工作可能会很忙，但是每天至少要抽出一个小时来坚持学习，否则一日废，日日废</li>
<li>准备好一个笔记本或者有道云笔记、EverNote这种电子笔记本，用来记录学习笔记/问题</li>
<li>自律，自律，自律！自律才能让你更自由！</li>
</ul>
<p>准备发车！</p>
<h1 id="本周目标"><a href="#本周目标" class="headerlink" title="本周目标"></a>本周目标</h1><p>学习课程<strong>SQL初探</strong>，并完成（通过）项目一。</p>
<h1 id="学习计划"><a href="#学习计划" class="headerlink" title="学习计划"></a>学习计划</h1><table>
<thead>
<tr>
<th style="text-align:center">时间</th>
<th style="text-align:center">学习资源</th>
<th style="text-align:center">学习内容</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">周二</td>
<td style="text-align:center">微信群 - 每周导学</td>
<td style="text-align:center">预览每周导学</td>
</tr>
<tr>
<td style="text-align:center">周三、周四</td>
<td style="text-align:center">Udacity - Classroom</td>
<td style="text-align:center">SQL初探、项目一</td>
</tr>
<tr>
<td style="text-align:center">周五</td>
<td style="text-align:center">微信/Classin - 1V1</td>
<td style="text-align:center">课程难点</td>
</tr>
<tr>
<td style="text-align:center">周六</td>
<td style="text-align:center">Classin - 优达日</td>
<td style="text-align:center">项目串讲</td>
</tr>
<tr>
<td style="text-align:center">周日</td>
<td style="text-align:center">笔记本</td>
<td style="text-align:center">总结沉淀</td>
</tr>
<tr>
<td style="text-align:center">周一</td>
<td style="text-align:center">自主学习</td>
<td style="text-align:center">查漏补缺</td>
</tr>
</tbody>
</table>
<h1 id="本周知识清单"><a href="#本周知识清单" class="headerlink" title="本周知识清单"></a>本周知识清单</h1><h2 id="课程内掌握"><a href="#课程内掌握" class="headerlink" title="课程内掌握"></a>课程内掌握</h2><h3 id="SQL-格式化查询语句"><a href="#SQL-格式化查询语句" class="headerlink" title="SQL - 格式化查询语句"></a>SQL - 格式化查询语句</h3><ul>
<li>命令需要大写，其他内容如变量等则需要小写</li>
<li>表和变量名中不要出现空格，可使用下划线<code>_</code>替代</li>
<li>查询语句中，使用单一空格隔开命令和变量</li>
<li><p>为提高代码的可移植性，请在查询语句结尾添加一个分号<code>；</code></p>
<p> 正确示范</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> account_id</span><br><span class="line"><span class="keyword">FROM</span> orders;</span><br></pre></td></tr></table></figure>
<h3 id="SQL-基础命令及用法参考"><a href="#SQL-基础命令及用法参考" class="headerlink" title="SQL - 基础命令及用法参考"></a>SQL - 基础命令及用法参考</h3><table>
<thead>
<tr>
<th style="text-align:center"><strong>语句</strong></th>
<th style="text-align:left"><strong>使用方法</strong></th>
<th style="text-align:left"><strong>其他详细信息</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">SELECT</td>
<td style="text-align:left">SELECT <strong>Col1</strong>, <strong>Col2</strong>, …</td>
<td style="text-align:left">提供你需要的列</td>
</tr>
<tr>
<td style="text-align:center">FROM</td>
<td style="text-align:left">FROM <strong>Table</strong></td>
<td style="text-align:left">提供列所在的表格</td>
</tr>
<tr>
<td style="text-align:center">LIMIT</td>
<td style="text-align:left">LIMIT <strong>10</strong></td>
<td style="text-align:left">限制返回的行数</td>
</tr>
<tr>
<td style="text-align:center">ORDER BY</td>
<td style="text-align:left">ORDER BY <strong>Col</strong></td>
<td style="text-align:left">根据列命令表格。与 <strong>DESC</strong> 一起使用。</td>
</tr>
<tr>
<td style="text-align:center">WHERE</td>
<td style="text-align:left">WHERE <strong>Col &gt; 5</strong></td>
<td style="text-align:left">用于过滤结果的一个条件语句</td>
</tr>
<tr>
<td style="text-align:center">LIKE</td>
<td style="text-align:left">WHERE <strong>Col LIKE ‘%me%’</strong></td>
<td style="text-align:left">仅提取出列文本中具有 ‘me’ 的行</td>
</tr>
<tr>
<td style="text-align:center">IN</td>
<td style="text-align:left">WHERE <strong>Col IN (‘Y’, ‘N’)</strong></td>
<td style="text-align:left">仅过滤行对应的列为 ‘Y’ 或 ‘N’</td>
</tr>
<tr>
<td style="text-align:center">NOT</td>
<td style="text-align:left">WHERE <strong>Col NOT IN (‘Y’, “N’)</strong></td>
<td style="text-align:left"><strong>NOT</strong> 经常与 <strong>LIKE</strong> 和 <strong>IN</strong> 一起使用。</td>
</tr>
<tr>
<td style="text-align:center">AND</td>
<td style="text-align:left">WHERE <strong>Col1 &gt; 5 AND Col2 &lt; 3</strong></td>
<td style="text-align:left">过滤两个或多个条件必须为真的行</td>
</tr>
<tr>
<td style="text-align:center">OR</td>
<td style="text-align:left">WHERE <strong>Col1 &gt; 5 OR Col2 &lt; 3</strong></td>
<td style="text-align:left">过滤一个条件必须为真的行</td>
</tr>
<tr>
<td style="text-align:center">BETWEEN</td>
<td style="text-align:left">WHERE <strong>Col BETWEEN 3 AND 5</strong></td>
<td style="text-align:left">一般情况下，语法比使用 <strong>AND</strong> 简单一些</td>
</tr>
</tbody>
</table>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col1, col2</span><br><span class="line"><span class="keyword">FROM</span> table1</span><br><span class="line"><span class="keyword">WHERE</span> col3  &gt; <span class="number">5</span> <span class="keyword">AND</span> col4 <span class="keyword">LIKE</span> <span class="string">'%os%'</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> col5</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>
<h3 id="SQL-运算顺序"><a href="#SQL-运算顺序" class="headerlink" title="SQL - 运算顺序"></a>SQL - 运算顺序</h3><ul>
<li><p>在 SQL 中使用<strong>算术运算符</strong>时，采用与数学中相同的运算顺序。</p>
</li>
<li><p>在 SQL中使用<strong>逻辑运算符</strong>时，要参考如下优先级顺序（操作符优先级由低到高，排列在同一行的操作符具有相同的优先级）</p>
<p>| 优先级 | 操作符列表                                         |<br>| —— | ————————————————– |<br>| 1      | :=                                                 |<br>| 2      | ||，OR，XOR                                      |<br>| 3      | &amp;&amp;，AND                                            |<br>| 4      | NOT                                                |<br>| 5      | BETWEEN，CASE，WHEN，THEN，ELSE                    |<br>| 6      | =，&lt;=&gt;，&gt;=，&gt;，&lt;=，&lt;，&lt;&gt;，!=，IS，LIKE，REGEXP，IN |<br>| 7      | |                                                 |<br>| 8      | &amp;                                                  |<br>| 9      | &lt;&lt;，&gt;&gt;                                             |<br>| 10     | -，+                                               |<br>| 11     | *，/，DIV，%，MOD                                  |<br>| 12     | ^                                                  |<br>| 13     | - (一元减号)，~ (一元比特反转)                     |<br>| 14     | !                                                  |<br>| 15     | BINARY，COLLATE                                    |</p>
<p><strong>HINT</strong>：看到如上这么复杂难记的优先级表，想必你也会头大，所以，为了避免因优先级导致的逻辑错误，请一定要将逻辑语句加上小括号，这样既清晰又不易出错！</p>
</li>
</ul>
<h2 id="课程外了解"><a href="#课程外了解" class="headerlink" title="课程外了解"></a>课程外了解</h2><ul>
<li><p>实体关系图（Entity Relationship Diagram，ERD），是一种用于数据库设计的结构图。一幅 ERD 包含不同的符号和连接符，用于显示两个重要的信息： 系统范围内的<strong>主要实体</strong>，以及这些<strong>实体之间的相互关系</strong>。 </p>
<p><a href="https://imgchr.com/i/PQaRtH" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/07/16/PQaRtH.md.png" alt="PQaRtH.md.png"></a></p>
<ul>
<li><p><strong>实体</strong>：是一个系统内<strong>可定义的事物或概念</strong>（术语“实体”通常用来代替“表”，但它们是一样的 ），如上图中的<code>accounts</code>、<code>orders</code>等，即为实体。</p>
</li>
<li><p><strong>主键</strong>(Primary Key,PK)：是一种特殊的实体属性，用于<strong>界定数据库表中的记录的独特性</strong>。一个表不能有两笔（或更多）拥有相同的主键属性值的记录。在上图中，各个实体内的<code>id</code>即为PK。</p>
</li>
<li><p><strong>外键</strong>(Foreign Key,FK):是<strong>对主键的引用</strong>，用于识别实体之间的关系。请注意，有别于主键，外键不必是唯一的，多个记录可以共享相同的值。 在上图中，<code>orders</code>表中的<code>account_id</code>即为链接表<code>accounts</code>的外键。</p>
</li>
<li><p><strong>基数</strong>：基数定义了<strong>一个实与另一个实体的关系里面，某方可能出现次数</strong>。 三种常见的主要关系是一对一，一对多和多对多。  </p>
<ul>
<li><p>一对一：</p>
<p><img src="https://s1.ax1x.com/2018/07/16/PQaWhd.png" alt="PQaWhd.png"></p>
</li>
<li><p>一对多：在课程中的例子即为一对多。</p>
<p><img src="https://s1.ax1x.com/2018/07/16/PQa2Ae.png" alt="PQa2Ae.png"></p>
</li>
<li><p>多对多：</p>
<p><img src="https://s1.ax1x.com/2018/07/16/PQac7D.png" alt="PQac7D.png"></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="项目相关"><a href="#项目相关" class="headerlink" title="项目相关"></a>项目相关</h1><p>请先自行尝试完成项目，如果感觉吃力，再参考哈~</p>
<h2 id="项目概览"><a href="#项目概览" class="headerlink" title="项目概览"></a>项目概览</h2><p>在这个项目中，我们利用Udacity的数据库，分别提取本地和全球的气温数据，并进行可视化对比分析，观察可视化结果，给出本地及全球平均气温的走势结论。 </p>
<h2 id="模块化任务"><a href="#模块化任务" class="headerlink" title="模块化任务"></a>模块化任务</h2><h3 id="数据提取"><a href="#数据提取" class="headerlink" title="数据提取"></a>数据提取</h3><p>利用SQL，在项目工作区中，提取出全球气温数据和感兴趣城市的数据。</p>
<p><strong>HINT</strong>：</p>
<ul>
<li><p>在提取感兴趣的城市之前，可以先通过如下代码查看数据库中，是否存在该城市数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> city_list</span><br><span class="line"><span class="keyword">WHERE</span> city = xxx</span><br></pre></td></tr></table></figure>
</li>
<li><p>提取出数据之后，可以先在工作区简单预览下，查看有连续记录数据的年份区间，并以这个区间作为筛选条件，重新提取数据并保存</p>
</li>
<li><p>你提取出来的两个数据文件，在时间筛选上应该是一致的</p>
</li>
</ul>
<h3 id="数据整理"><a href="#数据整理" class="headerlink" title="数据整理"></a>数据整理</h3><p>利用Excel或Google Sheet对两组数据进行预处理，计算出平均气温的移动平均值</p>
<p><strong>HINT</strong>：</p>
<ul>
<li>计算移动平均值采用的函数为<code>AVERAGE</code></li>
<li>两组数据的移动平均值要单独成列，并且有一个不与其他列重复且易于辨认的列名，如<code>global_temp</code></li>
<li>为方便分析，你需要将两列数据合并到同一个文件中，注意在复制粘贴时，选择<code>粘贴选项</code> -&gt; <code>值和数据格式</code>，这样才会粘贴得到公式计算后的数据。</li>
</ul>
<h3 id="数据可视化及分析"><a href="#数据可视化及分析" class="headerlink" title="数据可视化及分析"></a>数据可视化及分析</h3><p>利用Excel或Google Sheet将两组移动平均值进行线条图可视化，并对结果进行<strong>描述</strong>。</p>
<h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>对可视化的分析结果进行总结，并发表结论性看法。</p>
<h2 id="项目提交"><a href="#项目提交" class="headerlink" title="项目提交"></a>项目提交</h2><p>提交前，请将 PDF 格式的文档压缩成zip格式的压缩包，文件名不要出现汉字或者空格，示例<code>Allen_project_01.zip</code></p>
<p><strong>项目提交、收到审阅结果之后请及时告知班主任或助教，让我们一起分享你的喜悦，提前祝项目顺利通过，等你好消息！</strong></p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://www.visual-paradigm.com/cn/guide/data-modeling/what-is-entity-relationship-diagram/" target="_blank" rel="noopener">什么是实体关系图（ERD）？</a></li>
</ul>
<h1 id="提前通关了怎么办？"><a href="#提前通关了怎么办？" class="headerlink" title="提前通关了怎么办？"></a>提前通关了怎么办？</h1><ul>
<li>整理学习笔记</li>
<li>开始下一阶段的学习：找助教要下一周的导学呀~</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/28/2018-2-28-课堂规模悖论-/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/28/2018-2-28-课堂规模悖论-/" class="post-title-link" itemprop="url">课堂规模悖论</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-28 12:30:09" itemprop="dateCreated datePublished" datetime="2018-02-28T12:30:09+08:00">2018-02-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-03 12:51:55" itemprop="dateModified" datetime="2019-04-03T12:51:55+08:00">2019-04-03</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/笔记/" itemprop="url" rel="index"><span itemprop="name">笔记</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2018/02/28/2018-2-28-课堂规模悖论-/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/02/28/2018-2-28-课堂规模悖论-/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在《Think Stats 2nd》书中的第三章提到了一个有趣的统计学悖论——课堂规模悖论。书中表述如下：</p>
<hr>
<p>在很多美国大学和学院里，学生与教师的比例约为10：1，但是学生们经常会惊讶地发现自己课上的平均学生数大于10，造成这一现象的原因有两个：</p>
<ul>
<li>学生通常每学期修4到5门课，但是教授经常只教1门或2门；</li>
<li>上小课的学生很少，但上大课的学生人数非常之多。</li>
</ul>
<p>一旦我们知道了第一个原因，其效应就是显而易见的，第二个就不那么明显了。让我们来看一个例子，假设一所学院某学期开了65门课，选课的人数分布如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">size</th>
<th style="text-align:center">count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">5-9</td>
<td style="text-align:center">8</td>
</tr>
<tr>
<td style="text-align:center">10-14</td>
<td style="text-align:center">8</td>
</tr>
<tr>
<td style="text-align:center">15-19</td>
<td style="text-align:center">14</td>
</tr>
<tr>
<td style="text-align:center">20-24</td>
<td style="text-align:center">4</td>
</tr>
<tr>
<td style="text-align:center">25-29</td>
<td style="text-align:center">6</td>
</tr>
<tr>
<td style="text-align:center">30-34</td>
<td style="text-align:center">12</td>
</tr>
<tr>
<td style="text-align:center">35-39</td>
<td style="text-align:center">8</td>
</tr>
<tr>
<td style="text-align:center">40-44</td>
<td style="text-align:center">3</td>
</tr>
<tr>
<td style="text-align:center">45-49</td>
<td style="text-align:center">2</td>
</tr>
</tbody>
</table>
<p>如果你问院长，每门课平均的选课人数是多少，他会构建一个PMF( probability mass function，概率质量函数），计算出均值。</p>
<blockquote>
<p>PMF是将数据中的每个值映射到其概率上，是除直方图外的另一种表示数据分布的方法。</p>
</blockquote>
<hr>
<p>书中的代码使用的是作者自建的一个python库thinkstats2，这里不再赘述，只是借书中的例子，用python还原如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#定义选课人数分布字典</span></span><br><span class="line">d = &#123;<span class="number">7</span>:<span class="number">8</span>,<span class="number">12</span>:<span class="number">8</span>,<span class="number">17</span>:<span class="number">14</span>,<span class="number">22</span>:<span class="number">4</span>,<span class="number">27</span>:<span class="number">6</span>,<span class="number">32</span>:<span class="number">12</span>,<span class="number">37</span>:<span class="number">8</span>,<span class="number">42</span>:<span class="number">3</span>,<span class="number">47</span>:<span class="number">2</span>&#125;</span><br><span class="line"><span class="comment">#获取人数分布的array</span></span><br><span class="line">data = numpy.array(list(d.keys())).repeat(list(d.values()))</span><br><span class="line"><span class="comment">#计算均值</span></span><br><span class="line">act_mean = data.mean()</span><br></pre></td></tr></table></figure>
<p>计算得到实际选课人数均值约为23.7。</p>
<p>这是我们获取全部数据之后，站在类似于上帝视角去看的结果，那么如果我们对一组学生进行调查，询问他们的课堂上有多少学生，然后再次计算均值，会发现什么呢？</p>
<p>首先，计算出学生观察到的分布，其中每个课堂规模值的概率受到选课学生人数的“影响”。</p>
<blockquote>
<p>具体实现：假设每门课的选课人数为x，而该规模人数的课程出现的概率为p，那么通过询问，获得的该规模课程总数应该为x*p。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#我们先构建课程规模与课程出现概率的字典</span></span><br><span class="line">pmf = &#123;size:(count/<span class="number">65</span>) <span class="keyword">for</span> size,count <span class="keyword">in</span> d.items()&#125;<span class="comment">#65为课程总数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#构建课程规模与询问后得到的课程计数字典，我们把它叫做偏倚分布</span></span><br><span class="line">obs_data = &#123;size:size*count <span class="keyword">for</span> size,count <span class="keyword">in</span> pmf.items()&#125;</span><br><span class="line"><span class="comment">#计算偏倚分布的选课人数总数</span></span><br><span class="line">sum_students = sum(list(map(<span class="keyword">lambda</span> x:x[<span class="number">0</span>]*x[<span class="number">1</span>],zip(obs_data.keys(),obs_data.values()))))</span><br><span class="line"><span class="comment">#计算偏倚分布的总课程数</span></span><br><span class="line">sum_count = sum(list(obs_data.values()))</span><br><span class="line"><span class="comment">#计算偏倚分布的选课人数均值</span></span><br><span class="line">obs_mean = sum_students/sum_count</span><br></pre></td></tr></table></figure>
<p>计算得到的结果为：29.1，比实际的均值高了约25%。</p>
<p>接下来，我们构建这两组数据的PMF图，能更直观一些。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#构建偏倚分布课程规模与该课程出现概率的字典</span></span><br><span class="line">obs_pmf = &#123;size:count/sum_count <span class="keyword">for</span> size,count <span class="keyword">in</span> obs_data.items()&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#可视化，并列柱状图</span></span><br><span class="line">sns.set(style=<span class="string">"white"</span>, context=<span class="string">"talk"</span>)<span class="comment">#设置样式</span></span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize = (<span class="number">10</span>,<span class="number">5</span>))<span class="comment">#设置图像大小</span></span><br><span class="line">ind = np.array(list(pmf.keys()))</span><br><span class="line">width = <span class="number">0.4</span></span><br><span class="line"></span><br><span class="line">plt.bar(ind - width,pmf.values(),label = <span class="string">'actual'</span>)<span class="comment">#实际值</span></span><br><span class="line"></span><br><span class="line">plt.bar(ind + width,ano_pmf.values(),label = <span class="string">'observed'</span>)<span class="comment">#观察值</span></span><br><span class="line"></span><br><span class="line">plt.xlabel(<span class="string">'class size'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'PMF'</span>)</span><br><span class="line">plt.xticks(list(pmf.keys()))</span><br><span class="line">plt.legend(loc=<span class="string">'upper right'</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2018/10/03/i30ncq.png" alt="i30ncq.png"></p>
<p>从图中可以明显看出，在偏倚分布中，小课更少，大课更多。</p>
<p>同样，你也可以反向进行如上的操作。假设你希望得到一所学院的课堂规模分布，但却无法从院长处得到可靠数据，你可以采用另一个办法：选择学生的一个随机样本，进行调查，询问他们的课堂上有多少学生，然后再进行“去偏倚”的操作，这里就需要用统计得来的同等规模课程计数除以它出现的概率。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">21</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">6</span>
                    <span class="site-state-item-name">分类</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">12</span>
                    <span class="site-state-item-name">标签</span>
                  
                </div>
              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-fas fa-space-shuttle"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.1.0</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="总访客量">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="总访问量">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.0"></script>



  

  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  

  
  

<script src="//cdn1.lncld.net/static/js/3.11.1/av-min.js"></script>



<script src="//unpkg.com/valine/dist/Valine.min.js"></script>

<script>
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#comments',
    verify: true,
    notify: true,
    appId: '1GIsNa4yl3cJmXFEcFxWgNJX-gzGzoHsz',
    appKey: 'sAf2Iz8P4JMH7Ac7YKeoojii',
    placeholder: '畅所欲言吧，朋友！',
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: false,
    lang: '' || 'zh-cn'
  });
</script>





  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

<script src="/live2dw/lib/L2Dwidget.min.js?bd2294fafea3389ee458f1d9be5a2157"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>
